
<html><head><title>Safety Rules for Creating SKILL Pcells</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="sumehta" />
<meta name="CreateDate" content="2023-09-14" />
<meta name="CreateTime" content="1694697809" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes how to create parameterized cells using SKILL or the Virtuoso parameterized cell software." />
<meta name="DocTitle" content="Virtuoso Parameterized Cell Reference" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Safety Rules for Creating SKILL Pcells" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="pcellref" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-09-14" />
<meta name="ModifiedTime" content="1694697809" />
<meta name="NextFile" content="howtopackage.html" />
<meta name="Group" content="" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="pcellOverview.html" />
<meta name="c_product" content="Virtuoso Layout Suite" />
<meta name="Product" content="Virtuoso Layout Suite" />
<meta name="ProductFamily" content="Virtuoso Layout Suite" />
<meta name="ProductVersion" content="IC23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Virtuoso Parameterized Cell Reference -- Safety Rules for Creating SKILL Pcells" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="IC23.1" />
<meta name="SpaceKey" content="pcellrefIC231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="pcellrefTOC.html">Contents</a></li><li><a class="prev" href="pcellOverview.html" title="Overview">Overview</a></li><li style="float: right;"><a class="viewPrint" href="pcellref.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="howtopackage.html" title="How to Package a Pcell">How to Package a Pcell</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Virtuoso Parameterized Cell Reference<br />Product Version IC23.1, September 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>2
<a id="pgfId-937817"></a></h1>
<h1>
<a id="pgfId-954247"></a><hr />
<a id="90981"></a>Safety Rules for Creating SKILL Pcells<hr />
</h1>

<p>
<a id="pgfId-954248"></a>This chapter provides important rules for creating SKILL Pcells, including which functions are safe to use and what to avoid.</p>

<div class="webflare-information-macro webflare-macro-warning">
<a id="pgfId-954204"></a>
If you use <a id="marker-954202"></a>SKILL functions<a id="marker-954203"></a> that are unsupported or not intended for use in Pcells, your Pcell code will probably fail when you try to translate your design to a format other than Design Framework II or when you use the Pcell in a different Cadence application.</div>

<p>
<a id="pgfId-954205"></a>The purpose for creating a Pcell is to <em>automate the creation of data</em>. Pcells should be designed as standalone entities, independent of the environment in which they are created and independent of the variety of environments in which you or someone else might want to use them. An environment can react to a Pcell, but Pcell code should not react to, interact with, or be dependent on an environment.</p>
<p>
<a id="pgfId-954206"></a>Although it is possible to create Pcells dependent on something in your current or local environment or using unsupported or not recommended functions, your Pcell code might fail on subsequent evaluations and is likely to fail when you try to translate it for a different environment. Although it is possible to <a id="marker-954207"></a>load files, read from files, and <a id="marker-954208"></a>write to files in the UNIX file system from within a Pcell, do not do so, because</p>
<ul><li>
<a id="pgfId-954209"></a>You cannot control the file permission settings in other locations, so reading or writing from a Pcell can cause the Pcell to fail in other directories, other environments, and during evaluation by translators. </li><li>
<a id="pgfId-954210"></a>Loading a file from within a Pcell could cause the Pcell evaluation to fail. Depending on Pcell parameters, creating an instance might cause the system to execute the Pcell code again and reload the file. When a file is reloaded, the system issues a warning message that acts as output from the Pcell, causing the Pcell evaluation to fail.</li></ul>

<p>
<a id="pgfId-954211"></a>Functions that are not supported for use by customers within SKILL Pcells usually belong to specific applications (tools); they are unknown to other environments, to other tools, and to data translators.</p>
<p>
<a id="pgfId-954241"></a>Create Pcells using only the recommended, supported functions. You can identify them by their prefixes. However, you can also use all of the basic SKILL language functions that are defined in <em><a actuate="user" class="URL" href="../sklangref/sklangrefTOC.html#firstpage" show="replace" xml:link="simple">Cadence SKILL Language Reference</a></em>; these functions do not have prefixes. To use only recommended, supported, documented functions, follow the rules in this section.</p>
<p>
<a id="pgfId-954243"></a>This chapter contains the following information:</p>
<ul><li>
<a id="pgfId-368838"></a><a href="safetyrules.html#32298">SKILL Procedures Called in Pcells</a></li><li>
<a id="pgfId-925052"></a><a href="safetyrules.html#20987">Macros in Pcell SKILL Code</a></li><li>
<a id="pgfId-925057"></a><a href="safetyrules.html#13891">Physical Limits for Functions</a></li><li>
<a id="pgfId-954272"></a><a href="safetyrules.html#41194">Recommended and Supported SKILL Functions for Pcells</a></li><li>
<a id="pgfId-368924"></a><a href="safetyrules.html#42738">What to Avoid When Creating Pcells</a></li><li>
<a id="pgfId-954283"></a><a href="safetyrules.html#57131">Using Print Functions in a Pcell</a></li><li>
<a id="pgfId-954304"></a><a href="safetyrules.html#14505">What to Avoid When Creating Pcells</a></li></ul>







<h3>
<a id="pgfId-934368"></a><a id="32298"></a>SKILL<a id="marker-934367"></a> Procedur<a id="callPcellProcedure"></a>es Called in Pcells</h3>

<p>
<a id="pgfId-934403"></a>You can call your own SKILL procedures from within Pcells. However, the code in procedures called by Pcells must follow all of the safety rules described in this section. The safety rules apply to all code that is evaluated when the system evaluates a Pcell, and that includes SKILL procedures called by the Pcell.</p>
<p>
<a id="pgfId-934370"></a>Called procedures are not compiled with the Pcell, so ensure they are loaded before the system evaluates the Pcell. You can set up the <code>libInit.il</code> file to automatically load the procedures the first time it accesses the library. <a id="marker-934371"></a></p>

<h4><em>
<a id="pgfId-956170"></a>Related Topics</em></h4>

<p>
<a id="pgfId-956166"></a><h-hot><a actuate="user" class="URL" href="../pcellref/howtopackage.html#firstpage" show="replace" xml:link="simple">How to Package a Pcell</a></h-hot></p>
<p>
<a id="pgfId-956185"></a><a href="howtopackage.html#29158">Loading of Pcell Support Files</a></p>

<h3>
<a id="pgfId-937883"></a><a id="20987"></a>Macros<a id="marker-937984"></a> in P<a id="macroPcellCode"></a>cell <a id="marker-937993"></a>SKILL <a id="marker-938003"></a>Code</h3>

<p>
<a id="pgfId-938024"></a>Macros in Pcells are only expanded one level. You can include macros that do not reference or contain other macros (are not nested) in your Pcell SKILL code, and they will be expanded successfully.</p>
<p>
<a id="pgfId-938143"></a>To include a nested macro in a Pcell, it is recommended that you use an explicit function call in the Pcell code section of the <code>pcDefinePCell</code> function, and make sure that the function is defined and available (loaded) prior to any evaluation of the Pcell. This is usually done by including the function in your <code>libInit.il</code> file. If you do not use this method for nested macros, the nested code is treated as an undefined function, causing the Pcell evaluation to fail.</p>

<h3>
<a id="pgfId-936827"></a><a id="13891"></a>Physical Limit<a id="phyLimitsFunctions"></a>s for <a id="marker-936916"></a>Functions</h3>

<p>
<a id="pgfId-936829"></a>You can avoid creating a Pcell that is too large to be processed or displayed by not exceeding the physical limitations for SKILL functions. </p>
<p>
<a id="pgfId-936830"></a>The following physical limitations exist for functions:</p>
<ul><li>
<a id="pgfId-936852"></a>Total number of <em>required</em> arguments is less than 65536</li><li>
<a id="pgfId-936854"></a>Total number of <em>keyword/optional</em> arguments is less than 255</li><li>
<a id="pgfId-954410"></a>Total number of local variables in a <code>let</code> is less than 65536</li><li>
<a id="pgfId-954668"></a>Total number of local variables in a let must be less than 65536</li><li>
<a id="pgfId-954669"></a>Max size of code vector is less than 1GB</li></ul>




<p>
<a id="pgfId-954656"></a>By default, code vectors are limited to functions that can compile less than 32KB words. This translates roughly into a limit of 20000 lines of SKILL code per function. The maximum number of arguments limit of 32KB is mostly applicable in the case when functions are defined to take an <span class="webflare-courier-new" style="white-space:pre"><em>@rest</em></span> argument or in the case of <span class="webflare-courier-new" style="white-space:pre"><em>apply</em></span> called on an argument list longer than 32KB elements.</p>

<h3>
<a id="pgfId-934098"></a><a id="41194"></a>Recommended and <a id="marker-934095"></a>Supported <a id="marker-934096"></a>SKILL Functions<a id="supportedPcellFunctions"></a> for Pcells</h3>

<p>
<a id="pgfId-934099"></a>When you create SKILL routines within Pcells, use only the following functions:</p>
<ul><li>
<a id="pgfId-934101"></a>The SKILL functions documented in <em>Cadence SKILL Language Reference;</em> for example, <code>car</code>, <code>if</code>, <code>foreach</code>, <code>sprintf</code>, <code>while</code>.</li><li>
<a id="pgfId-954698"></a>SKILL functions from the <code>db</code>, <code>dd</code>, <code>cdf</code>, <code>rod</code>, <code>tech</code>, <code>abe</code>, <code>cst</code>, and <code>tx</code> families.<code></code></li><li>
<a id="pgfId-934181"></a>You can use only SKILL functions, <code>pcExprToString</code>, <code>pcFix</code>, <code>pcRound</code>, and <code>pcTechFile</code> because:<ul><li>
<a id="pgfId-934182"></a>Most supported <code>pc</code> functions correspond to the graphical user interface commands. You can use them to create Pcells in the graphical Pcell environment, but you cannot use them in the body of SKILL Pcell code.</li><li>
<a id="pgfId-934183"></a>Both the Pcell graphical user interface and the Pcell compiler are coded using <code>pc</code> SKILL functions. You cannot use the graphical user interface or compiler functions at all.</li></ul></li></ul>





<h4><em>
<a id="pgfId-956262"></a>Related Topics</em></h4>

<p>
<a id="pgfId-956281"></a><em>Cadence SKILL Language Reference</em>;</p>
<p>
<a id="pgfId-956296"></a><h-hot><a actuate="user" class="URL" href="../skpcellref/skillPcellFunctions.html" show="replace" xml:link="simple">pc Functions for SKILL Pcell Code</a></h-hot></p>

<h3>
<a id="pgfId-956662"></a><a id="57131"></a>Using Print Functions in a Pcell</h3>

<p>
<a id="pgfId-956663"></a>You cannot print or generate output from a Pcell because it causes the Pcell evaluation to fail. However, you can bypass the system processing for print functions by using the <code>fprintf</code> or <code>println</code> function to print directly to <code>stdout</code> (standard output) in the format shown below:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-956664"></a><code>fprintf( stdout ... )</code></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-956665"></a>println( <code><em>variable</em></code> stdout )</pre>

<p>
<a id="pgfId-956666"></a>where <span class="webflare-courier-new" style="white-space:pre"><em>variable</em></span> is your variable name. For example</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-956667"></a>fprintf( stdout &quot;myVariable = %L \n&quot; myVariable )</pre>
<h4>
<a id="pgfId-956668"></a>Using printf or println in a Pcell</h4>

<p>
<a id="pgfId-956669"></a>If you use the <code>printf</code> or <code>println</code> function in a Pcell, the output is treated as an error. In a cellview, errors are indicated by flashing markers. You can query the error in the cellview, change your Pcell code to fix the error, and recompile your Pcell.</p>
<p>
<a id="pgfId-956670"></a>To query markers,</p>
<ol><li>
<a id="pgfId-956671"></a>Make the marker layer a valid layer.</li><li>
<a id="pgfId-956672"></a>Choose <em>Verify &#8211; Markers &#8211; Explain</em>.</li><li>
<a id="pgfId-956673"></a>Click a flashing marker.<br />
<a id="pgfId-956674"></a>A dialog box appears, showing the text printed from the Pcell by the <code>printf</code> or <code>println</code> function.</li></ol>



<p>
<a id="pgfId-956678"></a>For debugging tips, see <h-hot><a href="debugskillPcells.html#90981">Debugging SKILL Pcells</a></h-hot>.</p>

<h3>
<a id="pgfId-956680"></a><a id="54886"></a>Enclosing the Body of Code in a let or prog for Local Variables</h3>

<p>
<a id="pgfId-956682"></a>When you use local variables in the body of SKILL Pcell code in a <h-hot><a href="skillPcells.html#pcDefinePCell">pcDefinePCell</a></h-hot> statement, be sure to enclose the Pcell code in a <code>let</code> or <code>prog</code> statement, and define all variables used in the Pcell code at the beginning of the <code>let</code> or <code>prog</code> statement. Defining variables as part of a <code>let</code> or <code>prog</code> prevents conflicts with variables used by the Pcell compiler. Using <code>let</code> gives faster performance than <code>prog</code>; <code>prog</code> allows multiple exits while <code>let</code> exits only at its end.</p>

<h3>
<a id="pgfId-934257"></a><a id="42738"></a><a id="14505"></a>What to Avoid <a id="marker-934255"></a>Whe<a id="avoidMakingPcells"></a>n <a id="marker-934256"></a>Creating Pcells</h3>

<p>
<a id="pgfId-934258"></a>When creating a Pcell, do not use functions with prefixes other than <code>db</code>, <code>dd</code>, <code>cdf</code>, <code>rod</code>, and <code>tech</code>. Although it is possible to call procedures with other prefixes from within a Pcell, you will not be able to view the Pcell in a different environment or translate it into the format required by another database. Most translators, including the physical design translators, can translate only basic SKILL functions, the four <code>pc</code> functions, and functions in the SKILL families <code>db</code>, <code>dd</code>, <code>cdf</code>, <code>rod</code>, and <code>tech</code>.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-936497"></a>In some cases, a function looks like a basic function but is not a basic function. For example, the Cadence analog design environment function <code>complex</code> looks like a basic function, but it is not. Avoid using Cadence analog design environment functions and other non-basic SKILL functions because the translators do not support them.</div>
<p>
<a id="pgfId-934259"></a>Specifically, <strong>do not </strong>use functions with application-specific prefixes such as <code>ael</code>, <code>abs</code>, <code>de</code>, <code>ge</code>, <code>hi</code>, <code>las</code>, <code>le</code>, <code>pr</code>, and <code>sch</code>. Procedures in any application-specific family are at a higher level of functionality than can be used in a Pcell safely. For example, if you create a Pcell using <code>le</code> functions, the Pcell works only in environments that include the Virtuoso layout editor. You cannot use a translator to export your design from the DFII database. </p>
<p>
<a id="pgfId-934260"></a>When a translator cannot evaluate a function, one of the following happens:</p>
<ul><li>
<a id="pgfId-934262"></a>The <a id="marker-934261"></a>translator fails and issues an <code>undefined function</code> error message.</li><li>
<a id="pgfId-934264"></a>The <a id="marker-934263"></a>translator continues, issues a warning message, and translates the data incorrectly. </li></ul>

<p>
<a id="pgfId-934270"></a>To make your design translate successfully, you must resolve undefined functions in Pcells. You can do this by flattening the Pcells, which results in a loss of hierarchy and parameterization, or by rewriting the Pcell code to eliminate the undefined functions.</p>

<div class="webflare-information-macro webflare-macro-information">
<a id="pgfId-934274"></a>
Here are more important rules for creating Pcells. In your <a id="marker-934272"></a><a id="marker-934273"></a>Pcell code, </div>

<ul><li style="list-style-type: none;background-image: none;"><ul><li>
<a id="pgfId-934275"></a>Do not prompt the user for input</li><li>
<a id="pgfId-934276"></a>Do not generate messages; message output is interpreted as an error</li><li>
<a id="pgfId-934277"></a>Do not load, read, or write to files in the UNIX file system</li><li>
<a id="pgfId-934278"></a>Do not run any external program that starts another process</li><li>
<a id="pgfId-934279"></a>If you need to drive external programs to calculate cell shapes, do it in SKILL<br />
<a id="pgfId-937119"></a>Use CDF callback procedures to save the resulting list of coordinate pairs in a string, and then pass the string as input to a SKILL Pcell. <br />
<a id="pgfId-950084"></a>This method has the advantage that the external program needs to be called only once per instance, not each time the design is opened. For more information about callback procedures, refer to <a actuate="user" class="URL" href="../pcellref/graphicalPcells.html#CDF" show="replace" xml:link="simple">Using the Component Description Format</a>.</li><li>
<a id="pgfId-950085"></a>Do not generate output with print functions, except as described in <a href="safetyrules.html#57131">Using Print Functions in a Pcell</a>.</li></ul></li></ul>










<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="pcellOverview.html" id="prev" title="Overview">Overview</a></em></b><b><em><a href="howtopackage.html" id="nex" title="How to Package a Pcell">How to Package a Pcell</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;⠀ </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>