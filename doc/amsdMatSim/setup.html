
<html><head><title>AMS-MATLAB/Simulink Cosimulation</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="shubh" />
<meta name="CreateDate" content="2023-06-13" />
<meta name="CreateTime" content="1686640365" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes how to cosimulate a system containing analog and mixed-signal subsystems using the Virtuoso AMS Designer simulator and MathWorks MATLAB/Simulink" />
<meta name="DocTitle" content="Spectre AMS Designer Cosimulation with MathWorks MATLAB/Simulink" />
<meta name="DocType" content="Getting Started" />
<meta name="FileTitle" content="AMS-MATLAB/Simulink Cosimulation" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="amsdMatSim" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-06-13" />
<meta name="ModifiedTime" content="1686640365" />
<meta name="NextFile" content="tutorial1.html" />
<meta name="Group" content="" />
<meta name="Platform" content="Custom IC Design,Custom IC Design" />
<meta name="PrevFile" content="amsdMatSimTOC.html" />
<meta name="c_product" content="AMS Designer,Virtuoso Analog Design Environment" />
<meta name="Product" content="AMS Designer,Virtuoso Analog Design Environment" />
<meta name="ProductFamily" content="AMS Designer,Virtuoso Analog Design Environment" />
<meta name="ProductVersion" content="IC23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre AMS Designer Cosimulation with MathWorks MATLAB/Simulink -- AMS-MATLAB/Simulink Cosimulation" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="IC23.1" />
<meta name="SpaceKey" content="amsdMatSimIC231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="amsdMatSimTOC.html">Contents</a></li><li><a class="prev" href="amsdMatSimTOC.html" title="Contents">Contents</a></li><li style="float: right;"><a class="viewPrint" href="amsdMatSim.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="tutorial1.html" title="Running Cosimulation from ADE Using the Fixed-Cell Coupler">Running Cosimulation from ADE  ...</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Spectre AMS Designer Cosimulation with MathWorks MATLAB/Simulink<br />Product Version IC23.1, June 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>1
<a id="pgfId-1032955"></a></h1>
<h1>
<a id="pgfId-1035250"></a><hr />
AMS-MATLAB/Simulink Cosimulation<hr />
</h1>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1037049"></a><em>AMS-MATLAB/Simulink cosimulation</em> stands for cosimulation using the Spectre AMS Designer simulator and The MathWorks MATLAB<sup>&#174;</sup>/Simulink<sup>&#174;</sup>. <em>ADE</em> stands for the Virtuoso Analog Design Environment. </div>

<div class="webflare-information-macro webflare-macro-information">
<a id="pgfId-1037083"></a>
Use IC 6.1.3, IUS 8.1 or later, and MATLAB704R14 or MATLAB R2007b or MATLAB R2008a for this tutorial. The estimated time to complete this tutorial is about one hour. </div>

<p>
<a id="pgfId-1037268"></a>See the following topics for tutorial details: </p>
<ul><li>
<a id="pgfId-1037276"></a><a href="setup.html#25807">Introducing AMS-MATLAB/Simulink Cosimulation</a> </li><li>
<a id="pgfId-1037314"></a><a href="setup.html#76357">Understanding the Different Cosimulation Flows</a> </li><li>
<a id="pgfId-1037319"></a><a href="setup.html#47336">Setting Up the AMS-MATLAB/Simulink Cosimulation Example</a> </li><li>
<a id="pgfId-1037610"></a><a href="setup.html#12448">Modifying the Simulink Model</a> </li><li>
<a id="pgfId-1038728"></a><a href="setup.html#61785">Increasing the Noise for the AWGN Channel</a> </li><li>
<a id="pgfId-1038207"></a><a href="setup.html#76746">Adding the Simulink Coupler Module to the Testbench</a> </li><li>
<a id="pgfId-1038307"></a><a href="setup.html#11448">Converting Complex Signals to Real and Imaginary Parts</a> </li><li>
<a id="pgfId-1038752"></a><a href="setup.html#33848">Inserting an Ideal Gain Block in the Testbench Schematic</a> </li><li>
<a id="pgfId-1038745"></a><a href="setup.html#26806">Rewiring the Testbench Schematic</a> </li><li>
<a id="pgfId-1038765"></a><a href="setup.html#69680">Setting the Simulink Stop Time</a> </li><li>
<a id="pgfId-1039540"></a><a href="setup.html#45726">Opening the Virtuoso Schematic</a> </li><li>
<a id="pgfId-1039545"></a><a href="setup.html#91579">Creating the Coupler in the Schematic Window</a> </li><li>
<a id="pgfId-1040098"></a><a href="setup.html#73054">Placing the coupler_2_3_a Instance on the Schematic</a> </li><li>
<a id="pgfId-1040274"></a><a href="setup.html#94549">Viewing the Entire AMS-MATLAB/Simulink Signal Flow</a> </li><li>
<a id="pgfId-1040287"></a><a href="setup.html#28476">Exiting MATLAB</a> </li></ul>















<h2>
<a id="pgfId-1036760"></a><a id="25807"></a>Introducing AMS-MATLAB/Simulink Cosimulation</h2>

<p>
<a id="pgfId-1037262"></a>Concept engineering and system-level simulation tools such as MATLAB<sup>&#174;</sup>/Simulink<sup>&#174;</sup> support the specification of high-level system concepts in the early stages of a design. </p>

<p>
<a id="pgfId-1036965"></a></p>
<div class="webflare-div-image">
<img src="images/tutorialStep1.gif" /></div>

<p>
<a id="pgfId-1036941"></a>The picture above shows the top-level schematic for the system-level model of a wireless LAN (the IEEE 802.11a demo). The transmitter blocks encode and modulate binary random data and send the orthogonal frequency-division multiplexing (OFDM) signal to a white Gaussian noise channel model. The receiver blocks demodulate and decode the channel output. Finally, the system compares the received bits with the original bit stream to compute the bit error rate. </p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1037532"></a>The tutorial database libraries include the IEEE 802.11a demo designs. </div>
<p>
<a id="pgfId-1036744"></a>The standard compatible system-level model of the wireless LAN link comprises standard Simulink library modules. You can use this system-level model as the golden reference for the implementation of the system components. </p>
<p>
<a id="pgfId-1036989"></a>Using cosimulation with the Spectre AMS Designer simulator and The MathWorks MATLAB<sup>&#174;</sup>/Simulink<sup>&#174;</sup> (AMS-MATLAB/Simulink cosimulation), you can include the design and simulation of analog and mixed-signal subsystems in your system-level simulation. You can take into account the effects originating from the analog RF parts of the transmitter and receiver. </p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1037106"></a>The RF circuit in this example uses a complex base-band modeling approach. AMS-MATLAB/Simulink cosimulation supports all kinds of circuits, including base-band designs. </div>
<p>
<a id="pgfId-1037112"></a>You can design your analog and mixed-signal subsystems using Cadence<sup>&#174;</sup> Virtuoso<sup>&#174;</sup> software. You can simulate these designs using the Virtuoso Spectre RF and AMS Designer circuit simulators. </p>
<p>
<a id="pgfId-1037128"></a>The picture below shows the RF transmitter module design for this tutorial consisting of filters, an up-converting mixer, and an amplifier. For faster simulation time, we modeled the complex base-band domain of the RF components using the Verilog<sup>&#174;</sup>-A modeling language. You can use this same approach to perform equivalent behavioral pass-band and transistor-level simulations. </p>

<p>
<a id="pgfId-1037015"></a></p>
<div class="webflare-div-image">
<img src="images/transmitterBBsch.gif" /></div>

<p>
<a id="pgfId-1036788"></a>When measuring the RF subsystem characteristics (such as intercept points, noise figure, and corner frequencies), you might think you can use only simple one- and two-tone sinusoidal sources as stimuli. Using AMS-MATLAB/Simulink cosimulation, you can use more realistic stimuli such as modulated signals. You can also achieve the corresponding post-processing required for system performance evaluation. </p>
<p>
<a id="pgfId-1036789"></a>AMS-MATLAB/Simulink cosimulation combines the best of system-level simulation with analog and RF simulation. Simulink provides large libraries of DSP algorithms for generating complicated signals and for post-processing. Virtuoso<sup>&#174;</sup> software provides an optimal design environment for analog/RF and mixed-signal subsystems. The Spectre AMS Designer and Xcelium Mixed-Signal simulator is a powerful single-kernel, mixed-signal simulator for transistor-level circuits and all common behavioral languages. </p>

<h2>
<a id="pgfId-1036798"></a><a id="76357"></a>Understanding the Different <a id="Cosimulation Flows"></a>Cosimulation Flows</h2>

<p>
<a id="pgfId-1037331"></a>AMS-MATLAB/Simulink cosimulation supports different flows that support different groups of users: </p>

<p>
<a id="pgfId-1037642"></a></p>
<table class="webflareTable" id="#id1037622">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1037624">
<a id="pgfId-1037624"></a>Flow</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1037626">
<a id="pgfId-1037626"></a>Description</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037628"></a>ADE Flow </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037630"></a>Run cosimulation by starting MATLAB/Simulink from the Virtuoso<sup>&#174;</sup> Analog Design Environment (ADE) </p>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1037631"></a>This flow is for users who are familiar with ADE. </div>

<p>
<a id="pgfId-1040303"></a>See </p>

<ul><li>
<a id="pgfId-1040310"></a><a href="tutorial1.html#33895">Running Cosimulation from ADE Using the Fixed-Cell Coupler</a> </li><li>
<a id="pgfId-1040317"></a><a href="tutorial2.html#19874">Running Cosimulation from ADE Using the simulinkCoupler</a> </li></ul>


</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037633"></a>Simulink Flow </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037635"></a>Run the cosimulation from MATLAB/Simulink (without starting ADE) using the <code>runSimulation</code> script that comes from the ADE flow </p>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1037636"></a>This flow is for users who do not need to use the Virtuoso Studio Design Environment or who need to debug in the Simulink environment. </div>

<p>
<a id="pgfId-1040441"></a>See <a href="tutorial3.html#63978">&#8220;Running Cosimulation from MATLAB/Simulink&#8221;</a>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037638"></a>AMS Environment Flow </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037640"></a>Start MATLAB first, then start the AMS environment from the Virtuoso hierarchy editor (HED), and run simulations separately using each of these programs </p>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1040470"></a>You can use this same flow from ADE, but this tutorial will cover only the flow from the AMS environment (HED). </div>

<p>
<a id="pgfId-1040469"></a>See <a href="tutorial4.html#54569">&#8220;Running Cosimulation from the Spectre AMS Designer Environment&#8221;</a>. </p>
</td>
</tr>
</tbody></table>
<h2>
<a id="pgfId-1037645"></a><a id="47336"></a>Setting Up the AMS-MATLAB/Simulink Cosimulation <a id="setup"></a>Example</h2>

<p>
<a id="pgfId-1036845"></a>To set up the example files, do the following in a terminal window: </p>

<ol><li>
<a id="pgfId-1036846"></a>Make and change to a directory for the example: <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1036847">
<a id="pgfId-1036847"></a>mkdir amsTutorials 
cd amsTutorials </pre></li><li>
<a id="pgfId-1036848"></a>Copy the migration example files to this directory: <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1036849">
<a id="pgfId-1036849"></a>cp -r $CDSHOME/tools/dfII/samples/tutorials/AMS/MATLABCosimulation.tar.gz . </pre></li><li>
<a id="pgfId-1036850"></a>Decompress the archive file: <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1036851">
<a id="pgfId-1036851"></a>gunzip MATLABCosimulation.tar.gz 
tar xf MATLABCosimulation.tar </pre></li><li>
<a id="pgfId-1036852"></a>Change to the following directory: <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1036853">
<a id="pgfId-1036853"></a>cd MATLABCosimulation </pre></li><li>
<a id="pgfId-1036854"></a>Source the setup file: <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1036855">
<a id="pgfId-1036855"></a>source SETUP </pre>
<a id="pgfId-1036856"></a>The <code>SETUP</code> file sets the <code>MATLABPATH</code> and <code>TUT_DIR</code> environment variables. </li></ol>











<p>
<a id="pgfId-1037463"></a>This tutorial demonstrates cosimulation using the IEEE 802.11a demo that appears in <a href="setup.html#25807">&#8220;Introducing AMS-MATLAB/Simulink Cosimulation&#8221;</a>. To set up the cosimulation, do the following: </p>

<ol><li>
<a id="pgfId-1037562"></a>Verify that the standalone simulations run successfully in MATLAB/Simulink and AMS Designer. </li><li>
<a id="pgfId-1037464"></a>Place and configure the coupler module on the Simulink schematic. <br />
<a id="pgfId-1040318"></a>See <a href="setup.html#76746">&#8220;Adding the Simulink Coupler Module to the Testbench&#8221;</a>. </li><li>
<a id="pgfId-1037465"></a>Place and configure the corresponding coupler module on the ADE schematic. <br />
<a id="pgfId-1040325"></a>See <a href="setup.html#73054">&#8220;Placing the coupler_2_3_a Instance on the Schematic&#8221;</a>. </li></ol>





<p>
<a id="pgfId-1037466"></a>You are ready to run cosimulation using each of the three flows outlined in <a href="setup.html#76357">&#8220;Understanding the Different Cosimulation Flows&#8221;</a>. </p>

<h2>
<a id="pgfId-1036842"></a><a id="12448"></a>Modifying the <a id="Simulink Model"></a>Simulink Model</h2>

<p>
<a id="pgfId-1036932"></a>To modify the Simulink model, do the following: </p>

<ol><li>
<a id="pgfId-1036924"></a>Start MATLAB software: <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1036925">
<a id="pgfId-1036925"></a>matlab &amp; </pre></li><li>
<a id="pgfId-1036841"></a>In the MATLAB Command Window, type the following command to open the library containing the coupler module and other examples: <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1036936">
<a id="pgfId-1036936"></a>open SimCouplerLib.mdl </pre><br />
<a id="pgfId-1037648"></a><div class="webflare-div-image">
<img width="635" height="448" src="images/setup-5.gif" /></div><ol><li>
<a id="pgfId-1036937"></a>To open an example, double-click its blue symbol. </li><li>
<a id="pgfId-1037655"></a>To insert the coupler module, drag-and-drop the <em>Coupler Module</em> from the <em>AMS Designer &#8211; Simulink Cosimulation Library</em>. <br /><div class="webflare-information-macro webflare-macro-information">
<a id="pgfId-1037664"></a>
If you are using MATLAB version R13 (instead of R14), you must open the <em>SimCouplerLib_r13</em> at this point by double-clicking the yellow box. While the coupling technology is equivalent in both MATLAB releases, the MATLAB demo and the standard Simulink libraries are slightly different. R14 designs are not backward compatible with R13. </div></li></ol></li><li>
<a id="pgfId-1037665"></a>Double-click <em>Step 1</em> (leftmost green box) to open the end-to-end design for a wireless LAN transmission system. <br />
<a id="pgfId-1037683"></a>See the picture in <a href="setup.html#25807">&#8220;Introducing AMS-MATLAB/Simulink Cosimulation&#8221;</a>. </li><li>
<a id="pgfId-1037698"></a>Choose <em>Simulation &#8211; Start</em>. <br />
<a id="pgfId-1037708"></a>A spectrum scope and scatter diagram appear. <br />
<a id="pgfId-1038616"></a><div class="webflare-div-image">
<img src="images/SpectrumScope1.gif" /></div>
<a id="pgfId-1038620"></a><div class="webflare-div-image">
<img src="images/ReceivedSignal.gif" /></div>
<a id="pgfId-1038615"></a>The minor deviations in the scatter diagram originated from the noisy channel. <br />
<a id="pgfId-1038653"></a>In the testbench window, the bit error rate information appears at the output of the <em>Error Rate Calculation</em> block. <br />
<a id="pgfId-1038654"></a><div class="webflare-div-image">
<img src="images/ErrorRateCalculation.gif" /></div></li><li>
<a id="pgfId-1038655"></a>Observe that the bit error rate is zero. </li></ol>























<h2>
<a id="pgfId-1037745"></a><a id="61785"></a>Increasing the Noise for the AWGN <a id="increaseNoise"></a>Channel</h2>

<p>
<a id="pgfId-1038721"></a>To increase the noise for the AWGN channel, do the following: </p>

<p>
<a id="pgfId-1037793"></a></p>
<div class="webflare-div-image">
<img width="668" height="306" src="images/setup-9.gif" /></div>
<ol><li>
<a id="pgfId-1037758"></a>In the testbench window, double-click the <em>AWGN</em> block. <br />
<a id="pgfId-1038666"></a>The Function Block Parameters form appears. </li><li>
<a id="pgfId-1037806"></a>In the <em>SNR (dB)</em> field, change the signal-to-noise ratio from <em>20</em> to <code>13</code>. <br />
<a id="pgfId-1038691"></a><div class="webflare-div-image">
<img src="images/FunctionBlockParameters.gif" /></div></li><li>
<a id="pgfId-1037779"></a>Click <em>Apply</em>. </li><li>
<a id="pgfId-1038713"></a>Choose <em>Simulation &#8211; Start</em> to start the simulation again. <br />
<a id="pgfId-1037847"></a>The final plots look like this: <br />
<a id="pgfId-1037822"></a><div class="webflare-div-image">
<img src="images/SpectrumScope1_2.gif" /></div>
<a id="pgfId-1037826"></a><div class="webflare-div-image">
<img src="images/ReceivedSignal_2.gif" /></div>
<a id="pgfId-1037746"></a>The scatter diagram shows some distortion. After some seconds, bit errors do occur. <br />
<a id="pgfId-1038772"></a><div class="webflare-div-image">
<img src="images/ErrorRateCalculation_2.gif" /></div></li><li>
<a id="pgfId-1037853"></a>Change the SNR back to 20. </li></ol>















<h2>
<a id="pgfId-1037915"></a><a id="76746"></a>Adding the Simulink Coupler Module to the <a id="addSimulinkCouplerModule"></a>Testbench</h2>
<p>
<a id="pgfId-1037919"></a></p>
<div class="webflare-div-image">
<img width="668" height="280" src="images/setup-14.gif" /></div>

<p>
<a id="pgfId-1037920"></a>To add the Simulink coupler module to the testbench, do the following: </p>

<ol><li>
<a id="pgfId-1037950"></a>Drag-and-drop the <em>SimulinkCoupler</em> block from the Library window (see <a href="setup.html#12448">&#8220;Modifying the Simulink Model&#8221;</a>) to the testbench window (see above for placement position). <br />
<a id="pgfId-1037989"></a>We place the coupler block between the <em>OFDM Transmitter</em> and the <em>AWGN</em> block to include the analog transmitter RF front end in this system testbench. </li><li>
<a id="pgfId-1037963"></a>Double-click the <em>SimulinkCoupler</em> block. <br />
<a id="pgfId-1037984"></a>The Function Block Parameters window appears. </li><li>
<a id="pgfId-1037985"></a>In the <em>Number of input pins</em> field, type <code>3</code>. <br />
<a id="pgfId-1038841"></a>While the third input pin is not necessary in this case, it illustrates how signals flow and how we will create the coupler in the Virtuoso<sup>&#174;</sup> design environment. </li><li>
<a id="pgfId-1038842"></a>In the <em>Number of output pins</em> field, type <code>2</code>. </li><li>
<a id="pgfId-1038871"></a>In the <em>Frame mode</em> field, select <em>framed</em>. <br />
<a id="pgfId-1038846"></a><div class="webflare-div-image">
<img src="images/input3output2.gif" /></div></li><li>
<a id="pgfId-1038015"></a>Click <em>OK</em>. <br />
<a id="pgfId-1038885"></a>The <em>SimulinkCoupler</em> block has the correct number of pins. <br />
<a id="pgfId-1038862"></a><div class="webflare-div-image">
<img src="images/i3o2SimulinkCoupler.gif" /></div>
<a id="pgfId-1038861"></a>You can resize the <em>SimulinkCoupler</em> block so that it fits better with the signal lines. </li><li>
<a id="pgfId-1038078"></a>(Optional) To view details about the framed signals, choose <em>Format &#8211; Port/Signal Displays &#8211; Signal Dimensions</em> in the testbench window. <br />
<a id="pgfId-1038105"></a>Signal dimensions appear on the schematic. <br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1038114"></a>Later sections contain descriptions of other <em>SimulinkCoupler</em> parameters. </div></li></ol>



















<h2>
<a id="pgfId-1038291"></a><a id="11448"></a>Converting Complex Signals to Real and Imaginary <a id="convertComplexSignals"></a>Parts</h2>

<p>
<a id="pgfId-1038159"></a>The signals in this example are complex-valued signals. Before simulating with AMS Designer, you must split these complex signals into their real and imaginary parts. The Simulink library contains the converters we need for this purpose. </p>

<p>
<a id="pgfId-1038278"></a></p>
<div class="webflare-div-image">
<img width="668" height="283" src="images/setup-17.gif" /></div>
<ol><li>
<a id="pgfId-1038179"></a>In the testbench window, choose <em>View &#8211; Simulink Library</em>. <br />
<a id="pgfId-1038196"></a>The Library window appears. <br />
<a id="pgfId-1038898"></a><div class="webflare-div-image">
<img width="635" height="357" src="images/setup-18.gif" /></div></li><li>
<a id="pgfId-1038189"></a>Double-click <em>Math Operations</em>. <br />
<a id="pgfId-1039009"></a>The math operator and conversion blocks appear. <br />
<a id="pgfId-1038919"></a>The conversions we want for this tutorial appear in the bottom right corner. <br />
<a id="pgfId-1038926"></a><div class="webflare-div-image">
<img width="487" height="664" src="images/setup-19.gif" /></div></li><li>
<a id="pgfId-1038236"></a>Drag-and-drop the <em>Complex to Real-Imag</em> block from the Library window to the testbench window and place it on the left side of the <em>SimulinkCoupler</em> block. </li><li>
<a id="pgfId-1038257"></a>Drag-and-drop the <em>Real-Imag to Complex</em> block from the Library window to the testbench window and place it on the right side of the <em>SimulinkCoupler</em> block. </li><li>
<a id="pgfId-1038398"></a><a href="setup.html#rewire">Rewire</a> the testbench schematic to accomodate the new blocks. </li></ol>











<h2>
<a id="pgfId-1038216"></a><a id="33848"></a>Inserting an <a id="Inserting an Ideal Gain Block"></a>Ideal Gain Block in the Testbench Schematic</h2>

<p>
<a id="pgfId-1038318"></a>Because the analog/RF subsystem will eventually change the signal level, we will insert an ideal gain block at the output of the coupler block so that we can adapt the signal level properties of the digital base-band receiver. </p>

<ol><li>
<a id="pgfId-1038320"></a>In the testbench window, choose <em>View &#8211; Simulink Library</em>. <br />
<a id="pgfId-1038321"></a>The Library window appears. </li><li>
<a id="pgfId-1038323"></a>Double-click <em>Math Operations</em>. <br />
<a id="pgfId-1038324"></a>The math operator and conversion blocks appear. </li><li>
<a id="pgfId-1038325"></a>Drag-and-drop the <em>Gain</em> block from the Library window to the testbench window and place it near the output of the <em>SimulinkCoupler</em> block. </li><li>
<a id="pgfId-1039020"></a>To rotate the block, right-click and choose <em>Format &#8211; Rotate Block</em>. <br />
<a id="pgfId-1038340"></a>See the picture in <a href="setup.html#76746">&#8220;Adding the Simulink Coupler Module to the Testbench&#8221;</a>. </li><li>
<a id="pgfId-1038334"></a>Double-click the <em>Gain</em> block. <br />
<a id="pgfId-1039034"></a>The Function Block Parameters form appears. </li><li>
<a id="pgfId-1039037"></a>In the <em>Gain</em> field, type <code>0.04</code>. </li><li>
<a id="pgfId-1039049"></a>Click <em>OK</em>. </li><li>
<a id="pgfId-1038408"></a><a href="setup.html#rewire">Rewire</a> the testbench schematic to accomodate the <em>Gain</em> block. </li></ol>











<h2>
<a id="pgfId-1038356"></a><a id="26806"></a>Rewiring the Testbench <a id="rewire"></a>Schematic</h2>
<div class="webflare-information-macro webflare-macro-tip">
<a id="pgfId-1038439"></a>
If you do not want to rewire the testbench schematic, you can double-click <em>Step 2</em> (<em>tutorial2r14.mdl</em>, the green box on the right) instead. See the picture in <a href="setup.html#12448">&#8220;Modifying the Simulink Model&#8221;</a>. </div>

<p>
<a id="pgfId-1038361"></a>You can rewire the design as follows: </p>

<ol><li>
<a id="pgfId-1038357"></a>Right-click the wire you want to remove and select <em>Cut</em>. <br />
<a id="pgfId-1038369"></a>For example, you will cut the wire between the <em>OFDM Transmitter</em> and <em>AWGN</em> blocks to fit the <em>SimulinkCoupler</em> block, and you will cut the wire between the <em>AWGN</em> and <em>Simulation off down sampling action</em> blocks to fit the <em>Gain</em> block. </li><li>
<a id="pgfId-1038368"></a>Hover the mouse pointer over the module pin you want to connect until it changes to a cross. </li><li>
<a id="pgfId-1038420"></a>Click-and-drag from the beginning connection point to the destination connection point and release the mouse button. <br /><div class="webflare-information-macro webflare-macro-tip">
<a id="pgfId-1040487"></a>
You can connect the blocks quickly by clicking the first block, then holding down the <em>Ctrl</em> key while clicking the second one. </div></li></ol>





<p>
<a id="pgfId-1038425"></a>Once you rewire the testbench schematic, it should look like the picture in <a href="setup.html#76746">&#8220;Adding the Simulink Coupler Module to the Testbench&#8221;</a>. Using two <em>Spectrum Scope</em> blocks&#8212;one before and one after the <em>SimulinkCoupler</em> block&#8212;we can compare the before and after signals. </p>
<p>
<a id="pgfId-1038949"></a>To add the second <em>Spectrum Scope</em> block before the <em>SimulinkCoupler</em> block, do the following: </p>

<ol><li>
<a id="pgfId-1038953"></a>Right-click <em>Spectrum Scope1</em> and select <em>Copy</em>. </li><li>
<a id="pgfId-1038969"></a>Right-click near where you want to place the second one and select <em>Paste</em>. </li><li>
<a id="pgfId-1038975"></a>To flip the block so that the port is on the left, right-click it and choose <em>Format &#8211; Flip Block</em>. </li><li>
<a id="pgfId-1038998"></a>Hover the mouse pointer over the port until it changes to a cross. </li><li>
<a id="pgfId-1038999"></a>Click-and-drag to connect it to the output of the <em>OFDM Transmitter</em> block. </li></ol>





<p>
<a id="pgfId-1038482"></a>The Simulink model is ready for cosimulation. The Simulink model automatically detects information about the frame size and sampling time. </p>

<h2>
<a id="pgfId-1038548"></a><a id="69680"></a>Setting the Simulink Stop <a id="viewSimulinkStopTime"></a>Time</h2>

<p>
<a id="pgfId-1038568"></a>To set the stop time of the Simulink simulation, do the following: </p>

<ol><li>
<a id="pgfId-1038571"></a>In the testbench window, choose <em>Simulation &#8211; Configuration Parameters</em>. <br />
<a id="pgfId-1038600"></a>The Configuration Parameters form appears. </li><li>
<a id="pgfId-1038602"></a>In the <em>Stop time</em> field, type <code>1000e-6</code> (to match the <code>1m</code> stop time in <a href="tutorial1.html#analysisSetup">the ADE setup</a> later). <br />
<a id="pgfId-1040538"></a><div class="webflare-div-image">
<img src="images/ConfigParams.gif" /></div></li><li>
<a id="pgfId-1039156"></a>Click <em>OK</em>. </li></ol>





<h2>
<a id="pgfId-1035647"></a><a id="45726"></a>Opening the Virtuoso <a id="openSchematic"></a>Schematic</h2>

<p>
<a id="pgfId-1039137"></a>To open the schematic for this tutorial, do the following: </p>

<ol><li>
<a id="pgfId-1039138"></a>Start the Virtuoso<sup>&#174;</sup> software: <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1039142">
<a id="pgfId-1039142"></a>virtuoso &amp; </pre></li><li>
<a id="pgfId-1039143"></a>In the command interpreter window (CIW), choose <em>File &#8211; Open</em>. <br />
<a id="pgfId-1039169"></a>The File Open form appears. </li><li>
<a id="pgfId-1039170"></a>In the <em>File</em> group box, select the following: <br />
<a id="pgfId-1039220"></a><table class="webflareTable" id="#id1039207">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1039225">
<a id="pgfId-1039225"></a>Field</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1039227">
<a id="pgfId-1039227"></a>Selection</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039209"></a><em>Library</em> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039211"></a><em> AMSDcouple</em> </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039213"></a><em>Cell</em> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039215"></a><em> tb_ieee_802_11a_demo_template</em> </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039217"></a><em>View</em> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039219"></a><em> config</em> </p>
</td>
</tr>
</tbody></table>
<a id="pgfId-1039257"></a><div class="webflare-div-image">
<img src="images/FileOpen.gif" /></div></li><li>
<a id="pgfId-1039178"></a>Click <em>OK</em>. <br />
<a id="pgfId-1039252"></a>The Open Configuration form appears. <br />
<a id="pgfId-1039295"></a><div class="webflare-div-image">
<img src="images/doNotOpenConfig.gif" /></div></li><li>
<a id="pgfId-1039253"></a>Click <em>OK</em>. <br />
<a id="pgfId-1039302"></a>The <em>RF Transmitter System Testbench</em> schematic appears. <br />
<a id="pgfId-1039307"></a><div class="webflare-div-image">
<img src="images/RFtransSysTestbench.gif" /></div>
<a id="pgfId-1039303"></a>The schematic contains <ul><li>
<a id="pgfId-1039356"></a>A driver module to scale the coupler output </li><li>
<a id="pgfId-1039360"></a>The RF transmitter model </li><li>
<a id="pgfId-1039361"></a>A simple line termination using resistors </li></ul><br />
<a id="pgfId-1039364"></a>The pieces that the MATLAB/Simulink design provides are <ul><li>
<a id="pgfId-1039365"></a>A signal source for an 802.11a system </li><li>
<a id="pgfId-1039369"></a>The related post-processing algorithms </li></ul></li></ol>


























<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1039422"></a>The <em>AMSDcouple</em> library contains additional examples&#8212;such as <em>tb_sine</em>, <em>tb_sine100</em>, and <em>tb_event_fixed</em>. These examples have corresponding designs in MATLAB/Simulink. You can use these examples to explore cosimulation. See also <a href="learningMore.html#45825">Appendix A, &#8220;Learning More about the Cosimulation Interface.&#8221;</a> </div>

<h2>
<a id="pgfId-1039128"></a><a id="91579"></a>Creating the Coupler in the Schematic <a id="createCouplerSchematicWindow"></a>Window</h2>

<p>
<a id="pgfId-1039451"></a>You can create a coupler in the schematic window using either of two methods. The first method is the one we recommend. </p>
<ul><li>
<a id="pgfId-1039485"></a><a href="setup.html#33083">Creating a Coupler Using the Fixed-Cell Method</a> <br />
<a id="pgfId-1039502"></a>Using the fixed-cell coupler method (the recommended method), you create the specific couplers that you need and save them in your library. You determine the number of coupler pins before you generate the coupler. This coupler is simple and works for all three <a href="setup.html#Cosimulation Flows">cosimulation flows</a>. Use this method to create a coupler instance for your design specifically. <br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1039835"></a>We have already created a fixed coupler with two inputs and three outputs for this tutorial (<code>coupler_2_3_a</code>) and made it available in the <code>AMSDcoupler</code> library. See <a href="tutorial1.html#33895">&#8220;Running Cosimulation from ADE Using the Fixed-Cell Coupler&#8221;</a> for more information. </div></li><li>
<a id="pgfId-1039496"></a><a href="setup.html#49941">Creating a Coupler Using the simulinkCoupler Method</a> <br />
<a id="pgfId-1039550"></a>Using the <code>simulinkCoupler</code> method, you can change the pins at any time. The simulinkCoupler is flexible and allows you to generate Verilog-AMS code automatically in the Virtuoso<sup>&#174;</sup> Analog Design Environment (ADE). You can also modify the generated Verilog-AMS code. <br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1039611"></a>You can find the <code>simulinkCoupler</code> in the <code>analogLib</code> library. The <code>simulinkCoupler</code> is a Pcell coupler. See <a href="tutorial2.html#19874">&#8220;Running Cosimulation from ADE Using the simulinkCoupler&#8221;</a> for more information. </div></li></ul>









<p>
<a id="pgfId-1039828"></a>How you perform cosimulation depends on which method you use. </p>

<h3>
<a id="pgfId-1039475"></a><a id="33083"></a>Creating a Coupler Using the Fixed-Cell <a id="Fixed Cell Coupler Method"></a>Method</h3>
<div class="webflare-information-macro webflare-macro-information">
<a id="pgfId-1039726"></a>
The following steps show you how to create a fixed coupler with two inputs and three outputs. Because we have already created such a fixed coupler (<code>coupler_2_3_a</code>) and made it available in the <code>AMSDcoupler</code> library, so you need not perform these steps. </div>

<p>
<a id="pgfId-1039501"></a>To create a coupler using the fixed-cell method, do the following: </p>

<ol><li>
<a id="pgfId-1039642"></a>In the schematic window, choose <em>Launch &#8211; Mixed Signal Options &#8211; AMS</em>. <br />
<a id="pgfId-1039649"></a><em>AMS</em> appears on the menu banner.<br />
<a id="pgfId-1039468"></a><div class="webflare-div-image">
<img width="672" height="60" src="images/setup-25.gif" /></div></li><li>
<a id="pgfId-1039665"></a>Choose <em>AMS &#8211; Simulink&#174; Coupler Creation</em>. <br />
<a id="pgfId-1039703"></a>The Simulink<sup>&#174;</sup> Fixed Cell Coupler Creation form appears. </li><li>
<a id="pgfId-1039704"></a>In the <em>Number of input pins</em> field, type <code>2</code>. </li><li>
<a id="pgfId-1039798"></a>In the <em>Number of output pins</em> field, type <code>3</code>. <br />
<a id="pgfId-1039758"></a><div class="webflare-div-image">
<img src="images/fixedCell.gif" /></div></li><li>
<a id="pgfId-1039759"></a>Click <em>Generate Fixed Coupler</em>. <br />
<a id="pgfId-1039777"></a>The software creates a coupler with two inputs and three outputs with the name <code>coupler_2_3_a</code>. </li><li>
<a id="pgfId-1039817"></a>Click <em>Close</em>. </li></ol>












<h3>
<a id="pgfId-1039481"></a><a id="49941"></a>Creating a Coupler Using the <a id="simulinkCoupler Method"></a>simulinkCoupler Method</h3>

<p>
<a id="pgfId-1040400"></a>The <code>simulinkCoupler</code> is a parameterized cell (<h-hot><a actuate="user" class="URL" href="../pcellref/pcellOverview.html#firstpage" show="replace" xml:link="simple">Pcell</a></h-hot>) that does not have a fixed number of pins: You can change the number of pins to fit different designs. To select, configure, and place a <code>simulinkCoupler</code> instance, do the following: </p>

<ol><li>
<a id="pgfId-1040348"></a>In the schematic window, type <code>i</code> to open the Add Instance form. </li><li>
<a id="pgfId-1040350"></a>Click <em>Browse</em> to open the Library Browser. </li><li>
<a id="pgfId-1040351"></a>In the <em>Library</em> column, select <em>analogLib</em>. </li><li>
<a id="pgfId-1040352"></a>In the <em>Cell</em> column, scroll down and select <em>simulinkCoupler</em>. <br />
<a id="pgfId-1040356"></a><div class="webflare-div-image">
<img width="608" height="370" src="images/setup-27.gif" /></div></li><li>
<a id="pgfId-1040357"></a>On the Add Instance form, change the number of input pins and the number of output pins to whatever you need. <br />
<a id="pgfId-1040361"></a><div class="webflare-div-image">
<img width="446" height="467" src="images/setup-28.gif" /></div></li><li>
<a id="pgfId-1040364"></a>In the schematic window, click to place the <code>simulinkCoupler</code> instance. <br />
<a id="pgfId-1040368"></a><div class="webflare-div-image">
<img width="367" height="223" src="images/setup-29.gif" /></div></li><li>
<a id="pgfId-1040345"></a>Choose <em>File &#8211; Check and Save</em>. </li></ol>












<h2>
<a id="pgfId-1039857"></a><a id="73054"></a>Placing the coupler_2_3_a Instance on the Schematic</h2>
<div class="webflare-information-macro webflare-macro-tip">
<a id="pgfId-1039979"></a>
You can skip this section if you choose to open the finished schematic that we ship with this tutorial: <code>AMSDcoupler/tb_ieee_802_11a_demo/schematic</code>. </div>

<p>
<a id="pgfId-1039863"></a>To place the <code>coupler_2_3_a</code> instance on the schematic, do the following: </p>

<ol><li>
<a id="pgfId-1039867"></a>In the schematic window, choose <em>Create &#8211; Instance</em> (or type <code>i</code>). <br />
<a id="pgfId-1039877"></a>The Add Instance form appears. <br />
<a id="pgfId-1039890"></a><div class="webflare-div-image">
<img width="437" height="321" src="images/setup-30.gif" /></div></li><li>
<a id="pgfId-1039878"></a>Click <em>Browse</em>. </li><li>
<a id="pgfId-1039885"></a>In the Library Browser window that appears, select the following: <br />
<a id="pgfId-1039897"></a><table class="webflareTable" id="#id1039901">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039903"></a><em>Library</em> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039905"></a><em>AMSDcouple</em> </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039907"></a><em>Cell</em> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039909"></a><em>coupler_2_3_a</em> </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039911"></a><em>View</em> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039913"></a><em>symbol</em> </p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1039886"></a>This library/cell/view appears in the appropriate fields on the Add Instance form. </li><li>
<a id="pgfId-1039947"></a>Move your mouse cursor over the <em>WLAN Signal</em> block on the schematic and click to place the coupler instance to the left of the driver instance. <br />
<a id="pgfId-1039951"></a><div class="webflare-div-image">
<img src="images/placeCoupler.gif" /></div></li><li>
<a id="pgfId-1039859"></a>Press <em>Esc</em>. </li><li>
<a id="pgfId-1040041"></a>Wire up the instance according to the following picture (or you can open the finished schematic that we provide: <code>AMSDcoupler/tb_ieee_802_11a_demo/schematic</code>). <br />
<a id="pgfId-1039972"></a><div class="webflare-div-image">
<img src="images/howToWire.gif" /></div><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1040079"></a>The bottom right pin on the coupler instance connects to a pin whose name is <code>out</code> and whose direction is <em>output</em>. </div></li><li>
<a id="pgfId-1040089"></a>Choose <em>File &#8211; Check and Save</em>. </li></ol>




















<p>
<a id="pgfId-1040052"></a>You can view object properties for the coupler instance by doing the following: </p>

<ol><li>
<a id="pgfId-1040053"></a>Select the coupler instance. </li><li>
<a id="pgfId-1040054"></a>Choose <em>Edit &#8211; Properties &#8211; Objects</em> (or type <code>q</code>). <br />
<a id="pgfId-1040055"></a>The Edit Object Properties form appears. <br />
<a id="pgfId-1040059"></a><div class="webflare-div-image">
<img src="images/EditObjectProperties.gif" /></div></li><li>
<a id="pgfId-1040060"></a>When you are finished viewing the object properties for the coupler, click <em>Cancel</em>. </li></ol>





<h2>
<a id="pgfId-1039858"></a><a id="94549"></a>Viewing the Entire AMS-MATLAB/Simulink Signal <a id="flow"></a>Flow</h2>

<p>
<a id="pgfId-1040119"></a>The following diagram shows the entire signal flow through the MATLAB<sup>&#174;</sup>/Simulink<sup>&#174;</sup> and Cadence<sup>&#174;</sup> Virtuoso<sup>&#174;</sup> environments. </p>

<p>
<a id="pgfId-1039450"></a></p>
<div class="webflare-div-image">
<img width="668" height="414" src="images/setup-34.gif" /></div>

<p>
<a id="pgfId-1040187"></a>Each sink (coupler input pin) acts as a signal source (output pin) in the other environment. The signal flows into the three input pins on the Simulink schematic, out the three output pins on the Virtuoso schematic, out the two output pins on the Simulink schematic, and through the rest of the design on the Simulink schematic. </p>

<h2>
<a id="pgfId-1040129"></a><a id="28476"></a>Exiting MATLAB</h2>

<p>
<a id="pgfId-1040194"></a>To exit MATLAB, do the following: </p>

<ul><li>
<a id="pgfId-1040197"></a>In the testbench schematic window, choose <em>File &#8211; Exit MATLAB</em>. <br />
<a id="pgfId-1040213"></a>You are ready to run cosimulation in the Virtuoso Analog Design Environment (ADE). See <a href="tutorial1.html#33895">&#8220;Running Cosimulation from ADE Using the Fixed-Cell Coupler&#8221;</a>. </li></ul>


<p>
<a id="pgfId-1040198"></a></p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="amsdMatSimTOC.html" id="prev" title="Contents">Contents</a></em></b><b><em><a href="tutorial1.html" id="nex" title="Running Cosimulation from ADE Using the Fixed-Cell Coupler">Running Cosimulation from ADE  ...</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;⠀ </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>