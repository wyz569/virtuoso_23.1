
<html><head><title>Programming Examples</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="parula" />
<meta name="CreateDate" content="2023-08-23" />
<meta name="CreateTime" content="1692797220" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the SKILL language to new users and helps them understand advanced topics, encourages sound SKILL programming methods, and introduces the SKILL++ language" />
<meta name="DocTitle" content="Cadence SKILL Language User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Programming Examples" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="sklanguser" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-08-23" />
<meta name="ModifiedTime" content="1692797220" />
<meta name="NextFile" content="" />
<meta name="Group" content="SKILL Language" />
<meta name="Platform" content="Cadence Shared Tools" />
<meta name="PrevFile" content="chap16.html" />
<meta name="c_product" content="Virtuoso Layout Suite,Virtuoso Schematic Editor,Virtuoso Analog Design Environment" />
<meta name="Product" content="SKILL" />
<meta name="ProductFamily" content="SKILL" />
<meta name="ProductVersion" content="IC23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Cadence SKILL Language User Guide -- Programming Examples" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="IC23.1" />
<meta name="SpaceKey" content="sklanguserIC231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="sklanguserTOC.html">Contents</a></li><li><a class="prev" href="chap16.html" title="SKILL++ Object System">SKILL++ Object System</a></li><li style="float: right;"><a class="viewPrint" href="sklanguser.pdf">View/Print PDF</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Cadence SKILL Language User Guide<br />Product Version IC23.1, September 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>17
<a id="pgfId-1005655"></a></h1>
<h1>
<a id="pgfId-1008199"></a><hr />
<a id="22771"></a>Programming Examples<hr />
</h1>

<p>
<a id="pgfId-1009110"></a>See the following sections for programming examples:</p>
<ul><li>
<a id="pgfId-1009178"></a><a href="chap17.html#11994">List Manipulation</a>  </li><li>
<a id="pgfId-1009180"></a><a href="chap17.html#34996">Symbol Manipulation</a>  </li><li>
<a id="pgfId-1009182"></a><a href="chap17.html#25087">Sorting a List of Points</a> </li><li>
<a id="pgfId-1009184"></a><a href="chap17.html#31687">Computing the Center of a Bounding Box</a>  </li><li>
<a id="pgfId-1009186"></a><a href="chap17.html#24636">Computing the Area of a Bounding Box</a>  </li><li>
<a id="pgfId-1009188"></a><a href="chap17.html#13541">Computing a Bounding Box Centered at a Point</a>  </li><li>
<a id="pgfId-1009190"></a><a href="chap17.html#29859">Computing the Union of Several Bounding Boxes</a>  </li><li>
<a id="pgfId-1009192"></a><a href="chap17.html#19821">Computing the Intersection of Bounding Boxes</a>  </li><li>
<a id="pgfId-1009194"></a><a href="chap17.html#40389">Prime Factorizations</a>  </li><li>
<a id="pgfId-1009204"></a><a href="chap17.html#17751">Fibonacci Function</a>  </li><li>
<a id="pgfId-1009206"></a><a href="chap17.html#32218">Factorial Function</a>  </li><li>
<a id="pgfId-1009208"></a><a href="chap17.html#17204">Exponential Function</a>  </li><li>
<a id="pgfId-1009210"></a><a href="chap17.html#35125">Counting Values in a List</a> </li><li>
<a id="pgfId-1009212"></a><a href="chap17.html#26333">Counting Characters in a String</a>  </li><li>
<a id="pgfId-1009214"></a><a href="chap17.html#16999">Regular Expression Pattern Matching</a> </li><li>
<a id="pgfId-1009216"></a><a href="chap17.html#26238">Geometric Constructions</a> </li><li>
<a id="pgfId-1016976"></a><a href="chap17.html#23809">Examples of How to use Custom Specializers in SKILL++ Methods</a></li></ul>

















<h2>
<a id="pgfId-1008203"></a><a id="11994"></a>List Manipulation</h2>

<p>
<a id="pgfId-1008204"></a>A list is a linear sequence of Cadence&#174; SKILL language data objects. The elements of a list can have any data type, including symbols or other lists. The printed presentation for a SKILL list uses a matching pair of parentheses to enclose the printed representations of the list elements. The <code>trListIntersection</code> and <code>trListUnion</code> functions illustrate</p>
<ul><li>
<a id="pgfId-1008205"></a>Documenting at the function level </li><li>
<a id="pgfId-1008206"></a>Using the <code>setof</code> function </li><li>
<a id="pgfId-1008208"></a>Using the <a id="marker-1008207"></a><code>member</code> function </li></ul>


<p>
<a id="pgfId-1008210"></a>The <code>trListUnion</code> function also illustrates the <code>nconc</code><a id="marker-1008209"></a> function, which destroys all but its last argument. In this case, the first argument is a new, anonymous list created by the <a id="marker-1008211"></a><code>setof</code> function.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008212"></a>procedure( trListIntersection( list1 list2 )<br />    setof( element list1 <br />        member( element list2 )<br />    ) ; setof<br />) ; procedure</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008213"></a>procedure( trListUnion( list1 list2 )<br />    nconc(<br />        setof( element list2<br />            !member( element list1)<br />        ) ; setof<br />        list1<br />    ) ; nconc<br />) ; procedure</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008214"></a>trListIntersection( &#8216;(a b c) &#8216;(b c d)) =&gt; (b c)<br />trListUnion( list(1 2 3) list(3 4 5 6)) =&gt; ( 4 5 6 1 2 3)</pre>
<h2>
<a id="pgfId-1008215"></a><a id="34996"></a>Symbol Manipulation</h2>

<p>
<a id="pgfId-1008216"></a>A symbol is the primary data structure within SKILL. A SKILL symbol has four data slots: the name, the value, the function definition, and the property list. Except for the name slot, all slots can be empty.</p>
<p>
<a id="pgfId-1008217"></a>The <code>trReplaceSymbolsWithValues</code> function makes a copy of an arbitrary SKILL expression, in which all references to a symbol are replaced by the symbol&#8217;s value.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008218"></a>a = &quot;one&quot; b = &quot;two&quot; c = &quot;three&quot;<br />testCase = &#39;( 1 2 ( a b ) )<br />trReplaceSymbolsWithValues( testCase ) =&gt; (1 2 (&quot;one&quot; &quot;two&quot;)) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008219"></a>testCase = &#39;(1 ( a ( c )) b )<br />trReplaceSymbolsWithValues( testCase ) =&gt; (1 (&quot;one&quot; (&quot;three&quot;)) &quot;two&quot;)</pre>

<p>
<a id="pgfId-1008220"></a>The <code>trReplaceSymbolsWithValues</code> illustrates</p>
<ul><li>
<a id="pgfId-1008221"></a>Using recursion to process an arbitrary SKILL expression, making a copy of the expression in which all references to a symbol are replaced by the symbol&#8217;s value.</li><li>
<a id="pgfId-1008223"></a>How the <a id="marker-1008222"></a><code>cond</code> function handles several possibilities. </li></ul>

<p>
<a id="pgfId-1008225"></a>The <a id="marker-1008224"></a><code>listp</code> function determines whether the expression is a list.</p>
<p>
<a id="pgfId-1008227"></a>The <a id="marker-1008226"></a><code>symbolp</code> function determines whether the expression is a list.</p>
<p>
<a id="pgfId-1008229"></a>The <a id="marker-1008228"></a><code>symeval</code> function retrieves the value of the expression, provided it is a symbol.</p>
<p>
<a id="pgfId-1008230"></a>In the general case, the <code>cond</code> function recursively descends into the <code>car</code> of the expression and the <code>cdr</code> of the expression and builds a list from the results.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013211"></a>procedure( trReplaceSymbolsWithValues( expression )<br />    cond(<br />        ( null( expression ) nil )<br />        ( symbolp( expression ) symeval( expression ) )<br />        ( listp( expression )<br />            cons(<br />                trReplaceSymbolsWithValues( car( expression ))<br />                trReplaceSymbolsWithValues( cdr( expression ))<br />                )<br />            )<br />        ( t expression )<br />        ) ; cond<br />) ; procedure</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008232"></a>x = 5<br />a = 1<br />trReplaceSymbolsWithValues( &#8216;(x a))<br />=&gt; (5 1)</pre>
<h2>
<a id="pgfId-1008233"></a><a id="25087"></a>Sorting a List of Points</h2>

<p>
<a id="pgfId-1008234"></a>The <code>trPointLowerLeftp</code> function indicates whether <code>pt1</code> is located to the lower left of <code>pt2</code>. This function illustrates</p>
<ul><li>
<a id="pgfId-1008235"></a>Documenting at the function level </li><li>
<a id="pgfId-1008236"></a>Using the <code>xCoord</code> and <code>yCoord</code> functions <br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1011468"></a>The <code>xCoord</code> and <code>yCoord</code> functions are aliases for the <em><a actuate="user" class="URL" href="../sklangref/list_re_car.html" show="replace" xml:link="simple">car</a></em> and <em><a actuate="user" class="URL" href="../sklangref/list_re_caar_caaar_caadr_cadr_caddr_cdar_cddr.html" show="replace" xml:link="simple">cadr</a></em> functions. </div></li><li>
<a id="pgfId-1008238"></a>Using the <a id="marker-1008237"></a><code>cond</code> function <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008239">
<a id="pgfId-1008239"></a>procedure( trPointLowerLeftp( pt1 pt2 )
    let( ( pt1x pt2x pt1y pt2y )
      pt1x = xCoord( pt1 )
      pt2x = xCoord( pt2 )
      cond(
            ( pt1x &lt; pt2x t )
            ( pt1x == pt2x
                pt1y = yCoord( pt1 )
                pt2y = yCoord( pt2 )
                pt1y &lt; pt2y )
            ( t nil )
      ) ; cond
    ) ; let
) ; procedure</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008240">
<a id="pgfId-1008240"></a>trPointLowerLeftp( 0:0 100:100)
=&gt; t</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008241">
<a id="pgfId-1008241"></a>trPointLowerLeftp( 100:100 0:0)
=&gt; nil</pre></li></ul>








<p>
<a id="pgfId-1008242"></a>The <code>trSortPointList</code> function returns a list of points sorted destructively and illustrates</p>
<ul><li>
<a id="pgfId-1008243"></a>Documenting at the function level </li><li>
<a id="pgfId-1008245"></a>Using the <a id="marker-1008244"></a><code>sort</code> function<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008246">
<a id="pgfId-1008246"></a>procedure( trSortPointList( aPointList )
    sort( aPointList &#39;trPointLowerLeftp )
); procedure</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008247">
<a id="pgfId-1008247"></a>x = list(100:0 100:100 0:0 50:50 0:100)
trSortPointList( x )
=&gt; 
(( 0 0)
(0 100)
(50 50)
(100 0)
(100 100))</pre></li></ul>




<h2>
<a id="pgfId-1008248"></a><a id="31687"></a>Computing the Center of a Bounding Box</h2>

<p>
<a id="pgfId-1008250"></a>The <code>trBBoxCenter</code> function returns the point at the center of a bounding box and illustrates<a id="marker-1008249"></a></p>
<ul><li>
<a id="pgfId-1008251"></a>Documenting at the function level </li><li>
<a id="pgfId-1008254"></a>Using the <a id="marker-1008252"></a><code>xCoord</code> and <code>yCoord</code><a id="marker-1008253"></a> function </li><li>
<a id="pgfId-1008257"></a>Using the <a id="marker-1008255"></a><code>lowerLeft</code> and <code>upperRight</code><a id="marker-1008256"></a> function </li><li>
<a id="pgfId-1008259"></a>Using the colon (:) <a id="marker-1008258"></a>operator to build a point <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008261">
<a id="pgfId-1008261"></a>procedure( trBBoxCenter( bBox )
    let( ( llx lly urx ury )
        ury = yCoord( upperRight( bBox ))
        urx = xCoord( upperRight( bBox ))

        llx = xCoord( lowerLeft( bBox ))
        lly = yCoord( lowerLeft( bBox ))
        ( urx + llx )/2 : ( ury + lly )/2
    ) ; let
) ; procedure</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008262">
<a id="pgfId-1008262"></a>trBBoxCenter( list(0:0 100:100))
=&gt; (50 50)</pre></li></ul>






<h2>
<a id="pgfId-1008263"></a><a id="24636"></a>Computing the Area of a Bounding Box</h2>

<p>
<a id="pgfId-1008264"></a>The <code>trBBoxArea</code> function returns the area of a bounding box and illustrates</p>
<ul><li>
<a id="pgfId-1008265"></a>Documenting at the function level </li><li>
<a id="pgfId-1008266"></a>Using the <code>xCoord</code> and <code>yCoord</code> functions </li><li>
<a id="pgfId-1008267"></a>Using the <code>lowerLeft</code> and <code>upperRight</code> functions </li><li>
<a id="pgfId-1008268"></a>Using parentheses to change priority of arithmetic operations <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008270">
<a id="pgfId-1008270"></a>procedure( trBBoxArea( bBox )
    let( ( llx lly urx ury )
        urx = xCoord( upperRight( bBox ))
        ury = yCoord( upperRight( bBox ))
        llx = xCoord( lowerLeft( bBox ))
        lly = yCoord( lowerLeft( bBox ))
        ( ury - lly ) * ( urx - llx )
    ) ; let
) ; procedure</pre></li></ul>





<h2>
<a id="pgfId-1008271"></a><a id="13541"></a>Computing a Bounding Box Centered at a Point</h2>

<p>
<a id="pgfId-1008272"></a>The <code>trDot</code> function returns bounding box coordinates with a given point as its center and illustrates</p>
<ul><li>
<a id="pgfId-1008274"></a>Using <a id="marker-1008273"></a><code>@key</code> to declare keyword arguments </li><li>
<a id="pgfId-1008275"></a>Establishing default values for a keyword argument </li><li>
<a id="pgfId-1008276"></a>Documenting at the function level </li><li>
<a id="pgfId-1008277"></a>Using the <code>let</code> function </li><li>
<a id="pgfId-1008278"></a>Using the <code>xCoord</code> and <code>yCoord</code> functions </li><li>
<a id="pgfId-1008279"></a>Building a bounding box with the <code>list</code> function and colon (:) operator <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008280">
<a id="pgfId-1008280"></a>procedure( trDot( aPoint @key ( deltaX 1 ) ( deltaY 1 ) )
    let( ( llx lly urx ury aPointX aPointY )
        aPointX = xCoord( aPoint )
        aPointY = yCoord( aPoint )
        llx = aPointX - deltaX
        urx = aPointX + deltaX
        lly = aPointY - deltaY
        ury = aPointY + deltaY
        list( llx:lly urx:ury )
    ) ; let
) ; procedure</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008281">
<a id="pgfId-1008281"></a>trDot( 100:100 ?deltaX 50 ?deltaY 50)
=&gt; ((50 50) (150 150))</pre></li></ul>








<h2>
<a id="pgfId-1008282"></a><a id="29859"></a>Computing the Union of Several Bounding Boxes</h2>

<p>
<a id="pgfId-1008283"></a>The <code>trBBoxUnion</code> function returns the smallest bounding box coordinates containing all the boxes in a given list and illustrates</p>
<ul><li>
<a id="pgfId-1008284"></a>Using <code>foreach( mapcar &#8230; )</code> </li><li>
<a id="pgfId-1008288"></a>Using the <a id="marker-1008285"></a><code>apply</code> function with the <code>min</code><a id="marker-1008286"></a> and<a id="marker-1008287"></a> <code>max</code> functions </li><li>
<a id="pgfId-1008289"></a>Using the <code>list</code> function and the colon (:) operator to construct a bounding box </li><li>
<a id="pgfId-1008290"></a>Documenting at the function level <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008291">
<a id="pgfId-1008291"></a>procedure( trBBoxUnion( bBoxList )
    let( ( llxList llyList
        urxList     uryList
        minllx      minlly
        maxurx      maxury
        )
        llxList = foreach( mapcar bBox bBoxList
            xCoord( lowerLeft( bBox )))
        llyList = foreach( mapcar bBox bBoxList
            yCoord( lowerLeft( bBox )))
        urxList = foreach( mapcar bBox bBoxList
            xCoord( upperRight( bBox )))
        uryList = foreach( mapcar bBox bBoxList
            yCoord( upperRight( bBox )))
        minllx = apply( &#39;min llxList )
        minlly = apply( &#39;min llyList )
        maxurx = apply( &#39;max urxList )
        maxury = apply( &#39;max uryList )
        list( minllx:minlly maxurx:maxury )
    ) ; let
) ; procedure</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008292">
<a id="pgfId-1008292"></a>trBBoxUnion( list( list(0:0 100:100) list(50:50 150:150)))
=&gt; ((0 0) (150 150))</pre></li></ul>






<h2>
<a id="pgfId-1008293"></a><a id="19821"></a>Computing the Intersection of Bounding Boxes</h2>

<p>
<a id="pgfId-1008294"></a>The <code>trBBoxIntersection</code> function illustrates </p>
<ul><li>
<a id="pgfId-1008295"></a>Using <code>foreach( mapcar &#8230; )</code> </li><li>
<a id="pgfId-1008296"></a>Using the <code>apply</code> function with the <code>min</code> and <code>max</code> functions </li><li>
<a id="pgfId-1008297"></a>Using the <code>cond</code> function </li><li>
<a id="pgfId-1008298"></a>Using the <code>list</code> function and colon (:) operator to construct a bounding box <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008299">
<a id="pgfId-1008299"></a>procedure( trBBoxIntersection( bBoxList )
    let( ( llxList llyList 
        urxList     uryList
        maxllx      maxlly
        minurx      minury      )
        llxList = foreach( mapcar bBox bBoxList
            xCoord( lowerLeft( bBox )))
        llyList = foreach( mapcar bBox bBoxList
            yCoord( lowerLeft( bBox )))
        urxList = foreach( mapcar bBox bBoxList
            xCoord( upperRight( bBox )))
        uryList = foreach( mapcar bBox bBoxList
            yCoord( upperRight( bBox )))
        minurx = apply( &#39;min urxList )
        minury = apply( &#39;min uryList )
        maxllx = apply( &#39;max llxList )
        maxlly = apply( &#39;max llyList )
        cond(
            ( maxllx &gt;= minurx nil )
            ( maxlly &gt;= minury nil )
            ( t
                list( maxllx:maxlly minurx:minury ))
            ) ; cond
      ) ; let
) ; procedure</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008300">
<a id="pgfId-1008300"></a>trBBoxIntersection( list( list(0:0 100:100) list(50:50 150:150))) =&gt;
( (50 50) (100 100))</pre></li></ul>






<h2>
<a id="pgfId-1008301"></a><a id="40389"></a>Prime Factorizations</h2>

<p>
<a id="pgfId-1008303"></a>A <a id="marker-1008302"></a>prime factorization of an integer is a list of pairs and is an example of an association list. The first element of each pair is a prime number that divides the number and the second element is the exponent to which the prime is to be raised. Each such pair is termed a prime-exponent pair. </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008304"></a>pf1 = &#39;( ( 2 3 ) ( 3 5 ))<br />pf2 = &#39;( ( 3 2 ) ( 5 2 ) ( 7 3 ))<br />
pf3 = &#39;( ( 3 2 ) ( 5 4 ) ( 7 2 ))
pf4 = &#39;( ( 3 6 ) ( 7 3 ) ( 11 2 ) ( 5 1 ))</pre>

<p>
<a id="pgfId-1008305"></a>The <code>assoc</code> function is used to determine whether a prime number occurs in a prime factorization. It returns either the prime-exponent pair or <code>nil</code>. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008306"></a>assoc( 2 pf1 ) =&gt; ( 2 3 )<br />assoc( 7 pf2 ) =&gt; ( 7 3 )</pre>
<h3>
<a id="pgfId-1008307"></a>Evaluating a Prime Factorization </h3>

<p>
<a id="pgfId-1008308"></a>To evaluate the prime factorization means to perform the arithmetic operations implied: </p>
<ul><li>
<a id="pgfId-1008309"></a>For each prime-exponent pair, raise the prime to the corresponding exponent </li><li>
<a id="pgfId-1008310"></a>Multiply the resulting list of integers together </li></ul>

<p>
<a id="pgfId-1008311"></a>For example, evaluating the prime factorization </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008312"></a>( ( 3 2 ) ( 5 2 ) ( 7 3 ))</pre>

<p>
<a id="pgfId-1008313"></a>is equivalent to evaluating</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008314"></a>3**2 * 5**2 * 7**3 </pre>

<p>
<a id="pgfId-1008315"></a>The <code>trTimes</code> functions multiplies a list of numbers together. It handles two cases that the <code>times</code> function does not handle.</p>
<p>
<a id="pgfId-1008316"></a>The <code>trTimes</code> function illustrates</p>
<ul><li>
<a id="pgfId-1008317"></a>Using an <code>@rest</code> argument to collect an arbitrary number of arguments into a list.</li><li>
<a id="pgfId-1008318"></a>Using the <code>apply</code> function. In the general case, we use the <code>apply</code> function to invoke the normal times function </li><li>
<a id="pgfId-1008319"></a>Using the <code>cond</code> function</li><li>
<a id="pgfId-1011561"></a>The <code>null</code> function tests for an empty list. The <code>onep</code> function tests whether a number is one <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008320">
<a id="pgfId-1008320"></a>procedure( trTimes( @rest args )
    cond(
        ( null( args ) 1 )
        ( onep( length( args ) ) car( args ))
        ( t apply( &#39;times args ))
    ) ; cond
) ; procedure</pre></li></ul>




<p>
<a id="pgfId-1008321"></a>The <code>trEvalPF</code> function evaluates the prime factorizations. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008322"></a>pf1 = &#39;( ( 2 3 ) ( 3 5 ))<br />pf2 = &#39;( ( 3 2 ) ( 5 2 ) ( 7 3 ))<br />trEvalPF( pf1 ) =&gt; 1944<br />trEvalPF( pf2 ) =&gt; 77175 </pre>

<p>
<a id="pgfId-1008323"></a>The <code>trEvalPF</code> function illustrates</p>
<ul><li>
<a id="pgfId-1008324"></a>Using the <code>apply</code> function with the <code>trTimes</code> function above </li><li>
<a id="pgfId-1008325"></a>Using the <code>foreach( mapcar &#8230; )</code> </li><li>
<a id="pgfId-1008328"></a>Using the <a id="marker-1008326"></a><code>car</code> and <code>cadr</code><a id="marker-1008327"></a> functions <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008329">
<a id="pgfId-1008329"></a>procedure( trEvalPF( pf )
    apply( &#39;trTimes 
        foreach( mapcar pePair pf 
            car( pePair )**cadr( pePair )
        ) ; foreach
    ) ; apply
) ; procedure</pre></li></ul>




<h3>
<a id="pgfId-1008330"></a>Computing the Prime Factorization</h3>

<p>
<a id="pgfId-1008331"></a>The <code>trLargestExp</code> function returns the largest <code>x</code> such that divisor ** x &lt;= number and illustrates</p>
<ul><li>
<a id="pgfId-1008332"></a>Documenting at the function level </li><li>
<a id="pgfId-1008334"></a>Using the <a id="marker-1008333"></a><code>preincrement</code> operator </li><li>
<a id="pgfId-1008336"></a>Using the <a id="marker-1008335"></a><code>let</code> expression to initialize a local variable to a non-nil value </li><li>
<a id="pgfId-1008338"></a>Using the <a id="marker-1008337"></a><code>while</code> function <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008339">
<a id="pgfId-1008339"></a>procedure( trLargestExp( number divisor )
    let( ( ( exp 0 ) )
        while( zerop( mod( number divisor ) )
            ++exp
            number = number / divisor
            ) ; while
        exp
        ) ; let
    ) ; procedure</pre></li></ul>




<p>
<a id="pgfId-1008340"></a>The <code>trPF</code> function returns the prime factorization a number. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008341"></a>trPF( 1003 )     =&gt; ((59 1) (17 1))<br />trPF( 10003 )    =&gt; ((1429 1) (7 1))<br />trPF( 100003 )   =&gt; ((100003 1))<br />trPF( 123456 )&#160;&#160; =&gt; ((643 1) (3 1) (2 6))</pre>

<p>
<a id="pgfId-1008342"></a>The <code>trPF</code> function illustrates</p>
<ul><li>
<a id="pgfId-1008343"></a>Documenting at the function level </li><li>
<a id="pgfId-1008345"></a>Using the <a id="marker-1008344"></a><code>postincrement</code> operator </li><li>
<a id="pgfId-1008346"></a>Using the <code>let</code> expression to initialize a local variable to a non-<code>nil</code> value </li><li>
<a id="pgfId-1008347"></a>Using the <code>while</code> function </li><li>
<a id="pgfId-1008348"></a>Using parentheses to control operator precedence </li><li>
<a id="pgfId-1008349"></a>Using <code>let</code> to initialize a local variables to non-nil values </li><li>
<a id="pgfId-1008350"></a>Using a <code>while</code> loop </li><li>
<a id="pgfId-1008352"></a>Using <a id="marker-1008351"></a><code>when</code> with an embedded assignment expression </li><li>
<a id="pgfId-1008353"></a>Using <code>trLargestExp</code> <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008354">
<a id="pgfId-1008354"></a>procedure( trPF( aNumber )
    let(       (       ; locals
        ( divisor 2 ) 
        result 
        exp 
        ( num aNumber )
        )
        while( num &gt; 1 
            when( ( exp = trLargestExp( num divisor )) &gt; 0 
                result = cons( list( divisor exp ) result ) 
                num = num / divisor ** exp
                ) ; when
            divisor++        ;;; try next divisor
            ) ; while
        result 
    ) ; let
) ; procedure</pre></li></ul>










<h3>
<a id="pgfId-1008355"></a>Multiplying Two Prime Factorizations</h3>

<p>
<a id="pgfId-1008356"></a>The <code>trPFMult</code> function returns the prime factorization of the product of two prime factorizations<code>, pf1</code> and <code>pf2</code>. The <code>trPFMult</code> function uses the following algorithm to construct the resultant prime factorization.</p>
<ol><li>
<a id="pgfId-1008357"></a>Those prime-exponent pairs whose primes occur in only one of the prime factorizations lists are carried across unaltered into the resultant prime factorization.</li><li>
<a id="pgfId-1008358"></a>For those primes that have entries in both prime factorizations, a prime-exponent pair using the prime is included with an exponent equal to the sum of prime&#8217;s exponent in either prime factorization.</li></ol>

<p>
<a id="pgfId-1008359"></a>The <code>trPFMult</code> function illustrates</p>
<ul><li>
<a id="pgfId-1008360"></a>Using the <code>setof</code> function and the <code>assoc</code> function to build two prime factorizations <br />
<a id="pgfId-1008361"></a>The list <code>pf1Notpf2</code> contains all the prime-exponent pairs in <code>pf1</code> whose prime does not occur in <code>pf2</code>.<br />
<a id="pgfId-1008362"></a>The list<code> pf2Notpf1</code> contains all the prime-exponent pairs in <code>pf2</code> whose prime does not occur in <code>pf1</code>.</li><li>
<a id="pgfId-1008363"></a>Using <code>foreach( mapcan &#8230; )</code> to manage the lists of primes found in both lists <br />
<a id="pgfId-1008364"></a>The list<code> bothpf1Andpf2 </code>contains prime-exponent pairs whose primes are found in both <code>pf1</code> and <code>pf2</code>. The exponent is the sum of the exponent for the prime in <code>pf1</code> and <code>pf2</code>.</li><li>
<a id="pgfId-1008365"></a>Using the backquote (&#8216;) and comma (,) operators </li><li>
<a id="pgfId-1008366"></a>Using the <code>nconc</code> function to destructively append the three lists <code>pf1Notpf2, pf2Notpf1</code>, and <code>bothpf1Andpf2</code> <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008367">
<a id="pgfId-1008367"></a>trPFMult( pf1 pf2 ) =&gt; ( ( 2 3 ) ( 5 2 ) ( 7 3 ) ( 3 7 ))</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1013217">
<a id="pgfId-1013217"></a>procedure( trPFMult( pf1 pf2 )
    let( ( pf1Notpf2 pf2Notpf1 bothpf1Andpf2 pePair2 )
        pf1Notpf2 = setof( pePair1 pf1 
            !assoc( car( pePair1 ) pf2 )
            )
        pf2Notpf1 = setof( pePair2 pf2
            !assoc( car( pePair2 ) pf1 )
            )
        bothpf1Andpf2 = foreach( mapcan pePair1 pf1
            when( pePair2 = assoc( car( pePair1 ) pf2 )
                ;; build a list containing a single prime-exponent pair.
                ;; The mapcan option to the foreach function
                ;; destructively appends these lists together.
                &#8216;( ( 
                    ,car( pePair1 ) 
                    ,(cadr( pePair1 )+cadr( pePair2 ))
                 ) )
            ) ; when
        ) ; foreach
        ;; destructively append the three lists together.
        nconc( pf1Notpf2 pf2Notpf1 bothpf1Andpf2 )
    ) ; let
) ; procedure</pre></li></ul>









<h3>
<a id="pgfId-1008369"></a>Using Prime Factorizations to Compute the GCD</h3>

<p>
<a id="pgfId-1008370"></a>The <code>trPFGCD</code> function returns the prime factorization of the greatest common denominator (GCD) of two prime factorizations. This function illustrates</p>
<ul><li>
<a id="pgfId-1008371"></a>Using <code>foreach( mapcan &#8230; )</code> to merge two association lists.<br />
<a id="pgfId-1013247"></a>Primes found in both association lists are given an exponent equal to the minimum of the exponents in both the association lists.</li><li>
<a id="pgfId-1008372"></a>Using the backquote (<code>&#8216;</code>) and comma (<code>,</code>) operators.</li></ul>



<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013236"></a>procedure( trPFGCD( pf1 pf2 )<br />    let( ( pePair2 )<br />        foreach( mapcan pePair1 pf1<br />            pePair2 = assoc( car( pePair1 ) pf2 )<br />            when( pePair2 <br />                ;; build a list containing a single prime-exponent pair.<br />                ;; The mapcan option to the foreach function <br />                ;; destructively appends these lists together.<br />                &#8216;( ( <br />                    ,car( pePair1 ) <br />                    ,min( cadr( pePair1 ) cadr( pePair2 ) )<br />                 ) )<br />            ) ; when<br />        ) ; foreach<br />    ) ; let<br />) ; procedure</pre>

<p>
<a id="pgfId-1008375"></a>The <code>trGCD</code> function illustrates finding the greatest common denominator (GCD) of two numbers by </p>
<ul><li>
<a id="pgfId-1008376"></a>Finding their prime factorizations </li><li>
<a id="pgfId-1008377"></a>Manipulating the prime factorizations to find the prime factorization of the GCD </li><li>
<a id="pgfId-1008378"></a>Evaluating the prime factorization </li></ul>



<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008379"></a>procedure( trGCD( num1 num2 )<br />    trEvalPF( trPFGCD( trPF( num1 ) trPF( num2 )) )<br />    ) ; procedure</pre>
<h2>
<a id="pgfId-1008381"></a><a id="17751"></a>Fibonacci Function</h2>

<p>
<a id="pgfId-1008383"></a>This example illustrates a recursive implementation of the <a id="marker-1008382"></a>Fibonacci function, implemented directly from the mathematical definition.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008384"></a>procedure( fibonacci(n) <br />if( (n == 1 || n == 2) then 1 <br />else fibonacci(n-1) + fibonacci(n-2) <br />))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008385"></a>fibonacci(3)&#160;&#160;       =&gt; 2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008386"></a>fibonacci(6)&#160;&#160;       =&gt; 8</pre>

<p>
<a id="pgfId-1008387"></a>The same example implemented in SKILL using LISP syntax looks like the following:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008388"></a>(defun fibonacci (n)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008389"></a>    (cond<br />        ((or (equal n 1) (equal n 2)) 1)<br />        (t (plus (fibonacci (difference n 1)) <br />                 (fibonacci (difference n 2))))<br />    )<br />)</pre>
<h2>
<a id="pgfId-1008390"></a><a id="32218"></a>Factorial Function</h2>

<p>
<a id="pgfId-1008391"></a>This is the recursive implementation of the factorial function </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008392"></a>procedure( factorial( n )<br />    if( zerop( n ) then <br />        1 <br />    else <br />        n*factorial( n-1) <br />    ) ; if<br />) ; procedure </pre>

<p>
<a id="pgfId-1008393"></a>This is an iterative implementation</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008394"></a>procedure( factorial( n )<br />    let( ( ( f 1 ))<br />        for( i 1 n <br />            f = f*i<br />            ) ; for<br />        f ;;; return the value of f<br />    ) ; let<br />) ; procedure</pre>
<h2>
<a id="pgfId-1008395"></a><a id="17204"></a>Exponential Function</h2>

<p>
<a id="pgfId-1008396"></a>This function computes e to the power x by summing terms of the power series expansion of the mathematical function. It uses the factorial function.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008397"></a>procedure( e( x )<br />  let( ((sum 1.0))<br />        for( n 1 10<br />              sum = sum + (1.0/factorial(n)) * x**n<br />              ) ; for<br />        sum         ;;; return the value of sum.<br />  ) ; let<br />) ; procedure</pre>

<p>
<a id="pgfId-1008398"></a>To get a sense of the accuracy of this implementation of the e function, observe</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008399"></a>e( log( 10 ) ) =&gt; 9.999702 ;; should be 10.0</pre>
<h2>
<a id="pgfId-1008400"></a><a id="35125"></a>Counting Values in a List</h2>

<p>
<a id="pgfId-1008401"></a>The <code>trCountValues</code> function tallies the number of times each distinct value occurs as a top-level element of a list. It prints a report and returns an association list that pairs each unique value with it&#8217;s count. Two implementations are presented. The results are equivalent except for ordering.</p>
<ul><li>
<a id="pgfId-1008402"></a>The first implementation of <code>trCountValues</code> produces <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008403">
<a id="pgfId-1008403"></a>trCountValues( &#39;( 1 2 a b 2 b 3 ) ) =&gt;
      ((a 1) (b 2) (3 1) (2 2) (1 1))</pre>
<a id="pgfId-1008404"></a>and prints <pre class="webflare-pre-block webflare-courier-new" id="#id1008405">
<a id="pgfId-1008405"></a>1 occurred 1 times.
2 occurred 2 times.
3 occurred 1 times.
b occurred 2 times.
a occurred 1 times.</pre></li><li>
<a id="pgfId-1008406"></a>The second implementation of <code>trCountValues</code> produces <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008407">
<a id="pgfId-1008407"></a>trCountValues( &#39;( 1 2 a b 2 b 3 ) ) =&gt;
      ((3 1) (b 2) (a 1) (2 2) (1 1))</pre>
<a id="pgfId-1008408"></a>and prints<pre class="webflare-pre-block webflare-courier-new" id="#id1008409">
<a id="pgfId-1008409"></a>3 occurred 1 times.
b occurred 2 times.
a occurred 1 times.
2 occurred 2 times.
1 occurred 1 times.</pre></li></ul>







<p>
<a id="pgfId-1008410"></a>The first implementation of the <code>trCountValues</code> function illustrates </p>
<ul><li>
<a id="pgfId-1008411"></a>Using an association table to maintain the counts <br />
<a id="pgfId-1008412"></a>Each element in the list is used as an index into the table. </li><li>
<a id="pgfId-1008413"></a>Using the <code>tableToList</code> function to build an association list for an association table <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008414">
<a id="pgfId-1008414"></a>procedure( trCountValues( aList )
    let( ( ( countTable makeTable( &quot;ValueTable&quot; 0 ) ) )
 
        foreach( element aList
            countTable[ element ] = countTable[ element ] + 1
            ) ; foreach

        foreach( key countTable
            printf( &quot; %L occurred %d times.\n&quot; 
                  key countTable[ key ] )
            ) ; foreach

        tableToList( countTable ) ;; convert to assoc list
    ) ; let
) ; procedure</pre></li></ul>



<p>
<a id="pgfId-1008415"></a>The second implementation of the <code>trCountValues</code> function illustrates </p>
<ul><li>
<a id="pgfId-1008416"></a>Using an association list to maintain the counts </li><li>
<a id="pgfId-1008418"></a>Using the <a id="marker-1008417"></a><code>assoc</code> function to retrieve an entry, if any, for an element </li><li>
<a id="pgfId-1008420"></a>Using the <a id="marker-1008419"></a><code>rplaca</code> function to update the count for an entry <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1013271">
<a id="pgfId-1013271"></a>procedure( trCountValues( aList )
    let( ( countAssocList countEntry count )

      foreach( element aList
          countEntry = assoc( element countAssocList )
          if( countEntry
              then ;; update the count for this element
                  count = cadr( countEntry )
                  rplaca( cdr( countEntry ) ++count )
              else ;; add an new entry for this element
                  countAssocList = cons( 
                        list( element 1 ) ;; new entry
                        countAssocList )
              ) ; if
          ) ; foreach

      foreach( entry countAssocList
          printf( &quot; %L occurred %d times.\n&quot; 
                car( entry )         ;; the element 
                cadr( entry )   ;; the count
                )
          ) ; foreach

      countAssocList          ;; return value
      ) ; let
  ) ; procedure</pre></li></ul>




<h2>
<a id="pgfId-1008422"></a><a id="26333"></a>Counting Characters in a String</h2>

<p>
<a id="pgfId-1008423"></a>The <code>trCountCharacters</code> function counts the occurrences of characters in a string.</p>
<p>
<a id="pgfId-1008424"></a>The <code>trCountCharacters</code> illustrates </p>
<ul><li>
<a id="pgfId-1008426"></a>Using the<a id="marker-1008425"></a> <code>parseString</code> function to construct a list of characters that occur in a string </li><li>
<a id="pgfId-1008427"></a>Using either implementation of the <code>trCountValues</code> function to count the occurrences of the single-character strings <a id="marker-1008428"></a><br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008429">
<a id="pgfId-1008429"></a>procedure( trCountCharacters( aString )
    trCountValues( parseString( aString &quot;&quot; ))
    ) ; procedure</pre></li></ul>



<h2>
<a id="pgfId-1008430"></a><a id="16999"></a>Regular Expression Pattern Matching</h2>

<p>
<a id="pgfId-1008432"></a>The following functions take the regular expression <a id="marker-1008431"></a>pattern matching functions <a id="marker-1008433"></a><code>rexMatchp </code>and<code> rexMatchList</code><a id="marker-1008434"></a> provided by SKILL and build two new functions <code>shMatchp </code>and<code> shMatchList</code>, which provide a simple shell-filename-like pattern matching facility.</p>
<p>
<a id="pgfId-1008435"></a>The rules:</p>
<ul><li>
<a id="pgfId-1008436"></a>Target strings should be single words</li><li>
<a id="pgfId-1008437"></a>A pattern is to match the entire target words</li><li>
<a id="pgfId-1008926"></a>Special characters in a pattern:<br />
<a id="pgfId-1009867"></a><table class="webflareTable webflareTableIndent" id="#id1009871">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009873"></a><code>*</code></p>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009875"></a>Matches any string, including the null string</p>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009877"></a><code>?</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009879"></a>Matches any single character</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009881"></a><code>[&#8230;] </code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009883"></a>Same as in the original <code>rex</code> package</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009885"></a><code>. </code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009887"></a>Matches <code>.</code> literally</p>
</td>
</tr>
</tbody></table></li></ul>






<p>
<a id="pgfId-1008931"></a>The function <code>sh2ed</code> is used to build a regular expression that is passed to the<code> rex</code> functions.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008444"></a>(defun sh2ed (s)<br />    (let ((sh_chars (parseString s &quot;&quot;))<br />        (ed_chars (tconc nil &quot;^&quot;)))<br />        (while sh_chars<br />            (case (car sh_chars)<br />                (&quot;*&quot; (tconc ed_chars &quot;.&quot;) (tconc ed_chars &quot;*&quot;))<br />                (&quot;?&quot; (tconc ed_chars &quot;.&quot;))<br />                (&quot;.&quot; (tconc ed_chars &quot;\\&quot;) (tconc ed_chars &quot;.&quot;))<br />                (t (tconc ed_chars (car sh_chars))))<br />            (setq sh_chars (cdr sh_chars)))<br />            (tconc ed_chars &quot;$&quot;)<br />            (buildString (car ed_chars) &quot;&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013280"></a>(defun shMatchp (pattern target)<br />    (rexMatchp (sh2ed pattern) target))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013281"></a>(defun shMatchList (pattern targets)<br />    (rexMatchList (sh2ed pattern) targets))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1009905"></a>shMatchp(&quot;*.out&quot; &quot;a.out&quot;)        =&gt; t<br />shMatchp(&quot;test.??&quot; &quot;test.il&quot;)     =&gt; t<br />shMatchp(&quot;*.??&quot; &quot;test.out&quot;)      =&gt; nil<br />
shMatchList(&quot;*test.?&quot; &#39;(&quot;ALUtest.1&quot; &quot;data.in&quot; &quot;MEMtest.13&quot; &quot;test.5&quot;))=&gt; (&quot;ALUtest.1&quot; &quot;test.5&quot;)</pre>
<h2>
<a id="pgfId-1009907"></a><a id="26238"></a>Geometric Constructions</h2>

<p>
<a id="pgfId-1008449"></a>Here is an extensive example of a SKILL++ Object Layer application.</p>

<h3>
<a id="pgfId-1008450"></a>Application Domain</h3>

<p>
<a id="pgfId-1008451"></a>A geometric construction is a collection of points and lines you build up from an initial collection of points. The initial collection of points are called <code>free</code> points. You can add points and lines to the collection through various familiar constraints. You can constrain</p>
<ul><li>
<a id="pgfId-1008452"></a>A point to lie on two interesecting lines </li><li>
<a id="pgfId-1008453"></a>A line to pass through two points </li><li>
<a id="pgfId-1008454"></a>A line to pass through a point and to be parallel to another line </li><li>
<a id="pgfId-1008455"></a>A line to pass through a point and to be perpendicular to another line </li></ul>



<p>
<a id="pgfId-1008456"></a>When you move any one of the free points, the application propagates the change to all the constrained points and lines </p>

<h4>
<a id="pgfId-1008457"></a>Example</h4>

<ol><li>
<a id="pgfId-1008458"></a>You specify the free points P and Q.</li><li>
<a id="pgfId-1008459"></a>You construct the line PQ passing through P and Q.</li><li>
<a id="pgfId-1008460"></a>You specify the free points R and S.</li><li>
<a id="pgfId-1008461"></a>You construct the line RS passing through R and S.</li><li>
<a id="pgfId-1008462"></a>You construct the intersection point Z of the line PQ and the line RS.<br />
<a id="pgfId-1009730"></a><div class="webflare-div-image">
<img width="402" height="242" src="images/chap17-2.gif" /></div></li></ol>








<p>
<a id="pgfId-1008479"></a>When you move any of the points P, Q, R, or S the lines PQ and RS and the point Z move accordingly.</p>

<h3>
<a id="pgfId-1008480"></a>Implementation</h3>

<p>
<a id="pgfId-1008481"></a>The implementation uses the SKILL++ Object System to define several classes and generic functions. The following sections discuss </p>
<ul><li>
<a id="pgfId-1008482"></a>The class hierarchy </li><li>
<a id="pgfId-1008483"></a>The generic functions </li><li>
<a id="pgfId-1008484"></a>The source code </li><li>
<a id="pgfId-1008485"></a>Several examples </li></ul>



<p>
<a id="pgfId-1008486"></a>To focus on SKILL++ language issues, the implementation does not address graphics. Instead, you non-graphically </p>
<ol><li>
<a id="pgfId-1008487"></a>Call a SKILL function repeatedly to specify several free points. </li><li>
<a id="pgfId-1008488"></a>Call other SKILL functions to construct the dependent points and lines. </li><li>
<a id="pgfId-1008489"></a>Enter a SKILL expression to change the coordinates of one of the free points.</li><li>
<a id="pgfId-1008490"></a>Call a SKILL function to propagate the change through the constrainted points and lines.</li><li>
<a id="pgfId-1008491"></a>Call a SKILL function to describe one of the constrained points or lines.</li></ol>





<h3>
<a id="pgfId-1008492"></a>Classes</h3>

<p>
<a id="pgfId-1008493"></a>The implementation uses the SKILL++ Object System to define several classes in the following class hierarchy. </p>

<p>
<a id="pgfId-1009756"></a></p>
<div class="webflare-div-image">
<img width="665" height="189" src="images/chap17-3.gif" /></div>
<h4>
<a id="pgfId-1008508"></a>GeometricObject Class</h4>

<p>
<a id="pgfId-1008509"></a>The <code>GeometricObject</code> class represents all the objects in the construction. It defines the <code>constraints</code> slot. This slot lists all the other objects which need to be notfied when the object updates.</p>

<h4>
<a id="pgfId-1008510"></a>Point Class</h4>

<p>
<a id="pgfId-1008511"></a>The <code>Point</code> class represents a point with slots x and y.</p>

<h4>
<a id="pgfId-1008512"></a>Line Class</h4>

<p>
<a id="pgfId-1008513"></a>The <code>Line</code> class represents a line with the slots A, B, and C. These are the coefficients in the line&#8217;s equation </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008514"></a>Ax+By+C = 0</pre>
<h4>
<a id="pgfId-1008515"></a>IntersectionTwoLines_Point Class</h4>

<p>
<a id="pgfId-1008516"></a>The <code>IntersectionTwoLines_Point</code> class is a subclass of the <code>Point </code>class and represents a point that lies on two intersecting lines. It includes two slots that store the lines.</p>

<h4>
<a id="pgfId-1008517"></a>TwoPoints_Line Class</h4>

<p>
<a id="pgfId-1008518"></a>The <code>TwoPoints_Line</code> class is a subclass of the <code>Line</code> class and represents a line passing through two points. The class defines two slots to store the points.</p>

<h4>
<a id="pgfId-1008519"></a>ParallelLineThroughPoint_Line Class </h4>

<p>
<a id="pgfId-1008520"></a>The <code>ParallelLineThroughPoint_Line</code> class is a subclass of the <code>Line</code> class and represents a line that passes through a point parallel to another line.</p>
<p>
<a id="pgfId-1008521"></a>To specify a free point, you instantiate the <code>Point</code> class. To specify a constrained point or line, you instantiate the associated subclass.</p>

<h3>
<a id="pgfId-1008522"></a>Generic Functions</h3>

<p>
<a id="pgfId-1008523"></a>The implementation uses several generic functions.</p>
<ul><li>
<a id="pgfId-1008524"></a>The <code>Update</code> function propagates changes. It updates the coordinates or equations of an object and call itself recursively for each dependent object.</li><li>
<a id="pgfId-1008525"></a>The <code>Describe</code> function prints a description of an object and calls itself recursively for each dependent object.</li><li>
<a id="pgfId-1008526"></a>The <code>Validate</code> function verifies that a point or line satisfies its constraints.</li><li>
<a id="pgfId-1008527"></a>The <code>Connect</code> function adds an object to another object&#8217;s list of constraints.</li></ul>



<p>
<a id="pgfId-1008528"></a>The <code>defgeneric</code> declarations for these generic functions each a declare default method that raises an error.</p>

<h3>
<a id="pgfId-1008529"></a>Describing the Methods by Class</h3>

<p>
<a id="pgfId-1008530"></a>The following tables describe, for each generic function, all the methods by class. In the following tables, </p>
<ul><li>
<a id="pgfId-1008531"></a>Earlier rows are at the same level or higher in the class hierarchy.</li><li>
<a id="pgfId-1008532"></a>The etc. rows refer to other constraint subclasses of <code>Point</code> or <code>Line</code> that you can add to the implementation to extend its functionality.<br />
<a id="pgfId-1009779"></a><table class="webflareTable" id="#id1009784">
<caption style="text-align:left;"><p>
</p><div class="ft-figtabl-title">
<a id="pgfId-1009786"></a>Update Methods</div></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1009790">
<a id="pgfId-1009790"></a>Class</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1009792">
<a id="pgfId-1009792"></a>Action</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009794"></a>GeometricObject</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009796"></a>Call <code>Update</code> for each of the dependent objects.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009798"></a>Point</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009800"></a>No method for this class.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009802"></a>Line</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009804"></a>No method for this class.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009806"></a>IntersectionTwoLines_Point</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009808"></a>Based on the two lines, recompute the coordinate of the point. Call the next <code>Update</code> method.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009810"></a>TwoPoints_Line</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009812"></a>Based on the two points, recompute the equation of the line. Call the next <code>Update</code> method.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009814"></a>etc.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009816"></a></p>
</td>
</tr>
</tbody></table>
<a id="pgfId-1008599"></a><table class="webflareTable" id="#id1008566">
<caption style="text-align:left;"><p>
</p><div class="ft-figtabl-title">
<a id="pgfId-1008568"></a>Describe Methods </div></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1008572">
<a id="pgfId-1008572"></a>Class</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1008574">
<a id="pgfId-1008574"></a>Method description </span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008576"></a>GeometricObject</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008578"></a>Raise an error since there is no meaningful description at level.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008580"></a>Point</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008582"></a>Print a description of the point&#8217;s coordinates.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008584"></a>Line</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008586"></a>Print a description of the line&#8217;s equation.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008588"></a>IntersectionTwoLines_Point</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008590"></a>Call the next <code>Describe</code> method to display the coordinates. Then call <code>Describe</code> for each of the two lines that define this point.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008592"></a>TwoPoints_Line</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008594"></a>Call the next <code>Describe</code> method to display the equation. Then call <code>Describe</code> for each of the two point that define this line.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008596"></a>etc.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008598"></a></p>
</td>
</tr>
</tbody></table>
<a id="pgfId-1008633"></a> <table class="webflareTable" id="#id1008600">
<caption style="text-align:left;"><p>
</p><div class="ft-figtabl-title">
<a id="pgfId-1008602"></a>Validate Methods</div></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1008606">
<a id="pgfId-1008606"></a>Class</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1008608">
<a id="pgfId-1008608"></a>Method description</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008610"></a>GeometricObject</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008612"></a>Raise an error since there is no meaningful validation to perfom at this level of an object.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008614"></a>Point</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008616"></a>No method for this class</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008618"></a>Line</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008620"></a>No method for this class</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008622"></a>IntersectionTwoLines_Point</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008624"></a>Verify that the point&#8217;s coordinates satisfy the equations of the two lines.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008626"></a>TwoPoints_Line</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008628"></a>Verify that the two point&#8217;s coordinates satisfy the line&#8217;s equation.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008630"></a>etc.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1008632"></a></p>
</td>
</tr>
</tbody></table></li></ul>








<h4>
<a id="pgfId-1008667"></a>Connect Methods </h4>
<p>
<a id="pgfId-1009824"></a></p>
<table class="webflareTable" id="#id1009829">
<caption style="text-align:left;"><p>
</p><div class="ft-figtabl-title">
<a id="pgfId-1009831"></a>Connect generic Function</div></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1009835">
<a id="pgfId-1009835"></a>Class</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1009837">
<a id="pgfId-1009837"></a>Method description</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009839"></a>GeometricObject</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009841"></a>Add a dependent object to the list of dependent objects.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009843"></a>Point</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009845"></a>No method for this class.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009847"></a>Line</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009849"></a>No method for this class.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009851"></a>IntersectionTwoLines_Point</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009853"></a>No method for this class.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009855"></a>TwoPoints_Line</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009857"></a>No method for this class.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009859"></a>etc.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009861"></a></p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-1008668"></a>Source Code</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008669"></a>;;; toplevel( &#39;ils )<br />
defgeneric( Connect ( obj constraint )
&#160;&#160;  error( &quot;Connect is a subclass responsibility\n&quot; )<br />    ) ; defgeneric<br />
defgeneric( Update ( obj )
&#160;&#160;  error( &quot;Update is a subclass responsibility\n&quot; )<br />    ) ; defgeneric<br />
defgeneric( Validate ( obj )
&#160;&#160;  error( &quot;Validate is a subclass responsibility\n&quot; )<br />    ) ; defgeneric<br />
defgeneric( Describe ( obj )
&#160;&#160;  error( &quot;Describe is a subclass responsibility\n&quot; )<br />    ) ; defgeneric<br />
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013335"></a>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />;;;;; GeometricObject<br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;      <br />
defclass( GeometricObject
&#160;&#160;  ()<br />    (<br />        ( constraints <br />            @initform nil <br />            )<br />        )<br />    ) ; defclass<br />
defmethod( Connect (( obj GeometricObject ) constraint )
&#160;&#160;  when( !member( constraint obj-&gt;constraints )<br />        obj-&gt;constraints = cons( constraint obj-&gt;constraints )<br />        ) ; when<br />    ) ; defmethod <br />
defmethod( Update (( obj GeometricObject ))
&#160;&#160;  printf( &quot;Updating constraints %L for %L\n&quot; <br />        obj-&gt;constraints obj )<br />    Validate( obj )      <br />    foreach( constraint obj-&gt;constraints<br />        Update( constraint )<br />        ) ; foreach<br />    t<br />    ) ; defmethod<br />
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013338"></a>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />;;;;;;;;;;;;; Point<br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
defclass( Point ( GeometricObject )
&#160;&#160;  ( <br />        ( name @initarg name )<br />        ( x @initarg x );;; x-coordinate<br />        ( y @initarg y );;; y-coordinate<br />        )<br />    ) ; defclass<br />
defmethod( Describe (( obj Point ))
&#160;&#160;  printf( &quot;%s at %n:%n\n&quot; <br />        className( classOf( obj )) obj-&gt;x obj-&gt;y )<br />    ) ;defmethod <br />
defmethod( Validate ((obj Point))
&#160;&#160;  t<br />    )<br />
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1009171"></a>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />;;;;;;;;;;;;; IntersectionTwoLines_Point<br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />defclass( IntersectionTwoLines_Point ( Point )<br />    (<br />        ( L1 @initarg L1 )<br />        ( L2 @initarg L2 )<br />        )<br />    ) ; defclass<br />
defmethod( Describe (( obj IntersectionTwoLines_Point ))
&#160;&#160;  callNextMethod( obj );;; generic point description<br />    printf( &quot;&#8230;intersection of\n&quot;)<br />    Describe( obj-&gt;L1 )<br />    Describe( obj-&gt;L2 )<br />    ) ;defmethod<br />
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008672"></a>procedure( make_IntersectionTwoLines_Point( line1 line2 )<br />    let( ( point  )<br />        point = makeInstance( &#39;IntersectionTwoLines_Point <br />            ?L1 line1 <br />            ?L2 line2 <br />            )<br />        Update( point )<br />        Connect( line1 point )<br />        Connect( line2 point )<br />        point<br />        ) ; let<br />    ) ; procedure<br />
defmethod( Validate (( obj IntersectionTwoLines_Point ))
&#160;&#160;  let( ( A1 B1 C1 A2 B2 C2 x y )<br />        A1 = obj-&gt;L1-&gt;A<br />        B1 = obj-&gt;L1-&gt;B<br />        C1 = obj-&gt;L1-&gt;C<br />        A2 = obj-&gt;L2-&gt;A<br />        B2 = obj-&gt;L2-&gt;B<br />        C2 = obj-&gt;L2-&gt;C<br />        x = obj-&gt;x<br />        y = obj-&gt;y<br />        when( A1*x+B1*y+C1 != 0.0 || A2*x+B2*y+C2 != 0.0 <br />            error( &quot;Invalid IntersectionTwoLines_Point\n&quot; )<br />            ) ; when<br />        t<br />        ) ; let<br />    ) ; defmethod<br />
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008673"></a>defmethod( Update (( obj IntersectionTwoLines_Point ))<br />    ;; check to see if my two lines have values &#8230;<br />    printf( &quot;Figure out my x &amp; y from lines %L %L\n&quot; <br />          obj-&gt;L1 obj-&gt;L2 )<br />    let( ( A1 B1 C1 A2 B2 C2 det )<br />        A1 = obj-&gt;L1-&gt;A<br />        B1 = obj-&gt;L1-&gt;B<br />        C1 = obj-&gt;L1-&gt;C<br />        A2 = obj-&gt;L2-&gt;A<br />        B2 = obj-&gt;L2-&gt;B<br />        C2 = obj-&gt;L2-&gt;C<br />        det = A1*B2-A2*B1<br />        when( det == 0 <br />            error( &quot;Can not intersect two parallel lines\n&quot; )<br />            )<br />        obj-&gt;x = ((-C1)*B2-(-C2)*B1)*1.0/det<br />        obj-&gt;y = (A1*(-C2)-A2*(-C1))*1.0/det<br />        ) ; let<br />    callNextMethod( obj ) <br />    ) ; defmethod<br />
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1009172"></a>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />;;;;;;;;;;;;; Line<br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
defclass( Line ( GeometricObject )
&#160;&#160;  (             ;;;; Ax+By+C = 0<br />        ( A )      <br />        ( B )<br />        ( C )<br />        )<br />    ) ; defclass<br />
defmethod( Describe (( obj Line ))
&#160;&#160;  printf( &quot;%s %nx+%ny+%n=0\n&quot; <br />        className( classOf( obj ))<br />        obj-&gt;A obj-&gt;B obj-&gt;C<br />        )<br />    ) ; defmethod<br />
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008674"></a>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />;;;;;;;;;;;;; TwoPoints_Line<br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
defclass( TwoPoints_Line ( Line )
&#160;&#160;  (<br />        ( P1 @initarg P1 )<br />        ( P2 @initarg P2 )<br />        )<br />    ) ; defclass<br />
defmethod( Describe (( obj TwoPoints_Line ))
&#160;&#160;  callNextMethod( obj )<br />    printf( &quot;&#8230;containing\n&quot; )<br />    Describe( obj-&gt;P1 )<br />    Describe( obj-&gt;P2 )<br />    ) ; defmethod<br />
procedure( make_TwoPoints_Line( p1 p2 )
&#160;&#160;  let( ( line  )<br />        line = makeInstance( &#39;TwoPoints_Line <br />            ?P1 p1 ?P2 p2 )<br />        Update( line )<br />        Connect( p1 line )<br />        Connect( p2 line )<br />        line<br />        ) ; let<br />    ) ; procedure<br />
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008675"></a>defmethod( Validate (( obj TwoPoints_Line ))<br />    let( (x1 y1 x2 y2 A B C)<br />        x1  = obj-&gt;P1-&gt;x<br />        x2  = obj-&gt;P2-&gt;x<br />        y1  = obj-&gt;P1-&gt;y<br />        y2  = obj-&gt;P2-&gt;y<br />        A   = obj-&gt;A<br />        B  = obj-&gt;B<br />        C  = obj-&gt;C<br />        if( A*x1+B*y1+C != 0.0 then <br />            error( &quot;Invalid TwoPoints_Line\n&quot; ))<br />        if( A*x2+B*y2+C != 0.0 then <br />            error( &quot;Invalid TwoPoints_Line\n&quot; ))<br />        t<br />        ) ; let<br />    ) ; defmethod<br />
defmethod( Update (( obj TwoPoints_Line ))
&#160;&#160;  let( (x1 y1 x2 y2 m b)<br />        x1 = obj-&gt;P1-&gt;x<br />        x2 = obj-&gt;P2-&gt;x<br />        y1 = obj-&gt;P1-&gt;y<br />        y2 = obj-&gt;P2-&gt;y<br />        if( x2-x1 != 0<br />            then<br />                m = (y2-y1)*1.0/(x2-x1)<br />                b = y2-m*x2<br />                obj-&gt;A = -m<br />                obj-&gt;B = 1<br />                obj-&gt;C = -b<br />            else<br />                obj-&gt;A = 1.0<br />                obj-&gt;B = 0.0<br />                obj-&gt;C = -x1 <br />            ) ; if <br />        ) ; let<br />    callNextMethod( obj )<br />    ) ; defmethod<br />
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008676"></a>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />;;;;;;;;;;;;; ParallelLineThroughPoint_Line<br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008677"></a>defclass( ParallelLineThroughPoint_Line ( Line )<br />    (<br />        ( P @initarg P)<br />        ( L @initarg L)<br />        )<br />    ) ; defclass<br />
defmethod( Validate (( obj ParallelLineThroughPoint_Line ))
&#160;&#160;  let( (x1 y1 A B C LA LB LC)<br />        x1  = obj-&gt;P-&gt;x<br />        y1  = obj-&gt;P-&gt;y<br />        LA  = obj-&gt;L-&gt;A<br />        LB  = obj-&gt;L-&gt;B<br />        LC  = obj-&gt;L-&gt;C<br />        A   = obj-&gt;A<br />        B   = obj-&gt;B<br />        C   = obj-&gt;C<br />        when( A*LB-LA*B != 0.0 || A*x1+B*y1+C != 0 <br />            error( &quot;Invalid ParallelLineThroughPoint_Line\n&quot; ))<br />        t<br />        ) ; let<br />    ) ; defmethod<br />
defmethod( Describe (( obj ParallelLineThroughPoint_Line ))
&#160;&#160;  callNextMethod( obj )<br />    printf( &quot;&#8230;Containing\n&quot; )<br />    Describe( obj-&gt;P )<br />    printf( &quot;&#8230;Parallel to\n&quot; )<br />    Describe( obj-&gt;L )<br />    ) ; defmethod<br />
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008678"></a>procedure( make_ParallelLineThroughPoint_Line( point line )<br />    let( ( parallel_line  )<br />        parallel_line = makeInstance(<br />            &#39;ParallelLineThroughPoint_Line <br />            ?P point <br />            ?L line<br />            )<br />        Update( parallel_line )<br />        Connect( point parallel_line )<br />        Connect( line  parallel_line )<br />        parallel_line<br />        ) ; let<br />    ) ; procedure<br />
defmethod( Update (( obj ParallelLineThroughPoint_Line ))
&#160;&#160;  let( ( A B C x1 y1 )<br />        A   = obj-&gt;L-&gt;A<br />        B   = obj-&gt;L-&gt;B<br />        C   = obj-&gt;L-&gt;C<br />        x1  = obj-&gt;P-&gt;x<br />        y1  = obj-&gt;P-&gt;y<br />        obj-&gt;A = A<br />        obj-&gt;B = B<br />        obj-&gt;C = -(A*x1+B*y1)<br />        ) ; let<br />    callNextMethod( obj )<br />    ) ; defmethod</pre>
<h4>
<a id="pgfId-1008679"></a>Example 1 </h4>

<p>
<a id="pgfId-1008680"></a>This example</p>
<ul><li>
<a id="pgfId-1008681"></a>Creates a point P and describes it </li><li>
<a id="pgfId-1008682"></a>Creates another point R and describes it </li><li>
<a id="pgfId-1008683"></a>Constructs the line L that passes through the points P and R and describe it </li><li>
<a id="pgfId-1008684"></a>Changes the x coordinate of P to 1 and calls the <code>Update</code> function to propagate the changed coordinates of P <br />
<a id="pgfId-1008685"></a>In this version of the application, it is your responsibility to call the <code>Update</code> function after changing the coordinates of a free point. You should not use the <code>-&gt;</code> operator to change the coordinates of a non-free point.</li><li>
<a id="pgfId-1008686"></a>Describes the line L to verify that it has been updated <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008687">
<a id="pgfId-1008687"></a>P = makeInstance( &#39;Point ?x 0 ?y 4 )
stdobj:0x36f018

Describe( P )
Point at 0:4
t

R = makeInstance( &#39;Point ?x 3 ?y 0 )
stdobj:0x36f024

Describe( R )
Point at 3:0
t

L = make_TwoPoints_Line( P R )
Updating constraints nil for stdobj:0x36f030
stdobj:0x36f030</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008688">
<a id="pgfId-1008688"></a>Describe( L )
TwoPoints_Line 1.333333x+1y+-4.000000=0
&#8230;containing
Point at 0:4
Point at 3:0
t

P-&gt;x = 1
1

Update( P )
Updating constraints (stdobj:0x36f030) for stdobj:0x36f018
Updating constraints nil for stdobj:0x36f030
t

Describe( L )
TwoPoints_Line 2.000000x+1y+-6.000000=0
&#8230;containing
Point at 1:4
Point at 3:0
t</pre></li></ul>








<h4>
<a id="pgfId-1008689"></a>Example 2</h4>

<p>
<a id="pgfId-1008690"></a>This example</p>
<ul><li>
<a id="pgfId-1008691"></a>Creates four points P, Q, S, and R </li><li>
<a id="pgfId-1008692"></a>Constructs the line PQ that passes through the points P and Q </li><li>
<a id="pgfId-1008693"></a>Constructs the line SR that passes through the points S and R </li><li>
<a id="pgfId-1008694"></a>Constructs the point Z that is on both the lines PQ and SR and describes the point Z </li><li>
<a id="pgfId-1008695"></a>Changes the y coordinate of the point S to 4 and updates the point S </li><li>
<a id="pgfId-1008696"></a>Describes the point Z to verify that it has been updated <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008697">
<a id="pgfId-1008697"></a>P = makeInstance( &#39;Point ?x 0 ?y 4 )
stdobj:0x36f090

Q = makeInstance( &#39;Point ?x 0 ?y -4 )
stdobj:0x36f09c

S = makeInstance( &#39;Point ?x -3 ?y 0 )
stdobj:0x36f0a8

R = makeInstance( &#39;Point ?x 3 ?y 0 )
stdobj:0x36f0b4

PQ = make_TwoPoints_Line( P Q )
Updating constraints nil for stdobj:0x36f0c0
stdobj:0x36f0c0</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008698">
<a id="pgfId-1008698"></a>SR = make_TwoPoints_Line( S R )
Updating constraints nil for stdobj:0x36f0cc
stdobj:0x36f0cc</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008699">
<a id="pgfId-1008699"></a>Z = make_IntersectionTwoLines_Point( PQ SR )
Figure out my x &amp; y from lines stdobj:0x36f0c0 stdobj:0x36f0cc
Updating constraints nil for stdobj:0x36f0d8
stdobj:0x36f0d8</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008700">
<a id="pgfId-1008700"></a>Describe( Z )
IntersectionTwoLines_Point at 0.000000:0.000000
TwoPoints_Line 1.000000x+0.000000y+0=0
&#8230;containing
Point at 0:4
Point at 0:-4
TwoPoints_Line -0.000000x+1y+-0.000000=0
&#8230;containing
Point at -3:0
Point at 3:0
t</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008701">
<a id="pgfId-1008701"></a>S-&gt;y = 4
4</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008702">
<a id="pgfId-1008702"></a>Update( S)
Updating constraints (stdobj:0x36f0cc) for stdobj:0x36f0a8
Updating constraints (stdobj:0x36f0d8) for stdobj:0x36f0cc
Figure out my x &amp; y from lines stdobj:0x36f0c0 stdobj:0x36f0cc
Updating constraints nil for stdobj:0x36f0d8
t

Describe( Z )
IntersectionTwoLines_Point at 0.000000:2.000000
TwoPoints_Line 1.000000x+0.000000y+0=0
&#8230;containing
Point at 0:4
Point at 0:-4
TwoPoints_Line 0.666667x+1y+-2.000000=0
&#8230;containing
Point at -3:4
Point at 3:0
t</pre></li></ul>












<h3>
<a id="pgfId-1008703"></a>Extending the Implementation </h3>

<p>
<a id="pgfId-1008704"></a>Consider the following extensions: </p>
<ul><li>
<a id="pgfId-1008705"></a>Protecting the implementation from inconsistent access <br />
<a id="pgfId-1008706"></a>You can use the <code>-&gt;</code> operator to change coordinates of any point, even a constrained point. You can extend the implementation to allow the user to change only coordinates of free points.</li><li>
<a id="pgfId-1008707"></a>Adding graphics <br />
<a id="pgfId-1008708"></a>You can extend the implementation to associate a database object with each point or line and update the database object at appropriate times. You should have to affect only the <code>Point</code> and <code>Line</code> classes.</li></ul>




<h2>
<a id="pgfId-1015352"></a><a id="23809"></a>Examples of How to use Custom Specializers in SKILL++ Methods</h2>

<p>
<a id="pgfId-1015360"></a>An example of using SKILL++ custom specializers to allow defining a method specialized on the database object type. Standard SKILL++ methods are specialized on the class of an object passed to the generic function, but this allows extending it to further divide based on some attribute of a non-SKILL++ object.</p>
<p>
<a id="pgfId-1015366"></a>This example implements <code>abFigArea(obj)</code> that calculates the area of various types of database object, You can see the individual methods further down the code. It implements calculations for most (not guaranteed to be complete) figure object types in Virtuoso. It also includes <code>abFigPerimeter(obj)</code> to show an example of a second generic function using the same specializers.</p>
<p>
<a id="pgfId-1015374"></a>To call:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015376"></a>abFigArea(dbId) =&gt; area (in micron^2)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015377"></a>abFigPerimeter(dbId) =&gt; length of perimeter (in microns)</pre>

<p>
<a id="pgfId-1015379"></a>Limitations: does not currently compute the perimeter of an arc (It is difficult to compute the length for elliptic arcs).</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015382"></a>***************************************************</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015384"></a>SCCS Info: @(#) abAreaMethod.ils 12/17/20.11:01:03 1.2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015386"></a>*/</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015388"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015389"></a>; First define a class to store the information needed to match an</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015390"></a>; object against the custom specializer</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015391"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015392"></a>defclass(abDbFigSpecializer ()</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015393"></a>    (</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015394"></a>        (objType @initarg objType)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015395"></a>    )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015396"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015398"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015399"></a>; This method is called when a defmethod using a custom specializer</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015400"></a>; is used. This uses an eqv specializer, so if the defmethod is</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015401"></a>; of this form: defmethod(methodName ((obj (abDbFig &quot;ellipse&quot;))) ...)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015402"></a>; then it will create an instance of the specializer class to</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015403"></a>; store the database objType in.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015404"></a>; ilGenerateSpecializer is passed the generic function object, the symbol</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015405"></a>; which is the first term of the specializer in the defmethod, and then</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015406"></a>; a list of the arguments (all literal; no evaluation is performed)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015407"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015408"></a>defmethod(ilGenerateSpecializer (_gf (_spec (eqv &#39;abDbFig)) args)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015409"></a>    makeInstance(&#39;abDbFigSpecializer ?objType car(args))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015410"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015412"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015413"></a>; This method is used when the generic function is called. It</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015414"></a>; tries against each specializer object that there is a method</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015415"></a>; defined for, and this method determines whether the specializer</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015416"></a>; matches the objType of the database object passed in.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015417"></a>; The method is passed the generic function object, the object for the</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015418"></a>; specializer being checked against, and the actual object for the argument</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015419"></a>; to the method.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015420"></a>; Note that the method should check that the argument is the expected</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015421"></a>; object type as well as checking the values match - this avoids situations</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015422"></a>; where retrieving (in this case) -&gt;objType fails because the object has no</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015423"></a>; slot objType.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015424"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015425"></a>defmethod(ilArgMatchesSpecializer (_gf (spec abDbFigSpecializer) (arg dbobject))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015426"></a>    spec-&gt;objType==arg-&gt;objType</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015427"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015429"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015430"></a>; Must define a method to check whether two specializer objects are </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015431"></a>; equivalent. Failure to do this will lead to errors if you redefine</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015432"></a>; methods using the custom specializer</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015433"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015434"></a>defmethod(ilEquivalentSpecializers (_gf (spec1 abDbFigSpecializer)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015435"></a>        (spec2 abDbFigSpecializer))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015436"></a>    spec1-&gt;objType==spec2-&gt;objType</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015437"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015439"></a>/**************************************************************************</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015440"></a>*&#160;&#160;                                                                       *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015441"></a>*&#160;&#160;                          abAreaOfBBox(bBox)                           *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015442"></a>*&#160;&#160;                                                                       *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015443"></a>*&#160;&#160;     A utility function to calculate the area of a bBox. Several       *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015444"></a>* objects are rectangular, so having a common function makes this simpler *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015445"></a>*&#160;&#160;                                                                       *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015446"></a>**************************************************************************/</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015447"></a>defun(abAreaOfBBox (bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015448"></a>    destructuringBind(((llx lly) (urx ury)) bBox</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015449"></a>        (urx-llx)*(ury-lly)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015450"></a>    )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015451"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015453"></a>/***************************************************************</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015454"></a>*&#160;&#160;                                                            *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015455"></a>*&#160;&#160;                abAreaOfPolygon(pointList)                  *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015456"></a>*&#160;&#160;                                                            *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015457"></a>*&#160;&#160;  A utility function to calulate the area of a polygon.     *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015458"></a>*&#160;&#160;        Effectively integrates around the polygon.          *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015459"></a>*&#160;&#160;                                                            *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015460"></a>***************************************************************/</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015461"></a>defun(abAreaOfPolygon (pointList)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015462"></a>    let(((sum 0) firstPt lastPt dx)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015463"></a>        firstPt=lastPt=car(pointList)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015464"></a>        foreach(point cdr(pointList)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015465"></a>             dx=xCoord(point)-xCoord(lastPt)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015466"></a>             sum=sum+dx*(yCoord(point)+yCoord(lastPt))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015467"></a>             lastPt=point</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015468"></a>        )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015469"></a>        sum=sum+((xCoord(firstPt)-xCoord(lastPt))*</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015470"></a>                (yCoord(firstPt)+yCoord(lastPt)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015471"></a>        0.5*abs(sum)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015472"></a>    )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015473"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015475"></a>/***************************************************************</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015476"></a>*&#160;&#160;                                                            *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015477"></a>*&#160;&#160;                 abPerimeterOfBBox(bBox)                    *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015478"></a>*&#160;&#160;                                                            *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015479"></a>*&#160;&#160; A utility function to calculate the perimeter of a bBox&#160;&#160;  *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015480"></a>*&#160;&#160;                                                            *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015481"></a>***************************************************************/</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015482"></a>defun(abPerimeterOfBBox (bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015483"></a>    destructuringBind(((llx lly) (urx ury)) bBox</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015484"></a>        2*(urx-llx+ury-lly)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015485"></a>    )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015486"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015488"></a>/************************************************************************</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015489"></a>*&#160;&#160;                                                                     *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015490"></a>*&#160;&#160;       abPerimeterOfPolygon(pointList @optional (closed t))          *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015491"></a>*&#160;&#160;                                                                     *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015492"></a>*&#160;&#160; Utility function to compute the perimeter of a polygon pointList.&#160;&#160; *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015493"></a>*&#160;&#160;  By default this is a closed polygon, but if the second argument    *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015494"></a>* is passed as nil, will find the length of a line with that pointList. *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015495"></a>*&#160;&#160;                                                                     *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015496"></a>************************************************************************/</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015497"></a>defun(abPerimeterOfPolygon (pointList @optional (closed t))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015498"></a>    let(((sum 0) firstPt lastPt)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015499"></a>        firstPt=lastPt=car(pointList)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015500"></a>        foreach(point cdr(pointList)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015501"></a>            sum=sum+sqrt(</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015502"></a>                (xCoord(lastPt)-xCoord(point))**2 +</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015503"></a>                (yCoord(lastPt)-yCoord(point))**2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015504"></a>            )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015505"></a>            lastPt=point</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015506"></a>        )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015507"></a>        when(closed</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015508"></a>            sum=sum+sqrt(</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015509"></a>                (xCoord(lastPt)-xCoord(firstPt))**2 +</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015510"></a>                (yCoord(lastPt)-yCoord(firstPt))**2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015511"></a>            )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015512"></a>        )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015513"></a>        sum</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015514"></a>    )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015515"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015517"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015518"></a>; Some of the methods need PI, so this associates the math</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015519"></a>; constants with the abFigMaths symbol (so can use abFigMaths.PI</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015520"></a>; for example)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015521"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015522"></a>defMathConstants(&#39;abFigMaths)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015524"></a>/************************************************************************</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015525"></a>*&#160;&#160;                                                                     *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015526"></a>*&#160;&#160;                          abFigArea(obj)                             *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015527"></a>*&#160;&#160;                                                                     *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015528"></a>*&#160;&#160; The generic function - pass in a database object and compute the&#160;&#160;  *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015529"></a>* area. The generic function handles anything that isn&#39;t recognised and *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015530"></a>*&#160;&#160;           tries to give a vaguely useful error message              *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015531"></a>*&#160;&#160;                                                                     *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015532"></a>************************************************************************/</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015533"></a>defgeneric(abFigArea (obj)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015534"></a>    let((objType)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015535"></a>        objType=</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015536"></a>            if(dbIsId(obj) then</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015537"></a>                strcat(type(obj) &quot; - &quot; obj~&gt;objType)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015538"></a>            else</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015539"></a>                type(obj)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015540"></a>            )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015541"></a>        error(&quot;abFigArea: unrecognized object %L (%s)\n&quot; obj objType)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015542"></a>    )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015543"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015545"></a>/*********************************************************************</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015546"></a>*&#160;&#160;                                                                  *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015547"></a>*&#160;&#160;                       abFigPerimeter(obj)                        *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015548"></a>*&#160;&#160;                                                                  *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015549"></a>* The generic function for perimeter - pass in a database object and *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015550"></a>*&#160;&#160;compute the length of the perimeter. The generic function simply&#160;&#160;*</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015551"></a>*&#160;&#160;     errors gracefully when passed an unrecognised object.        *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015552"></a>*&#160;&#160;                                                                  *</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015553"></a>*********************************************************************/</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015554"></a>defgeneric(abFigPerimeter (obj)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015555"></a>    let((objType)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015556"></a>        objType=</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015557"></a>            if(dbIsId(obj) then</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015558"></a>                strcat(type(obj) &quot; - &quot; obj~&gt;objType)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015559"></a>            else</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015560"></a>                type(obj)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015561"></a>            )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015562"></a>        error(&quot;abFigPerimeter: unrecognized object %L (%s)\n&quot; obj objType)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015563"></a>    )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015564"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015566"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015567"></a>; Now all the methods specialized on each objType.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015568"></a>; First, the abFigArea methods</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015569"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015571"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015572"></a>; Just use the bBox of these objects to compute the area</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015573"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015575"></a>defmethod(abFigArea ((obj (abDbFig &quot;rect&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015576"></a>    abAreaOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015577"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015579"></a>defmethod(abFigArea ((obj (abDbFig &quot;inst&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015580"></a>    abAreaOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015581"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015583"></a>defmethod(abFigArea ((obj (abDbFig &quot;mosaic&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015584"></a>    abAreaOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015585"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015587"></a>defmethod(abFigArea ((obj (abDbFig &quot;figGroup&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015588"></a>    abAreaOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015589"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015591"></a>defmethod(abFigArea ((obj (abDbFig &quot;stdVia&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015592"></a>    abAreaOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015593"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015595"></a>defmethod(abFigArea ((obj (abDbFig &quot;customVia&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015596"></a>    abAreaOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015597"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015599"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015600"></a>; Polygons, boundaries, blockages and halos have a point list</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015601"></a>; that we can compute the area from</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015602"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015603"></a>defmethod(abFigArea ((obj (abDbFig &quot;polygon&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015604"></a>    abAreaOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015605"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015608"></a>defmethod(abFigArea ((obj (abDbFig &quot;areaBlockage&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015609"></a>    abAreaOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015610"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015612"></a>defmethod(abFigArea ((obj (abDbFig &quot;layerBlockage&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015613"></a>    abAreaOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015614"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015616"></a>defmethod(abFigArea ((obj (abDbFig &quot;PRBoundary&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015617"></a>    abAreaOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015618"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015620"></a>defmethod(abFigArea ((obj (abDbFig &quot;areaBoundary&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015621"></a>    abAreaOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015622"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015624"></a>defmethod(abFigArea ((obj (abDbFig &quot;snapBoundary&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015625"></a>    abAreaOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015626"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015628"></a>defmethod(abFigArea ((obj (abDbFig &quot;clusterBoundary&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015629"></a>    abAreaOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015630"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015632"></a>defmethod(abFigArea ((obj (abDbFig &quot;areaHalo&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015633"></a>    abAreaOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015634"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015636"></a>defmethod(abFigArea ((obj (abDbFig &quot;layerHalo&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015637"></a>    abAreaOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015638"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015640"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015641"></a>; Few individual objects which are more interesting</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015642"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015643"></a>defmethod(abFigArea ((obj (abDbFig &quot;donut&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015644"></a>    let((inner outer)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015645"></a>        outer=abFigMaths.PI*obj~&gt;outerRadius**2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015646"></a>        inner=abFigMaths.PI*obj~&gt;innerRadius**2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015647"></a>        outer-inner</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015648"></a>    )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015649"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015651"></a>defmethod(abFigArea ((obj (abDbFig &quot;ellipse&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015652"></a>    ; pi*a*b where a and b are the radii of the ellipse</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015653"></a>    destructuringBind(((llx lly) (urx ury)) obj~&gt;bBox</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015654"></a>        abFigMaths.PI*(urx-llx)*(ury-lly)/4.0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015655"></a>    )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015656"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015658"></a>defmethod(abFigArea ((obj (abDbFig &quot;path&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015659"></a>    abAreaOfPolygon(dbGetPathBoundary(obj))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015660"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015662"></a>defmethod(abFigArea ((obj (abDbFig &quot;pathSeg&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015663"></a>    abAreaOfPolygon(obj~&gt;boundary)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015664"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015666"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015667"></a>; Finally a bunch of objects with no area</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015668"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015669"></a>defmethod(abFigArea ((_obj (abDbFig &quot;line&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015670"></a>    0.0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015671"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015673"></a>defmethod(abFigArea ((_obj (abDbFig &quot;dot&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015674"></a>    0.0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015675"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015678"></a>defmethod(abFigArea ((_obj (abDbFig &quot;arc&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015679"></a>    0.0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015680"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015682"></a>defmethod(abFigArea ((_obj (abDbFig &quot;ruler&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015683"></a>    0.0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015684"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015686"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015687"></a>; could use the bBox, but area doesn&#39;t really make sense for labels</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015688"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015689"></a>defmethod(abFigArea ((_obj (abDbFig &quot;label&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015690"></a>    0.0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015691"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015693"></a>defmethod(abFigArea ((_obj (abDbFig &quot;textDisplay&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015694"></a>    0.0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015695"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015697"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015698"></a>; Now the abFigPerimeter methods</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015699"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015701"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015702"></a>; Just use the bBox of these objects to compute the perimeter</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015703"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015704"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;rect&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015705"></a>    abPerimeterOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015706"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015708"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;inst&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015709"></a>    abPerimeterOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015710"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015712"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;mosaic&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015713"></a>    abPerimeterOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015714"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015716"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;figGroup&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015717"></a>    abPerimeterOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015718"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015720"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;stdVia&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015721"></a>    abPerimeterOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015722"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015724"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;customVia&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015725"></a>    abPerimeterOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015726"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015728"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015729"></a>; Polygons, boundaries, blockages and halos have a point list</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015730"></a>; that we can compute the perimeter from</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015731"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015732"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;polygon&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015733"></a>    abPerimeterOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015734"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015736"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;areaBlockage&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015737"></a>    abPerimeterOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015738"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015740"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;layerBlockage&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015741"></a>    abPerimeterOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015742"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015744"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;PRBoundary&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015745"></a>    abPerimeterOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015746"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015748"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;areaBoundary&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015749"></a>    abPerimeterOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015750"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015752"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;snapBoundary&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015753"></a>    abPerimeterOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015754"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015756"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;clusterBoundary&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015757"></a>    abPerimeterOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015758"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015760"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;areaHalo&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015761"></a>    abPerimeterOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015762"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015764"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;layerHalo&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015765"></a>    abPerimeterOfPolygon(obj~&gt;points)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015766"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015768"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015769"></a>; Few individual objects which are more interesting</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015770"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015771"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;donut&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015772"></a>    let((inner outer)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015773"></a>        outer=2*abFigMaths.PI*obj~&gt;outerRadius</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015774"></a>        inner=2*abFigMaths.PI*obj~&gt;innerRadius</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015775"></a>        outer+inner</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015776"></a>    )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015777"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015779"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;ellipse&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015780"></a>    ;--------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015781"></a>    ; there is no exact formula for the perimeter of an ellipse</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015782"></a>    ; so instead use Ramanujan&#39;s approximation</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015783"></a>    ;--------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015784"></a>    destructuringBind(((llx lly) (urx ury)) obj~&gt;bBox</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015785"></a>        let(((a (urx-llx)/2.0) (b (ury-lly)/2.0) h)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015786"></a>            h=(a-b)**2/(a+b)**2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015787"></a>            abFigMaths.PI*(a+b)*(1+3*h/(10+sqrt(4-3*h)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015788"></a>        )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015789"></a>    )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015790"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015792"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;path&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015793"></a>    abPerimeterOfPolygon(dbGetPathBoundary(obj))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015794"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015796"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;pathSeg&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015797"></a>    abPerimeterOfPolygon(obj~&gt;boundary)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015798"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015800"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015801"></a>; Lines and rulers - the perimeter is just one side</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015802"></a>; I guess it could be double this, maybe?</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015803"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015804"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;line&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015805"></a>    abPerimeterOfPolygon(obj~&gt;points nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015806"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015808"></a>defmethod(abFigPerimeter ((obj (abDbFig &quot;ruler&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015809"></a>    abPerimeterOfPolygon(obj~&gt;points nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015810"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015812"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015813"></a>; This is left to an exercise for the reader (mainly because it is</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015814"></a>; pretty difficult - there is no exact formula for this)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015815"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015816"></a>defmethod(abFigPerimeter ((_obj (abDbFig &quot;arc&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015817"></a>    0.0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015818"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015820"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015821"></a>; Finally a bunch of objects with no perimeter</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015822"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015824"></a>defmethod(abFigPerimeter ((_obj (abDbFig &quot;dot&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015825"></a>    0.0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015826"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015828"></a>defmethod(abFigPerimeter ((_obj (abDbFig &quot;label&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015829"></a>    0.0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015830"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015832"></a>defmethod(abFigPerimeter ((_obj (abDbFig &quot;textDisplay&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015833"></a>    0.0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015834"></a>)</pre>
<h3>
<a id="pgfId-1015835"></a>Simple Code Example Using a Generic Function Proxy</h3>

<p>
<a id="pgfId-1015836"></a>This example (not as complete as the <code>abFigArea</code>/<code>abFigPerimeter</code> example) uses a different strategy of defining a proxy for the <code>ilGenericFunction</code> and using that to specialize the custom specializer methods. This proxy class must be specified via the <code>?genericFunctionClass</code> argument to <code>defgeneric</code> when defining a generic function. The disadvantage of this approach is that it could disguise how the method are actually being specialized - in this case just a string representing the <code>objType</code> is used to distinguish each method, and that may not be as clear that something special is happening. Therefore, it is probably best to use the approach above (if using custom specializers at all).</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015838"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015839"></a>; define a proxy for the generic function object</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015840"></a>; Any generic functions defined using this will then trigger the</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015841"></a>; right custom specializer methods</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015842"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015843"></a>defclass(CCSproxyGF (ilGenericFunction)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015844"></a>  ()</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015845"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015847"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015848"></a>; A class to hold the specializer details</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015849"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015850"></a>defclass(CCSdbobjectSpecializer ()</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015851"></a>  (</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015852"></a>    (objType @initarg objType)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015853"></a>  )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015854"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015856"></a>defmethod(ilGenerateSpecializer ((gf CCSproxyGF) spec _args)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015857"></a>  ;----------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015858"></a>  ; Don&#39;t need any arguments - just use the specializer (which can</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015859"></a>  ; be a string or a symbol)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015860"></a>  ;----------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015861"></a>  makeInstance(&#39;CCSdbobjectSpecializer ?objType get_string(spec))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015862"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015864"></a>defmethod(ilEquivalentSpecializers ((gf CCSproxyGF) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015865"></a>    (spec1 CCSdbobjectSpecializer) (spec2 CCSdbobjectSpecializer))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015866"></a>  spec1-&gt;objType==spec2-&gt;objType</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015867"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015869"></a>defmethod(ilArgMatchesSpecializer ((gf CCSproxyGF) (spec CCSdbobjectSpecializer)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015870"></a>    (arg dbobject))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015871"></a>  spec-&gt;objType==arg-&gt;objType</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015872"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015874"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015875"></a>; Note that the generic function is defined indicating that it uses a</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015876"></a>; different class other than ilGenericFunction. This means that the</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015877"></a>; custom specializer methods above will be used</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015878"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015879"></a>defgeneric(CCSgetFullObjType (obj) ?genericFunctionClass CCSproxyGF</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015880"></a>  when(dbobjectp(obj)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015881"></a>    obj-&gt;objType</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015882"></a>  )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015883"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015885"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015886"></a>; Methods using this approach. Note that this is not terribly transparent</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015887"></a>; that they are dealing with database objects</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015888"></a>;------------------------------------------------------------------------</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015889"></a>defmethod(CCSgetFullObjType ((obj (&quot;rect&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015890"></a>  &quot;rectangle&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015891"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015893"></a>defmethod(CCSgetFullObjType ((obj (&quot;inst&quot;)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015894"></a>  &quot;instance&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008201"></a>)</pre>
<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="chap16.html" id="prev" title="SKILL++ Object System">SKILL++ Object System</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;⠀ </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>