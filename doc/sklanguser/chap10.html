
<html><head><title>Delivering Products</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="parula" />
<meta name="CreateDate" content="2023-08-23" />
<meta name="CreateTime" content="1692797215" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the SKILL language to new users and helps them understand advanced topics, encourages sound SKILL programming methods, and introduces the SKILL++ language" />
<meta name="DocTitle" content="Cadence SKILL Language User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Delivering Products" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="sklanguser" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-08-23" />
<meta name="ModifiedTime" content="1692797215" />
<meta name="NextFile" content="chap11.html" />
<meta name="Group" content="SKILL Language" />
<meta name="Platform" content="Cadence Shared Tools" />
<meta name="PrevFile" content="chap9.html" />
<meta name="c_product" content="Virtuoso Layout Suite,Virtuoso Schematic Editor,Virtuoso Analog Design Environment" />
<meta name="Product" content="SKILL" />
<meta name="ProductFamily" content="SKILL" />
<meta name="ProductVersion" content="IC23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Cadence SKILL Language User Guide -- Delivering Products" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="IC23.1" />
<meta name="SpaceKey" content="sklanguserIC231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="sklanguserTOC.html">Contents</a></li><li><a class="prev" href="chap9.html" title="Advanced Topics">Advanced Topics</a></li><li style="float: right;"><a class="viewPrint" href="sklanguser.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="chap11.html" title="Writing Style">Writing Style</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Cadence SKILL Language User Guide<br />Product Version IC23.1, September 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>10
<a id="pgfId-1005655"></a></h1>
<h1>
<a id="pgfId-1008199"></a><hr />
<a id="26277"></a>Delivering Products<hr />
</h1>

<p>
<a id="pgfId-1008754"></a>Overview information:</p>
<ul><li>
<a id="pgfId-1008762"></a><a href="chap10.html#29710">Contexts</a>  </li><li>
<a id="pgfId-1008784"></a><a href="chap10.html#26859">Autoloading Your Functions</a>  </li><li>
<a id="pgfId-1008786"></a><a href="chap10.html#15160">Encrypting and Compressing Files</a>  </li><li>
<a id="pgfId-1008788"></a><a href="chap10.html#92795">Protecting Functions and Variables</a>  </li></ul>




<h2>
<a id="pgfId-1008203"></a><a id="29710"></a>Contexts</h2>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1008204"></a>This information is for users who are writing a large volume of code using the Cadence&#174; SKILL language code and are interested in modularizing the code and possibly autoloading it at run time.</div>
<p>
<a id="pgfId-1008207"></a>C<a id="marker-1008206"></a>ontexts are binary representations of the internal state of the interpreter. Their primary purpose is to help speed the loading of SKILL files. They are best used when the set of SKILL files to load is large. </p>

<div class="webflare-information-macro webflare-macro-warning">
<a id="pgfId-1008208"></a>
A SKILL Development license is required to build contexts using the <a id="marker-1008209"></a>saveContext command.</div>

<p>
<a id="pgfId-1008210"></a>All SKILL-related structures can be saved in a context except those with values meaningless outside of a session. For example, port values, database handles, and window types are meaningful only to current sessions, whereas lists, integers, floats, defstructs, and so forth are transportable from one session to another.</p>
<p>
<a id="pgfId-1008212"></a>SKILL contexts contain source code and data. Their main purpose is to allow for fast loading and initializing of product code. One way of looking at contexts is to view them as snapshots of the internal state of the interpreter, much like a core file in UNIX is an image of the running process. </p>
<p>
<a id="pgfId-1008215"></a><a id="marker-1008214"></a>Contexts cannot store at save time and retrieve at load time process-dependent structures. For example, file descriptors stored in port structures or process IDs cannot be saved in contexts. All other non process-dependent SKILL structures can be safely stored: Lists, numbers, strings, arrays, and so forth can be saved into and retrieved from a context.</p>
<p>
<a id="pgfId-1010922"></a>When a SKILL <a id="marker-1010921"></a>source file is loaded, it is first parsed. The evaluator is called for each complete expression read in. This is how procedures are defined. Context files, on the other hand, contain binary data that is loaded directly into memory. The binary data stored into a context has been parsed and evaluated before being saved. </p>

<p>
<a id="pgfId-1010942"></a></p>
<div class="webflare-div-image">
<img width="484" height="352" src="images/chap10-3.gif" /></div>
<h3>
<a id="pgfId-1010943"></a>Deciding When to Use Contexts</h3>

<p>
<a id="pgfId-1008240"></a>You must decide when it is better to use <a id="marker-1008239"></a>contexts versus straight or encrypted SKILL code. Some considerations include the following:</p>
<ul><li>
<a id="pgfId-1008243"></a>Is the code likely to become a product?<br />
<a id="pgfId-1008244"></a>Usually, the first criterion is whether the code is likely to become a product that will be shipped. Contexts offer a good vehicle for productizing code. </li><li>
<a id="pgfId-1008245"></a>How long does the code take to load?<br />
<a id="pgfId-1008246"></a>The second criteria is whether there is enough SKILL code to warrant being in a context. This is difficult to measure. A simple test is to load the source code and see if the time it takes is likely to be unacceptable to a user. For example, if the code is likely to be auto-loaded during the physical manipulation of graphics, the impact of the load and initialization should be minimized. Contexts can help in this case.<br />
<a id="pgfId-1008247"></a>The more code and initialization needed at load time, the better it is to use contexts. For small amounts of code (200 lines), contexts might be overkill. To load and initialize 20,000 lines of SKILL code without using contexts takes approximately 30 seconds, whereas loading the same code using a context takes approximately 4 seconds. In this case, the perceptible impact is high, so using contexts makes sense.</li><li>
<a id="pgfId-1008248"></a>Do you need to modularize your code?<br />
<a id="pgfId-1008249"></a>Sometimes it is necessary to modularize code according to predefined capabilities. There might be a need to have these capabilities loaded incrementally at run-time. Thus it is not necessary to load all the code at once. Contexts, as snapshots of the interpreter&#8217;s internal state, can be saved into separate files, even though code that goes into one context might depend on code in another. <br />
<a id="pgfId-1008250"></a>The dependencies are resolved at load time. For example, the SKILL code for the schematics editor relies, among other things, on having code for the graphics editor present, but the context for the schematics editor does not contain any of the graphic editor&#8217;s code or structures.</li><li>
<a id="pgfId-1008251"></a>Can you create contexts at integration time?<br />
<a id="pgfId-1008252"></a>The process of creating contexts must always be a separate step done at integration time, the time when all C code is compiled and linked and SKILL files are digested to produce context files. During integration and when contexts are being created, the interpreter enters a state that renders all normal use inefficient. <br />
<a id="pgfId-1008253"></a>For example, during context creation, the memory management subsystem works in a special mode such that incremental snapshots of the memory can be made and saved into contexts. Context creation and code that is used to create contexts should not be part of the normal function of any product. </li></ul>











<h3>
<a id="pgfId-1008254"></a>Creating Contexts</h3>

<p>
<a id="pgfId-1008256"></a>When you use SKILL <a id="marker-1008255"></a>contexts for delivering a product, you must develop an organization for those contexts. </p>

<h4>
<a id="pgfId-1008257"></a>Creating the Directory Structure</h4>

<p>
<a id="pgfId-1008258"></a>First, group the SKILL code on a product/capability basis. This is best done by designating a special directory, for example, <code>source/context</code> and then using make files or simple scripts to copy the code into separate directories under <code>source/context</code>. </p>
<p>
<a id="pgfId-1008259"></a>If the capability names are <code>cap1</code> and <code>cap2, </code>create two directories under <code>source/context</code> named <code>source/context/cap1</code> and <code>source/context/cap2</code>. Copy the source code for each capability into the respective directory. </p>
<p>
<a id="pgfId-1008260"></a>For each capability context directory, create a single file named <code>startup.il </code>that uses the SKILL <code>load</code> command to load all the files in that directory in the necessary order. The figure below shows a layout of the context directories. To evaluate a command at the top level, use the <code>loadTopContextForm</code> command instead of <code>load</code>.</p>

<p>
<a id="pgfId-1009216"></a></p>
<div class="webflare-div-image">
<img width="655" height="299" src="images/chap10-4.gif" /></div>
<div class="webflare-information-macro webflare-macro-warning">
<a id="pgfId-1008305"></a>
The first 12 characters in a context file name must be unique.</div>
<h4>
<a id="pgfId-1008306"></a>How the Process of Building Contexts Works</h4>

<p>
<a id="pgfId-1008307"></a>Using the directory structure described above, the process of building <a id="marker-1008308"></a>contexts starts by loading code from each directory and generating a binary context corresponding to the state of the interpreter when the files are loaded (in the sequence specified in the <code>startup.il</code> file). </p>
<p>
<a id="pgfId-1009910"></a>The binary context file can go into one of several directories. If auto-loading of the context is necessary, the file can be placed in the <code>/</code><span class="webflare-courier-new" style="white-space:pre"><em>your_install_dir</em></span><code>/tools/dfII/local/context</code> directory. The autoload mechanism looks in this directory. </p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1013495"></a>64 bit SKILL-based programs (such as <code>virtuoso</code>) require 64 bit context files, which should inturn be created using 64 bit SKILL-based programs. In addition, these 64 bit context files should be placed under the <span class="webflare-courier-new" style="white-space:pre"><em>/64bit</em></span> directory. For example, <span class="webflare-courier-new" style="white-space:pre"><em>/your_install_dir/tools/dfII/local/context/64bit</em></span>.</div>

<h3>
<a id="pgfId-1008310"></a>Creating Utility Functions</h3>

<p>
<a id="pgfId-1008312"></a>Given the directory structure above, the code for generating the <a id="marker-1008311"></a>contexts can now be written. First let us define a few utility functions.</p>

<h4>
<a id="pgfId-1008313"></a>Assumptions</h4>

<p>
<a id="pgfId-1008314"></a>Source code is stored under the <code>/</code><span class="webflare-courier-new" style="white-space:pre"><em>user</em></span><code>/source/context</code> directory. The created contexts are saved under <code>/</code><span class="webflare-courier-new" style="white-space:pre"><em>user</em></span><code>/etc/context</code>, where <code>user</code> is any installation path you choose for keeping sources and contexts. These contexts are hard-coded in the sample code below, but you can pass them as arguments to the functions.</p>

<h4>
<a id="pgfId-1008315"></a>Create <code>myContextBuild.il</code></h4>

<p>
<a id="pgfId-1008316"></a>Put the following code in a separate file. Call it <code>myContextBuild.il.</code></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008317"></a>procedure( getContext(cxt)<br />;;------------------------<br />;; Given a context name load the context into the session </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008318"></a>(let ((ff (strcat &quot;/&lt;user&gt;/etc/context/&quot; cxt &quot;.cxt&quot;)))<br />      (cond ((null (isFile ff)) nil)<br />            ((null (loadContext ff))  <br />                  (printf &quot;Failed to load context %s\n&quot; cxt))<br />            ((null (callInitProc cxt)) <br />                  (printf &quot;Failed to initialize context %s\n&quot;<br />                        cxt))<br />                  (t (printf &quot;Loading Context %s\n&quot; cxt))<br />      )<br />      )<br />)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1009711"></a>procedure( makeContext(cxt)<br />;;-------------------------<br />;; Given a context name create and save the context<br />;; under &quot;/&lt;user&gt;/etc/context&quot;. Assumes user source <br />;; code is located under /&lt;user&gt;/source/&lt;context&gt;<br />
(let ( (newPath (strcat &quot;/&lt;user&gt;/source/&quot; cxt))
&#160;&#160;    (oldPath (getSkillPath))<br />             (fileName (strcat &quot;/&lt;user&gt;/etc/context/&quot; cxt &quot;.cxt&quot;))<br />             (oldStatus (status writeProtect))<br />            )<br />
&#160;&#160;          (printf &quot;Building context for %s\n&quot; cxt)<br />      (setSkillPath newPath)<br />            (sstatus writeProtect t)<br />      ;; setContext is a function that takes the name of <br />      ;; a context and indicates to the system that <br />      ;; whatever is loaded or evaluated from  <br />      ;; the point of this call to the time context <br />      ;; is saved belongs to the named context.<br />
&#160;&#160;    (setContext cxt)<br />
&#160;&#160;    ;; Load all the SKILL files corresponding to the<br />      ;; given context. Relies on skill path being set earlier<br />
&#160;&#160;    (loadi &quot;startup.il&quot;)<br />
&#160;&#160;    ;; After the load save the files into a context<br />      ;; file containing all the necessary data to load<br />      ;; the context<br />
&#160;&#160;    (saveContext fileName)<br />
&#160;&#160;          ;; It is important to call the initialization function<br />            ;; AFTER the context file is saved. This procedure<br />            ;; may create structures that can&#8217;t be saved into<br />            ;; a context file but a subsequent load of SKILL files<br />            ;; for another context may need the call to have taken<br />            ;; place.<br />
&#160;&#160;    (callInitProc cxt)<br />
&#160;&#160;    ;; Set the SKILL path back to what it was.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008320"></a>      (setSkillPath oldPath)<br />            (unless oldStatus (sstatus writeProtect nil))<br />))<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008321"></a>procedure( buildContext(cxt)<br />;;--------------------------<br />;; Deletes existing context and prepares to create the context<br />
(progn 
&#160;&#160;    (deleteFile (strcat &quot;/&lt;user&gt;/etc/context/&quot; cxt &quot;.cxt&quot;))<br />      (cond ((isDir cxt &quot;/&lt;user&gt;/source/&quot;)<br />                  (makeContext cxt))<br />            (t (printf &quot;Can&#8217;t find context directory %s\n&quot; cxt))<br />      )<br />))<br /> <br />;; Using getContext, load all the contexts that the code is<br />;; likely to need. For instance, the most basic<br />;; of contexts from Cadence are loaded first.<br />
getContext(&quot;skillCore&quot;)
getContext(&quot;dbRead&quot;)
getContext &#8230;.

;; After loading all the dependencies, build all local 
;; contexts

buildContext(&quot;cap1&quot;)
buildContext(&quot;cap2&quot;)
buildContext(&quot;capn&quot;)

exit
;; end of file myContextBuild.il</pre>
<h3>
<a id="pgfId-1008322"></a>Building the Contexts</h3>

<p>
<a id="pgfId-1008324"></a>At this point everything is ready to build the <a id="marker-1008323"></a>contexts in a special call to the Cadence executable. Let us assume that the executable is called <code>cds</code>. The following line can be typed at the UNIX command line or can be made part of a make file to be called during the normal integration cycle.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008325"></a>cds -ilLoadIL myContextBuild.il -nograph</pre>

<p>
<a id="pgfId-1008326"></a>The output from the <code>cds</code> call can be piped into a file if a record of the build is needed. </p>

<h4>
<a id="pgfId-1008327"></a>ilLoadIL Option</h4>

<p>
<a id="pgfId-1008329"></a>The <code>-ilLoadIL</code><a id="marker-1008328"></a> option causes the executable to switch into a special mode for context building and to allow itself to first read and evaluate the SKILL file before doing any of the normal operations for initializing the executable. That is why a call to the <code>exit</code> command is the last thing the file <code>myContextBuild.il </code>performs. It is meaningless to do more with the system after that.</p>

<h4>
<a id="pgfId-1008330"></a>nograph Option</h4>

<p>
<a id="pgfId-1008332"></a>The second option -<a id="marker-1008331"></a><code>nograph</code> causes the executable to run with all graphics turned off. This option is useful if the integration is done on a machine that does not have X running. This option is not necessary for context building to work.</p>

<h3>
<a id="pgfId-1008334"></a>Initializing Contexts<a id="marker-1008333"></a></h3>

<p>
<a id="pgfId-1008335"></a>Certain process-dependent constructs cannot be saved into a context. In the following example, a file port needs to be opened as part of the initialization phase of the code to be loaded. Use </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008336"></a>myFile = outfile(&quot;/tmp/data&quot;)</pre>

<p>
<a id="pgfId-1008337"></a>The contents of the <code>myFile </code>symbol are not saved into a context because they would be meaningless when loaded into a different session. You need to define a special initialization function to initialize variables or structures that can only be initialized in the current session. </p>
<p>
<a id="pgfId-1008339"></a>You can use the <span class="webflare-courier-new" style="white-space:pre"><em></em></span><a id="marker-1008338"></a>defInitProc function to define an initialization for each context. Let us assume a capability called <code>cap1</code> that opens a file and starts a child process. If the code for the capability needs to go into a binary context file, you need an initialization function to set up the file and the child process in the current session. The arrangement is as follows:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008340"></a>procedure(cap1InitProc()<br />;;---------------------<br />;; This procedure initializes two global variables: myFile <br />;; and myChild <br />                 <br />      myFile = outfile(&quot;/tmp/data&quot;)<br />      myChild = ipcBeginProcess(..)<br />)<br />
;; The next line of code designates the above function
;; to be the initialization code for the context cap1. 

(defInitProc &quot;cap1&quot; &#39;cap1InitProc)

;; end sample code</pre>

<p>
<a id="pgfId-1008341"></a>The call to defInitProc must be executed when the code is loaded, that is, it should not be included in a procedure but rather it should be placed at the top-level of a file to be executed during the loading of the file. </p>
<p>
<a id="pgfId-1008342"></a>To summarize the work so far, you have seen how to</p>
<ul><li>
<a id="pgfId-1008343"></a>Organize the source code</li><li>
<a id="pgfId-1008344"></a>Set up code to initialize the context</li><li>
<a id="pgfId-1008345"></a>Write the SKILL code to drive the building of contexts</li></ul>



<h3>
<a id="pgfId-1008346"></a>Loading Contexts</h3>

<p>
<a id="pgfId-1008348"></a>Context <a id="marker-1008347"></a>loading can be done in two ways, depending on the need for a particular context. </p>

<h4>
<a id="pgfId-1008349"></a>Loading Contexts at the Start of a Session</h4>

<p>
<a id="pgfId-1008350"></a>If the code in the context is needed at the start of a session, use the .<code>cdsinit</code> file to force the loading of the required contexts by adding the following lines to the .<code>cdsinit</code> file.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008351"></a>loadContext(strcat(prependInstallPath(&quot;etc/context/&quot;)<br />                  &quot;cap1.cxt&quot;)<br />callInitProc(&quot;cap1&quot;)</pre>

<p>
<a id="pgfId-1008352"></a>These two lines are needed for every context that is force-loaded by a call to loadContext.The call to callInitProc is needed to cause the initialization function for the context to be called. The basic loadContext function does not automatically do that. </p>

<h4>
<a id="pgfId-1008353"></a>Loading Contexts on Demand</h4>

<p>
<a id="pgfId-1008354"></a>Another option for contexts is to use the auto-load mechanism. This mechanism forces the context to be loaded on demand. There are two steps to achieving this.</p>
<ul><li>
<a id="pgfId-1008355"></a> Generate an auto-load file.</li><li>
<a id="pgfId-1008356"></a> Load the auto-load file in the .<code>cdsinit</code> file.</li></ul>

<p>
<a id="pgfId-1008357"></a>The context is loaded automatically whenever one of its functions is called. To generate the auto-load file, first isolate all the entry point functions of a certain capability/context. When these functions are known, the contents of the auto-load file should look as follows.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008358"></a>;; This is the auto-load file for cap1. func1 through funcN<br />;; are the entry point functions for the capability cap1.<br />;; Call this file cap1.al</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008359"></a>foreach(x &#39;(func1 func2 func3 ..funcN)<br />            (putprop x &quot;/&lt;user&gt;/etc/context/cap1.cxt&quot; &#39;autoload))<br />;; end of auto-load file</pre>

<p>
<a id="pgfId-1008361"></a>The call to the <a id="marker-1008360"></a>putprop function causes the symbol name of the function to have the <a id="marker-1008362"></a>autoload property assigned a string value corresponding to the name of the context, with full path, to which the function belongs. This is how the evaluator makes the connection between function name and context file. The autoload mechanism always looks for a context file to autoload under <code>/</code><span class="webflare-courier-new" style="white-space:pre"><em>your_install_dir</em></span><code>/tools/dfII/local/context </code>directory. If you choose to place the file under this directory, you don&#8217;t need to give the property a full path; just the name of the context file is enough.</p>
<p>
<a id="pgfId-1008363"></a>When the function is called during a normal session, and it does not have a function definition, the evaluator force-loads and initializes the context at that point. It is important to stress that the auto-load mechanism automatically calls the initialization function associated with the loaded context. After the context is loaded and the symbol gets a function definition, the evaluator calls the function and continues with the session.</p>
<p>
<a id="pgfId-1008364"></a>Now that the auto-load file has been created, it can go anywhere the .<code>cdsinit</code> file can find it. You can place this file anywhere you choose, provided it is loaded at startup. The entry in the .<code>cdsinit</code> file needed to load the auto-load file is as follows.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008365"></a>load( &quot;/<code><em>your_install_dir</em></code>/tools/dfII/local/context/cap1.al&quot;)</pre>
<h4>
<a id="pgfId-1008366"></a>Working with a Menu-Driven User Interface</h4>

<p>
<a id="pgfId-1008367"></a>Some applications or capabilities have a menu-driven user interface. This implies that potentially the context for a capability does not have to be loaded, but the menus from which the capability is driven have to be put in place. In this case, the auto-load file (<code>cap.al</code>) must be augmented with the necessary code to create and insert menus in the appropriate places, such as banners. </p>
<p>
<a id="pgfId-1008368"></a>When the auto-load file is loaded during the initialization phase of the executable, the desired menus appear and the callbacks for menu entries have the auto-load property set as explained above. The effect is that when menu commands are selected, the callback forces the corresponding context to load and execute the selected function. It is always safer to create and insert menus before adding the auto-load property on the function symbols. </p>

<h3>
<a id="pgfId-1008369"></a>Customizing External Contexts</h3>

<p>
<a id="pgfId-1008371"></a>You might want to customize the loading of externally supplied <a id="marker-1008370"></a>contexts. Consider the following example. Whenever the schematics context is loaded in an instance, a block of customer code needs to execute to set up special menus or load extra functionality. This can be accomplished using the defUserInitProc function. This function takes the following arguments.</p>
<ul><li>
<a id="pgfId-1008372"></a>A string denoting the name of the capability and context to customize</li><li>
<a id="pgfId-1008373"></a>A symbol denoting the user-defined callback function to trigger whenever the named context is loaded.</li><li>
<a id="pgfId-1014209"></a>An optional <code>autoInit</code> argument to automatically initialize the named context.</li></ul>



<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008374"></a>defUserInitProc(&quot;schematic&quot;, &#39;mySchematicCustomFunc &#39;autoInitschematic)</pre>

<p>
<a id="pgfId-1016688"></a>The <code>defUserInitProc</code> call causes the <code>mySchematicCustomFunc</code> function to be called after the context for schematic is loaded and initialized.</p>
<p>
<a id="pgfId-1016663"></a>If multiple <code>defUserInitProc</code> calls are defined for the same context, all of them are executed in the order in which they are defined.</p>
<p>
<a id="pgfId-1016596"></a>For example, the following <code>defUserInitProc</code> calls cause the <code>mySchematicNewFunc</code> function to be called after the <code>mySchematicCustomFunc</code>:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016433"></a>defUserInitProc(&quot;schematic&quot;, &#39;mySchematicCustomFunc &#39;autoInitschematic)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016565"></a>defUserInitProc(&quot;schematic&quot;, &#39;mySchematicNewFunc)</pre>

<p>
<a id="pgfId-1016531"></a>The <code>defUserInitProc</code> call is similar to the <code>defInitProc</code> function that initializes a context. The context loading mechanism calls the function defined by <code>defInitProc</code> first and then calls the function defined by <code>defUserInitProc</code>.</p>
<p>
<a id="pgfId-1014707"></a>The <code>initfunction</code> can be a part of the context. To make it a part of the context, you should define it in the context and call <code>defUserInitProc</code> between <code>setContext</code> and <code>saveContext</code> calls to register the function as an <code>initfunction</code>.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1014710"></a><code>loadContext</code> does not update <code>initfunction</code> name for the context if it has already been set by the <code>defUserInitProc</code> call.</div>

<h3>
<a id="pgfId-1008377"></a>Potential Problems</h3>

<p>
<a id="pgfId-1008379"></a>Binary <a id="marker-1008378"></a>context files are built incrementally. This can introduce inter-context warnings, which means that references are made in one context to values outside its own space. Therefore, when the contexts are loaded independently, those values become meaningless. Because the SKILL language is dynamically scoped, excessive use of global data structures and vague boundaries around the program and data spaces of applications can result in this type of warning. SKILL programmers can practice caution by modularizing their code and by using strict naming conventions for their symbol names. </p>
<p>
<a id="pgfId-1008380"></a>When inter-context warnings are detected during context building, they are flagged but the context continues to build, leaving the values indicated as crossing context boundaries to be <code>nil</code>. The following sample cases of code cause inter-context warnings.</p>

<h4>
<a id="pgfId-1008381"></a>Sharing Lists Across Contexts</h4>

<p>
<a id="pgfId-1008382"></a>Consider the following sample code involving two contexts.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008383"></a>;; Code in context 1. This code builds list structures by <br />;; sharing sub-lists<br />
field = list(&#39;nil &#39;_item &quot;hello world&quot; &#39;item2 22)
form1 = list(&#39;xxx field)
form2 = list(&#39;yyy field)

;; Code in context 2. Also building list structures but
;; sharing sub-lists from context1

form3 = list(&#39;zzz field)

;; end sample code</pre>

<p>
<a id="pgfId-1008384"></a>In the three form variables, the <code>field </code>structure is shared. However when contexts are saved separately, the list structure for the <code>field </code>part of <code>form3</code> is not saved with the data in context 2, because it is outside the context&#8217;s bounds. If the two contexts were created in the sequence given, a warning would be flagged indicating the part of the list in context 2 that is crossing boundaries with context 1. Both contexts would be named and the lists involved displayed.</p>
<p>
<a id="pgfId-1008385"></a>If each context maintained the lists it needs within the context boundary, this would solve the problem. In this case, if the contents of the variable <code>field</code> are needed, a copy should be performed in context 2 to get a copy of the list locally to that context. </p>

<h4>
<a id="pgfId-1008386"></a>The Conditional eq Failure</h4>

<p>
<a id="pgfId-1008387"></a>The context saving algorithms attempt to smooth out the inter-context problems by copying atoms across context boundaries. For instance:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008388"></a>;; Code in context 1. Here a function is defined such that <br />;; when called it constructs and returns a list.<br />
procedure( foo()
&#160;&#160;    list(42 &quot;hello world&quot; 42)<br />)<br />var1 = foo()<br />
;; Code in context 2. A call to foo is made and the result is 
;; stored in var2

var2 = foo()

(eq (cadr var1) (cadr var2))&#160;&#160;   ;; Normally returns t<br />(equal (cadr var1) (cadr var2))  ;; Normally returns t<br />
;; end sample code</pre>

<p>
<a id="pgfId-1008390"></a>When separate contexts are generated incrementally for the code above and you load both contexts in a session, the call to eq returns nil indicating the two strings &#8220;hello world&#8221; in the two separate lists pointed to by <code>var1</code> and <code>var2 </code>are not the same instance or pointer. That is because the string &#8220;hello world&#8221; was copied into context 2 when the binary context for context 2 was saved. This allows the list pointed to by <code>var2</code> to remain complete. Such copying is only done on atomic structures, such as integers or strings.</p>
<p>
<a id="pgfId-1008391"></a>This condition is not flagged by any errors at context build time.</p>

<h4>
<a id="pgfId-1008392"></a>Execution During Load</h4>

<p>
<a id="pgfId-1008393"></a>The SKILL code executed during the loading of <code>startup.il</code> executes all top-level statements (that is how procedure definitions are done). It was explained earlier that certain data types cannot be saved into a context and have to be regenerated using a context-specific initialization function. There are process-related executions (that is, not necessarily data-related) that have to occur during the context initialization phase. For example, consider the following.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008394"></a>;; Assume the function isMorning is a boolean that calls<br />;; time related internal functions and returns t if the<br />;; current time is AM.<br />
if ( isMorning() 
then greeting = &quot;good morning&quot;
else greeting = &quot;good afternoon&quot;)
form-&gt;title-&gt;value = greeting

;; end of sample </pre>

<p>
<a id="pgfId-1008395"></a>When the context is built using the code above, the <code>isMorning</code> function is executed and the <code>greeting</code> is set correctly. The value of <code>greeting</code> and the value of <code>form-&gt;title-&gt;value</code> are &#8220;frozen&#8221; in the context file. On subsequent loads of the context, the <code>isMorning</code> function will not execute so the greeting will take the value given to it at the time the context was built. To remedy this situation, the code above should be made part of the initialization function for a context.</p>

<h3>
<a id="pgfId-1008397"></a>Context Building Functions<a id="marker-1008396"></a></h3>
<h4>
<a id="pgfId-1008398"></a>Saving the Current State of the SKILL Language Interpreter as a Binary File (saveContext) </h4>

<p>
<a id="pgfId-1008400"></a><code>saveContext</code><a id="marker-1008399"></a> saves the current state of the SKILL language interpreter as a binary file. This function is best used in conjunction with <code>setContext</code>. <code>saveContext</code> saves all function and variable definitions that occur, usually due to file loading, between the calls to <code>setContext</code> and <code>saveContext</code>. Those definitions can then be loaded into a future session much faster in the form of a context using the <code>loadContext</code> function. </p>
<p>
<a id="pgfId-1008401"></a>By default all functions defined in a context are read and write protected unless the <code>writeProtect</code> system switch was turned off when the function was defined between the calls to <code>setContext</code> and <code>saveContext</code>. If the full path is not specified, this function uses the <code>SKILL path</code> to determine where to store the context file name.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016181"></a>setContext( &quot;myContext&quot;)         =&gt; t<br />load(&quot;mySkillCode.il&quot;)           =&gt; t<br />defInitProc(&quot;myContext&quot; &#39;myInit) =&gt; t<br />saveContext(&quot;myContext.cxt&quot;)&#160;&#160;   =&gt; t</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016182"></a></pre>

<p>
<a id="pgfId-1016188"></a>Context creation fails when the code size is too big inside a construct. The maximum size is 32KB. To avoid a failure, it is recommended that you divide the code into smaller constructs or use the setSaveContextVersion(getNativeContextVersion()) function to set native save context version and increase the capacity (see <a href="chap10.html#43870">Context Version Functions</a>). However, contexts created with increased capacity are not compatible with earlier versions of SKILL.</p>

<h4>
<a id="pgfId-1016183"></a>Saving Contexts Incrementally (setContext) </h4>

<p>
<a id="pgfId-1008405"></a><code>setContext</code><a id="marker-1008404"></a> allows contexts to be saved incrementally, creating micro contexts from a session&#8217;s SKILL context. To understand this, think of the SKILL interpreter space as linear; the function call <code>setContext</code> sets markers along the linear path. Any SKILL files loaded between a <em>setContext</em> and a <em>saveContext</em> are saved in the file named in the <code>saveContext</code> call. This function can be used more than once during a session.</p>

<h4>
<a id="pgfId-1008406"></a>Loading the Context File into the Current Session (loadContext) </h4>

<p>
<a id="pgfId-1008408"></a><code>loadContext</code><a id="marker-1008407"></a> loads the context file into the current session. You should always fully qualify the file name. The default directories will be searched for the file if the name is not fully qualified. The context file must have been created using the function <code>saveContext</code>. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008409"></a>loadContext( &quot;/usr/mnt/charb/myContext.cxt&quot; )</pre>

<p>
<a id="pgfId-1008410"></a>Loads the <code>myContext.cxt</code> context. </p>

<div class="webflare-information-macro webflare-macro-information">
<a id="pgfId-1015203"></a>
In 64-bit environment, 64 bit context files are placed under the <span class="webflare-courier-new" style="white-space:pre"><em>/64bit</em></span> directory. If the specified path does not contain <span class="webflare-courier-new" style="white-space:pre"><em>/64bit</em></span>, it is automatically prepended to the context file name. For example, </div>

<p>
<a id="pgfId-1015266"></a>If your current working directory is <span class="webflare-courier-new" style="white-space:pre"><em>/home/user/615/local/context,</em></span> <code>saveContext( </code>&quot;<code>myContext.cxt</code>&quot;<code> )</code> places the <code>myContext.cxt</code> file under <span class="webflare-courier-new" style="white-space:pre"><em>/home/user/615/local/context/64bit.</em></span></p>
<p>
<a id="pgfId-1015295"></a>Similarly, <code>loadContext(</code> &quot;<code>/home/usr/615/local/context/myContext.cxt</code>&quot;<code>)</code> is converted internally to <code>loadContext(</code>&quot;<code>/home/usr/615/local/context/64bit/myContext.cxt</code>&quot;<code>)</code></p>
<p>
<a id="pgfId-1015010"></a>It is advisable to not load context files supplied by Cadence using <code>loadContext</code>. It is better to rely on the autoload mechanism for context files you do not own.</p>

<h4>
<a id="pgfId-1014188"></a>Concatenating the Context Files (UNIX cat command)</h4>

<p>
<a id="pgfId-1014199"></a>You can concatenate two or more context files into one using the UNIX <code>cat</code> command. The concatenated files can then be loaded together in the order of concatenation. For example.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014285"></a>setContext( &quot;myContext&quot;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014286"></a>defun( myContextFunction ()</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014380"></a>     info( &quot;this is myContextFunction\n&quot;))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014381"></a>defUserInitProc( &quot;myContext&quot; &#39;myContextFunction t)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014382"></a>saveContext( &quot;myContext.cxt&quot;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014291"></a>setContext( &quot;yourContext&quot;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014292"></a>defun( yourContextFunction ()</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014481"></a>     info( &quot;this is yourContextFunction\n&quot;))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014482"></a>defUserInitProc( &quot;yourContext&quot; &#39;yourContextFunction t)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014483"></a>saveContext( &quot;yourContext.cxt&quot;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014296"></a>;;concatenate the context files using the UNIX cat command</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014655"></a>system(&quot;cat myContext.cxt yourContext.cxt &gt; combinedContext.cxt&quot;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014642"></a>;;load the concatenated context file</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014662"></a>loadContext(&quot;combinedContext.cxt&quot;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014299"></a>;;The files are loaded in the order of concatenation</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014673"></a>=&gt; this is myContextFunction</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014300"></a>=&gt;this is yourContextFunction</pre>
<h4>
<a id="pgfId-1008412"></a>Calling Initialization Functions Associated with a Context (callInitProc) </h4>

<p>
<a id="pgfId-1008414"></a><code>callInitProc</code><a id="marker-1008413"></a> takes the same argument as <code>loadContext</code> and causes the initialization functions associated with the context to be called. This function need not be used if the loading of the context is happening through the autoload mechanism. Use this function only when calling <code>loadContext</code> manually. For example</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008415"></a>loadContext(&quot;myContext&quot;)     =&gt; t<br />callInitProc(&quot;myContext&quot;)&#160;&#160;  =&gt; t</pre>

<p>
<a id="pgfId-1008416"></a>Functions defined through <code>defInitProc</code> and <code>defUserInitProc</code> are called.</p>

<h4>
<a id="pgfId-1008417"></a>Registering an Initialization Function for a Context (defInitProc) </h4>

<p>
<a id="pgfId-1008419"></a><code>defInitProc</code><a id="marker-1008418"></a> registers an initialization function associated with a context. The initialization function is called when the context is loaded.</p>
<p>
<a id="pgfId-1008420"></a><code>defInitProc</code> always returns t when set up. The initialization function is not called at this point, but is called when the associated context is loaded.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008421"></a>defInitProc(&quot;myContext&quot; &#39;myInitFunc) =&gt; t</pre>
<h4>
<a id="pgfId-1008422"></a><a id="defUserInitProc"></a>Registering a Function for Contexts You Don&#8217;t Own (defUserInitProc)</h4>

<p>
<a id="pgfId-1008424"></a><code>defUserInitProc</code><a id="marker-1008423"></a> registers a user defined function that the system calls immediately after loading and initializing a context. For instance, this function lets you customize Cadence supplied contexts. Usually, most Cadence-supplied contexts have internally defined an initialization function through the <code>defInitProc</code> function. <code>defUserInitProc</code> defines a second initialization function, called after the internal initialization function, thereby allowing you to customize on top of Cadence-supplied contexts. The call to <code>defUserInitProc</code> is best done in the <code>.cdsinit</code> file. </p>
<p>
<a id="pgfId-1014156"></a><code>defUserInitProc</code> always returns <code>t</code> when set up. You can specify the <code>autoInit</code> option to automatically initialize contexts. The initialization function is not called at this point, but is called when the associated context is loaded. </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014157"></a>defUserInitProc( &quot;someContext&quot; &#39;myInitSomeContext &#39;autoInitsomeContext) =&gt; t</pre>
<h3>
<a id="pgfId-1014158"></a><a id="43870"></a>Context Version Functions</h3>

<p>
<a id="pgfId-1012994"></a>Contexts created in IC6.1.4 and later releases with a &#8216;native&#8217; context version could not be loaded with the contexts created in the earlier releases (IC6.1.3, IC6.1.2, IC6.1.1, or IC5.x.41). So, in IC6.1.4, API to set the context version were introduced to resolve these compatibility issues.</p>
<p>
<a id="pgfId-1016230"></a>As described in the table below, a given product release version (6.1.4) can map to a specific SKILL version (31.00), which in turn can have a native context version (602) or a compatible context version (601). To use SKILL contexts across releases, you need to have compatible context versions. </p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1013023"></a>It is possible for two context files to be compatible and still have different number or type of arguments of the referenced functions.</div>
<p>
<a id="pgfId-1011782"></a></p>
<table class="webflareTable" id="#id1011794">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1012895">
<a id="pgfId-1012895"></a>CIC Product Release Version</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1012897">
<a id="pgfId-1012897"></a>SKILL Version</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1012899">
<a id="pgfId-1012899"></a>Native Context Version</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1012901">
<a id="pgfId-1012901"></a>Compatible Context Version </span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1012911"></a><em>6.1.3</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1012913"></a><strong>07.02</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1012915"></a>601</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1012917"></a>N/A</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1012919"></a><em>6.1.4</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1012921"></a><strong>31.00</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1012923"></a>602</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1012925"></a>601</p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1013163"></a>The <code>saveContext</code> function builds either a native or a compatible context version in IC 6.1.4 (the default is compatible.) </p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1013164"></a>Compatible context version runs slower than the native context version in IC 6.1.4.</div>

<h4>
<a id="pgfId-1012464"></a>Retrieving the Current saveContext Version (getCurSaveContextVersion)</h4>

<p>
<a id="pgfId-1012634"></a><code>getCurSaveContextVersion</code> returns the current <code>saveContext</code> version (the version which the new context will have.) The possible return values are, 601 for compatible contexts and 602 for native contexts (for IC 6.1.4/CAT 31.00)</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013429"></a>setSaveContextVersion(getNativeContextVersion())</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013430"></a>601</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013431"></a>getCurSaveContextVersion()</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013301"></a>602</pre>
<h4>
<a id="pgfId-1012635"></a>Resetting the Current saveContext Version (setSaveContextVersion)</h4>

<p>
<a id="pgfId-1013294"></a><code>setSaveContextVersion</code> resets the current <code>saveContext</code> version to <code>x_newVers</code> and returns the previous context version. If <code>x_newVers</code> has an unsupported value or the function is called between <code>setContext</code> and <code>saveContext</code>, it returns an error.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013309"></a>setSaveContextVersion(getCompatContextVersion())</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013310"></a>601</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013311"></a>setSaveContextVersion(0)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013295"></a>*Error* setSaveContextVersion: unsupported context version - 0</pre>
<h4>
<a id="pgfId-1013296"></a>Retrieving the Native Context Version (getNativeContextVersion)</h4>

<p>
<a id="pgfId-1012502"></a><code>getNativeContextVersion</code> returns the native context version (for IC 6.1.4/CAT 31.00, the native context version is 602).</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013330"></a>getNativeContextVersion()<br />602</pre>
<h4>
<a id="pgfId-1012514"></a>Retrieving the Compatible Context Version (getCompatContextVersion)</h4>

<p>
<a id="pgfId-1012313"></a><code>getCompatContextVersion</code> returns the compatible context version (for IC 6.1.4/CAT 31.00, the compatible context version is 601).</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1013399"></a>getCompatContextVersion()<br />601</pre>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1015633"></a>Do not use the 601 or 602 context version values directly in SKILL functions. Use <code>getCompatContextVersion</code>, <code>getNativeContextVersion</code>, or <code>getCurSaveContextVersion </code>instead to retrieve the values of context versions.</div>

<h2>
<a id="pgfId-1015635"></a><a id="26859"></a>Autoloading Your Functions</h2>

<p>
<a id="pgfId-1015637"></a><a id="marker-1015636"></a>Autoloading is the facility through which SKILL code can be loaded dynamically. That is, the code supporting a capability is not loaded until that capability is needed. The load is usually triggered by a call to a function that is undefined in the current session. The evaluator calls on the loader to locate and load the code for the function. You should use autoloading to tune the amount of code loaded in a session to that only needed for that session.</p>
<p>
<a id="pgfId-1008430"></a>The autoloader follows these rules:</p>
<ul><li>
<a id="pgfId-1008431"></a>If there is a property on the function being called with the symbol &quot;autoload&quot; and the value of the property is a string denoting the name of a context (with the extension .<code>cxt</code>), the loader looks for the file under <code>/</code><span class="webflare-courier-new" style="white-space:pre"><em>your_install_dir</em></span><code>/tools/dfII/etc/context</code> (this is where Cadence-supplied contexts are stored) and <code>/</code><span class="webflare-courier-new" style="white-space:pre"><em>your_install_dir</em></span><code>/tools/dfII/local/context</code>. </li><li>
<a id="pgfId-1008432"></a>If the value of the autoload property is a string denoting the name of a file with a full path and the file is a context file (.<code>cxt</code> extension), the context is loaded. If the extension is anything other than .<code>cxt</code>, <code>loadi</code> is called with the file name as its argument. </li><li>
<a id="pgfId-1015489"></a>If the value of the autoload property is an expression, the expression is evaluated. The expression is responsible for taking the necessary steps to define the function triggering the autoload.</li></ul>



<h2>
<a id="pgfId-1015498"></a>Autoloading Your<a id="autoloadclass"></a> Classes</h2>

<p>
<a id="pgfId-1015687"></a>You can autoload a class definition from your SKILL source file (<code>.il </code>or <code>.ils</code>) or a context file (<code>.cxt</code>) by setting the property <code>autoloadClass</code> on a className as shown in the following examples: </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015813"></a><code>myName.autoloadClass=&quot;classX.il&quot;</code></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015814"></a><code>myName.autoloadClass=&quot;contextX.cxt&quot;</code></pre>

<p>
<a id="pgfId-1015905"></a>The autoload mechanism is triggered when the autoload property is set for some class (symbol) and this class is not yet defined then </p>
<p>
<a id="pgfId-1015521"></a>You need to implement this feature from the <code>findClass</code> function. You can also implement nested autoloading to retrieve superclasses for a class being autoloaded. However, this is only possible for SKILL source files, nested autoload for context files is not supported. This means that only the first context file can be autoloaded and the remaining nested context files are skipped.</p>

<h2>
<a id="pgfId-1015492"></a><a id="15160"></a>Encrypting and Compressing Files</h2>

<p>
<a id="pgfId-1008436"></a>Encrypting and <a id="marker-1008435"></a>compressing files allows distribution of SKILL code in a manner that an end user cannot read the code. This is an alternative method to contexts and is intended for small sets of SKILL code that need protection.</p>

<h4>
<a id="pgfId-1008438"></a>Encrypting a File (<a id="marker-1008437"></a>encrypt)</h4>

<p>
<a id="pgfId-1008440"></a>You can <a id="marker-1008439"></a>encrypt SKILL programs and data files. These can subsequently be reloaded using the <a id="marker-1008441"></a><code>load</code>, <code>loadi</code><a id="marker-1008442"></a>, or <h-hot><a actuate="user" class="URL" href="../sklangref/sklangrefTOC.html#firstpage" show="replace" xml:link="simple">include</a></h-hot> functions. <code>encrypt</code> encrypts a file and places the output into another file. If a password is supplied, the same password must be given to the command used to reload the encrypted file.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008444"></a>encrypt( &quot;triadb.il&quot; &quot;triadb_enc.il&quot; &quot;option&quot;) =&gt; t</pre>

<p>
<a id="pgfId-1008445"></a>Encrypts the <code>triadb.il</code> file into the <code>triadb_enc.il </code>file with <code>option</code> as the password. Returns <code>t</code> if successful.</p>

<h4>
<a id="pgfId-1008447"></a>Reducing the Size of a File (<a id="marker-1008446"></a>compress)</h4>

<p>
<a id="pgfId-1008448"></a>You can compress SKILL files to remove unnecessary blank spaces and comments from the file. <code>compress</code> reduces the size of a source file and places the output into a destination file. </p>
<p>
<a id="pgfId-1008449"></a>Compression renders the data less readable because indentation and comments are lost. It is not the same as encrypting the file because the representation of destination file is still in ASCII format.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008450"></a>compress( &quot;triad.il&quot; &quot;triad_cmp.il&quot;) =&gt; t</pre>
<h2>
<a id="pgfId-1008452"></a><a id="92795"></a>Protecting Functions and Variables</h2>

<p>
<a id="pgfId-1008454"></a>The following functions get and set the write-protect status bit on functions and variables. These functions can be used to secure the definitions of functions and the contents of variables when delivering products.<a id="marker-1008453"></a><a id="marker-1008455"></a></p>
<p>
<a id="pgfId-1008456"></a>You can write protect a function by setting the <code>writeProtect</code> status flag. Once turned on, all subsequent function definitions are write protected. </p>

<h3>
<a id="pgfId-1008457"></a>Explicitly Protecting Functions</h3>

<p>
<a id="pgfId-1008458"></a>Protecting functions on a per-function basis is an alternative to <code>sstatus</code> which protects functions on a per-context basis.</p>

<h4>
<a id="pgfId-1008460"></a>Setting the Write-Protect Bit on a Function (<a id="marker-1008459"></a>setFnWriteProtect)</h4>

<p>
<a id="pgfId-1008461"></a><code>setFnWriteProtect</code> sets the write-protect bit on a function. </p>
<ul><li>
<a id="pgfId-1008462"></a>If the function has a function value, it can no longer be changed. </li><li>
<a id="pgfId-1008463"></a>If the function does not have a function value but does have an autoload property, the autoload is still allowed. This is treated as a special case so that all the desired functions can be write-protected first and autoloaded as needed. </li></ul>

<p>
<a id="pgfId-1008464"></a>This example defines a function and sets its write protection so it cannot be redefined.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008465"></a>procedure( test() println( &quot;Called function test&quot; ))<br />setFnWriteProtect( &#39;test ) =&gt; t</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008466"></a>procedure( test() println( &quot;Redefine function test&quot; ))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008467"></a>*Error* def: function name already in use and cannot be <br />      redefined - test</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008468"></a>setFnWriteProtect( &#39;plus ) =&gt; nil</pre>

<p>
<a id="pgfId-1008469"></a>Returns <code>nil</code> because the <code>plus</code> function is already write protected.</p>

<h4>
<a id="pgfId-1008471"></a>Finding the Value of a Function&#8217;s Write-Protect Bit (<a id="marker-1008470"></a>getFnWriteProtect) </h4>

<p>
<a id="pgfId-1008472"></a><code>getFnWriteProtect</code> returns the value of the write-protect bit on a function. The value is <code>t</code> if the function is write-protected or <code>nil</code> otherwise.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008473"></a>getFnWriteProtect( &#39;strlen ) =&gt; t</pre>
<h3>
<a id="pgfId-1008474"></a>Protecting Variables</h3>
<h4>
<a id="pgfId-1008476"></a>Setting the Write-Protect Bit on a Variable (<a id="marker-1008475"></a>setVarWriteProtect)</h4>

<p>
<a id="pgfId-1008477"></a><code>setVarWriteProtect</code> sets the write-protect on a variable. Use this function only when the variable and its contents are to remain constant. </p>
<ul><li>
<a id="pgfId-1008478"></a>If the variable has a value, it can no longer be changed.</li><li>
<a id="pgfId-1008479"></a>If the variable does not have a value, it cannot be used.</li><li>
<a id="pgfId-1008480"></a>If the variable holds a list as its value, that list can no longer be changed.<br />
<a id="pgfId-1010892"></a>For example, if the list is a disembodied property list, attempting to modify the value of properties will fail:<pre class="webflare-pre-block webflare-courier-new" id="#id1008481">
<a id="pgfId-1008481"></a>y = 5                                 ; Initialize the variable y.
setVarWriteProtect( &#39;y )=&gt; t          ; Set y to be write protected.
setVarWriteProtect( &#39;y )=&gt; nil        ; Already write protected.</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1008482">
<a id="pgfId-1008482"></a>y = 10                                ; y is write protected.
*Error* setq: Variable is protected and cannot be assigned to - y</pre></li></ul>






<h4>
<a id="pgfId-1008484"></a><a id="marker-1008483"></a>getVarWriteProtect </h4>

<p>
<a id="pgfId-1008485"></a>Returns the value of the write-protect on a variable.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008486"></a>x = 5<br />getVarWriteProtect( &#39;x )=&gt; nil</pre>

<p>
<a id="pgfId-1008487"></a>Returns <code>nil</code> if the variable <code>x</code> is not write protected.</p>

<h3>
<a id="pgfId-1008489"></a>Global <a id="marker-1008488"></a>Function Protection</h3>

<p>
<a id="pgfId-1008490"></a>Write-protecting code renders the code secure from tampering. </p>
<p>
<a id="pgfId-1008491"></a>To turn on global protection for functions saved in a context, be sure the following line is in your <a id="marker-1008492"></a><code>makeContext</code> utility function described earlier:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008493"></a>sstatus( writeProtect t)</pre>

<p>
<a id="pgfId-1008494"></a>However, if certain pieces of code need to have write-protection turned off (for example, when a function is user definable), use the following method.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008495"></a>;; Sample code showing how to turn off write-protection<br />;; The following let statement should surround all<br />;; that is to have write-protection turned off.<br />
let( ((priorStatus (status writeProtect)))

&#160;&#160;    ;; Turn off write-protection<br />      (sstatus writeProtect nil)<br />
&#160;&#160;    ;; Body of code to have no write-protection<br />      procedure( proc1() &#8230;)<br />      procedure( proc2() &#8230;)<br />      &#8230;etc.<br />
&#160;&#160;    ;; Turn write-protection status back to what it was<br />            (sstatus writeProtect priorStatus)<br />) ;; end-of-let<br />;; end of sample </pre>

<p>
<a id="pgfId-1008201"></a>The call to <code>sstatus</code> takes only the values <code>t/nil</code> as its second argument.</p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="chap9.html" id="prev" title="Advanced Topics">Advanced Topics</a></em></b><b><em><a href="chap11.html" id="nex" title="Writing Style">Writing Style</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;⠀ </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>