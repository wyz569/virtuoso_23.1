
<html><head><title>SKILL++ Object System</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="parula" />
<meta name="CreateDate" content="2023-08-23" />
<meta name="CreateTime" content="1692797218" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the SKILL language to new users and helps them understand advanced topics, encourages sound SKILL programming methods, and introduces the SKILL++ language" />
<meta name="DocTitle" content="Cadence SKILL Language User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="SKILL++ Object System" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="sklanguser" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-08-23" />
<meta name="ModifiedTime" content="1692797218" />
<meta name="NextFile" content="chap17.html" />
<meta name="Group" content="SKILL Language" />
<meta name="Platform" content="Cadence Shared Tools" />
<meta name="PrevFile" content="chap15.html" />
<meta name="c_product" content="Virtuoso Layout Suite,Virtuoso Schematic Editor,Virtuoso Analog Design Environment" />
<meta name="Product" content="SKILL" />
<meta name="ProductFamily" content="SKILL" />
<meta name="ProductVersion" content="IC23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Cadence SKILL Language User Guide -- SKILL++ Object System" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="IC23.1" />
<meta name="SpaceKey" content="sklanguserIC231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="sklanguserTOC.html">Contents</a></li><li><a class="prev" href="chap15.html" title="Using SKILL and SKILL++ Together">Using SKILL and SKILL++ Togeth ...</a></li><li style="float: right;"><a class="viewPrint" href="sklanguser.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="chap17.html" title="Programming Examples">Programming Examples</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Cadence SKILL Language User Guide<br />Product Version IC23.1, September 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>16
<a id="pgfId-1005655"></a></h1>
<h1>
<a id="pgfId-1008199"></a><hr />
<a id="18332"></a>SKILL++ Object System<hr />
</h1>

<p>
<a id="pgfId-1010945"></a>To gain benefits from <a id="marker-1010944"></a>object-oriented programming, the Cadence&#174; SKILL language requires extensions beyond lexical scoping and persistent environments. </p>
<p>
<a id="pgfId-1012841"></a>The Cadence <a id="marker-1012840"></a>SKILL++ Object System allows for object-oriented interfaces based on classes and generic functions composed of methods specialized on those classes. A class can inherit attributes and functionality from another class known as its superclass. SKILL++ class hierarchies result from this inheritance relationship.</p>
<p>
<a id="pgfId-1012842"></a>To attain the maximum benefit from the SKILL++ Object System, you should only use it with lexical scoping, because lexical scoping magnifies the power of the interfaces you can develop with the SKILL++ Object System.</p>
<p>
<a id="pgfId-1010949"></a>You do not need to be familiar with another object-oriented programming language or system to understand or use the SKILL++ Object System. However, if you are familiar with the Common Lisp Object System (CLOS), you can apply your experience of CLOS in learning the SKILL++ Object System as the <a id="marker-1010951"></a>SKILL++ Object System is modelled after a subset of the Common <a id="marker-1010952"></a>Lisp Object System. </p>
<p>
<a id="pgfId-1013128"></a>For more information, see the following sections:</p>
<ul><li>
<a id="pgfId-1008791"></a><a href="chap16.html#40350">Basic Concepts</a>  </li><li>
<a id="pgfId-1008809"></a><a href="chap16.html#19081">Class Hierarchy</a>  </li><li>
<a id="pgfId-1008811"></a><a href="chap16.html#33284">Browsing the Class Hierarchy</a>  </li><li>
<a id="pgfId-1008825"></a><a href="chap16.html#33934">Advanced Concepts</a>  </li></ul>




<h2>
<a id="pgfId-1008217"></a><a id="40350"></a>Basic Concepts</h2>

<p>
<a id="pgfId-1008218"></a>The following items are central concepts of the SKILL++ Object System:</p>
<ul><li>
<a id="pgfId-1011130"></a><a href="chap16.html#87382">Classes and Instances</a></li><li>
<a id="pgfId-1011138"></a><a href="chap16.html#15302">Generic Functions and Methods</a></li><li>
<a id="pgfId-1011143"></a><a href="chap16.html#90179">Subclasses and Superclasses</a></li></ul>


<p>
<a id="pgfId-1011195"></a>For more information, see the following sections:</p>
<ul><li>
<a id="pgfId-1011148"></a><a href="chap16.html#40076">Defining a Class (defclass)</a></li><li>
<a id="pgfId-1011153"></a><a href="chap16.html#22016">Instantiating a Class (makeInstance)</a></li><li>
<a id="pgfId-1017523"></a><a href="chap16.html#96559">Initializing an Instance (initializeInstance)</a></li><li>
<a id="pgfId-1011158"></a><a href="chap16.html#85748">Reading and Writing Instance Slots</a></li><li>
<a id="pgfId-1011163"></a><a href="chap16.html#95356">Defining a Generic Function (defgeneric)</a></li><li>
<a id="pgfId-1011168"></a><a href="chap16.html#49962">Defining a Method (defmethod)</a></li></ul>






<h3>
<a id="pgfId-1008219"></a><a id="87382"></a>Classes and Instances</h3>

<p>
<a id="pgfId-1008222"></a><a id="marker-1008220"></a>A <a id="marker-1008221"></a>class is a data structure template. A specific application of the template is termed an <a id="marker-1008223"></a>instance. All instances of a class have the same slots. SKILL++ Object System provides the following functions:</p>
<ul><li>
<a id="pgfId-1017552"></a><code>defclass</code><a id="marker-1017551"></a> function to create a class </li><li>
<a id="pgfId-1017573"></a><code>makeInstance</code><a id="marker-1017572"></a> function to create an instance of a class</li><li>
<a id="pgfId-1017575"></a><code>initializeInstance</code><a id="marker-1017574"></a> function to initialize a newly created instance</li></ul>



<h3>
<a id="pgfId-1017578"></a><a id="15302"></a>Generic Functions and M<a id="generic functions"></a>ethods</h3>

<p>
<a id="pgfId-1008231"></a><a id="marker-1008229"></a>A <code>generic function</code><a id="marker-1008230"></a> is a collection of function objects. Each element in the collection is called a <code>method</code><a id="genericfunctions"></a>. Each method corresponds to a class. When you call a generic function, you pass an instance as the first argument. The SKILL++ Object System uses the class of the first argument to determine which methods to evaluate. </p>
<p>
<a id="pgfId-1008232"></a>To distinguish them from SKILL++ Object System generic functions, <a id="marker-1008233"></a>SKILL functions are called <code>simple functions</code>. The SKILL++ Object System provides the following functions. </p>
<ul><li>
<a id="pgfId-1008235"></a><code>defgeneric</code><a id="marker-1008234"></a> function to declare a generic function </li><li>
<a id="pgfId-1008237"></a><code>defmethod</code><a id="marker-1008236"></a> function to declare a method </li></ul>


<h3>
<a id="pgfId-1008238"></a><a id="90179"></a>Subclasses and Superclasses</h3>

<p>
<a id="pgfId-1008240"></a>SKILL++ Object System supports both single and multiple inheritance. In single inheritance, <a id="marker-1008239"></a>one class B can inherit structure slots and <a id="marker-1008241"></a>methods from another class A. You can describe the relationship between the class A and class B as follows: </p>
<ul><li>
<a id="pgfId-1008242"></a>B is a subclass of A </li><li>
<a id="pgfId-1008243"></a>A is a superclass of B </li></ul>

<p>
<a id="pgfId-1012906"></a>In multiple inheritance, class B can inherit structure slots and methods from multiple classes. For example, class A and class C. In this case, the relationship between class A, B, and C is as follows:</p>
<ul><li>
<a id="pgfId-1012961"></a>B is a subclass of A and C</li><li>
<a id="pgfId-1012962"></a>A is a superclass of B </li><li>
<a id="pgfId-1012977"></a>C is a superclass of B</li></ul>



<h4>
<a id="pgfId-1016018"></a>Class Precedence List</h4>

<p>
<a id="pgfId-1016019"></a>All inheritance decisions are governed by the class precedence list, which is an ordered list of a given class and its superclasses. The following rules determine the precedence order of classes:</p>
<ul><li>
<a id="pgfId-1016054"></a>In single inheritance: A class is always more specific than its superclass. So the order of precedence flows from left to right. For example,<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1016113">
<a id="pgfId-1016113"></a>defclass(A ())</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1016114">
<a id="pgfId-1016114"></a>defclass(B (A))</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1016102">
<a id="pgfId-1016102"></a>; order of precedence is from B to A</pre></li><li>
<a id="pgfId-1016129"></a>In multiple inheritance: For a given class, superclasses listed on the left are more specific than those listed on the right. So the order of precedence is from the superclass on the left to the superclass on the right. For example,<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1016188">
<a id="pgfId-1016188"></a>defclass(A () ())</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1016189">
<a id="pgfId-1016189"></a>defclass(B () ())</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1016190">
<a id="pgfId-1016190"></a>defclass(X (A B) ()) ; in class X, class A should come before class B</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1016206">
<a id="pgfId-1016206"></a>defclass(Y (B A) ()) ; in class Y, class B should come before class A</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1016223">
<a id="pgfId-1016223"></a>; as per the above rule, the following code results in an error:</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1016234">
<a id="pgfId-1016234"></a>defclass(M (X Y) ())</pre></li></ul>











<h3>
<a id="pgfId-1016021"></a><a id="40076"></a>De<a id="definingClass"></a>fining a Class (defclass)</h3>

<p>
<a id="pgfId-1013907"></a>The <a id="marker-1013906"></a>domain of geometric objects provides good examples for using object oriented programming. Use the <code>defclass</code><a id="marker-1013908"></a> function to define a class. You specify the superclass, if any, and all the slots of the class.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008248"></a>defclass( GeometricObject<br />    ()               ;;; superclass <br />    ()               ;;; list of slot descriptions <br />    ) ; defclass</pre>

<p>
<a id="pgfId-1008249"></a>This example defines the <code>GeometricObject </code>class. Defining the <code>GeometricObject</code> class allows the subsequent definition of default behavior of all geometric objects. It has no slots. Because no superclass is specified, the superclass is the <code>standardObject</code> class. </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008250"></a>defclass( Triangle <br />    ( GeometricObject ) ;;; superclass<br />    (<br />        ( x )       ;;; x slot description <br />        ( y )       ;;; y slot description<br />        ( z )       ;;; z slot description<br />        )<br />    ) ; defClass</pre>

<p>
<a id="pgfId-1008251"></a>This example defines the <code>Triangle</code> class. It declares that </p>
<ul><li>
<a id="pgfId-1008252"></a>The <code>Triangle</code> class is a subclass of the <code>GeometricObject</code> class </li><li>
<a id="pgfId-1008253"></a>Each instance shall have three slots named <code>x</code>, <code>y</code>, and z </li></ul>


<h4>
<a id="pgfId-1008254"></a>Slot Options</h4>

<p>
<a id="pgfId-1008255"></a>Slot options, also known as slot specifiers, govern how you initialize the slot as well as your access to the slot. </p>

<p>
<a id="pgfId-1009338"></a></p>
<table class="webflareTable" id="#id1009343">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1009345">
<a id="pgfId-1009345"></a>Slot Option</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1009347">
<a id="pgfId-1009347"></a>Value</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1009349">
<a id="pgfId-1009349"></a>Meaning</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009351"></a><code>@initarg</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009353"></a>symbol</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1013279"></a>Defines a keyword argument for the <code>makeInstance</code> function. </p>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1013162"></a>You can supply more than one <code>@initarg</code> for a given slot. </div>
<p>
<a id="pgfId-1013327"></a>For more information on the order of precedence used when multiple @initargs are supplied, see <a href="chap16.html#11303">Rules of Initialization</a>.</p>

</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009357"></a><code>@initform</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009359"></a>expression</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009361"></a>Defines an expression which initializes the slot. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009363"></a><code>@reader</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009365"></a>symbol</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009367"></a>Defines a generic function with this name. The function returns the value of the slot.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009369"></a><code>@writer</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009371"></a>symbol</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1009373"></a>Defines a generic function with this name. The function accepts a single argument which becomes the new slot value.</p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-1014807"></a>Example 1</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014808"></a>defclass( Triangle <br />    ( GeometricObject )<br />    (<br />        ( x <br />            @initarg x<br />            )<br />        ( y <br />            @initarg y<br />            )<br />        ( z <br />            @initarg z<br />            )<br />        )<br />    ) ; defClass</pre>
<h4>
<a id="pgfId-1008289"></a>Example 2 </h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008290"></a>defclass( Circle<br />    ( GeometricObject )<br />    (<br />        ( r @initarg r )<br />        )<br />    ) ; defClass</pre>
<h4>
<a id="pgfId-1008291"></a>Inheritance of Slots</h4>

<p>
<a id="pgfId-1013991"></a>The following rules govern the inheritance of slots in subclasses:</p>
<ul><li>
<a id="pgfId-1014005"></a>If a subclass is inherited from a superclass, it also inherits the slots of the superclass. </li><li>
<a id="pgfId-1014055"></a>If a subclass is inherited from multiple superclasses, which have slots with the same name, then only one slot of the given name is inherited. For example:<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1014056">
<a id="pgfId-1014056"></a>defclass( Z1 () ((a @initform 1) (b @initform 1)))
defclass( Z2 () ((b @initform 2) (a @initform 2) (zz)))
defclass( Z3 () ((b @initform 3) (a @initform 3) (zz)))
defclass( Z4 () ((b @initform 4))
defclass( Z5 (Z1 Z2 Z3 Z4) ())
defclass( Z6 (Z4 Z3 Z2 Z1) ())
z5 = makeInstance(&#39;Z5 )
z5-&gt;?
=&gt; (a b zz) ;; slots a, b, and zz are not duplicated</pre></li></ul>


<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1019842"></a>If you define a class with two slots that have the same name, SKILL creates the class but also issues a warning.</div>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019843"></a>defclass(A () ((slotA) (slotB) (slotA @initform 42)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1020112"></a>*WARNING* duplicate slot slotA</pre>

<p>
<a id="pgfId-1020036"></a>Similarly, an error is raised if you define a class in which two <code>@reader</code> or <code>@writer</code> slot options have the same name. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1020085"></a>defclass(A () ((aa @reader getA) (ff @reader getA)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1020086"></a>*Error* defclass: slots (aa ff) cannot use the same name for @reader - getA</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1020172"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1020163"></a>defclass(B () ((aa @reader getB) (dd @writer getB)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1020151"></a>*Error* defclass: slot aa cannot use the same name for @reader and @writer - getB</pre>
<h4><em>
<a id="pgfId-1013955"></a><a id="11303"></a>Rules of Initialization</em></h4>

<ul><li>
<a id="pgfId-1014362"></a>If a subclass is inherited from a superclass, it <a id="rules_initialize"></a>also inherits the slots and methods of the superclass. When you instantiate such a subclass, the initialization arguments (<code>@initargs</code>) of the subclass have precedence over the initialization arguments of the superclass. For example:<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1014405">
<a id="pgfId-1014405"></a>defclass( A1 ()
((slot @initform 1 @initarg a)))
defclass( B1 (A1)
((slot @initform 2 @initarg b)))
(slotValue (makeInstance &#39;B1 ?b 3) &#39;slot) =&gt; 3
(slotValue (makeInstance &#39;B1 ?a 3) &#39;slot) =&gt; 3
(slotValue (makeInstance &#39;B1 ?b 3 ?a 4) &#39;slot) =&gt; 3
(slotValue (makeInstance &#39;B1 ?a 3 ?b 4) &#39;slot) =&gt; 4</pre>
<a id="pgfId-1014399"></a>For more information on instantiating classes, see <a href="chap16.html#22016">Instantiating a Class (makeInstance)</a>.</li><li>
<a id="pgfId-1014184"></a>If two or more <code>@initargs</code> initialize the same slot, then the order of precedence of the initialization arguments is from left to right. For example:<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1014429">
<a id="pgfId-1014429"></a>defclass( C1 () ((slot1)
(slot3 @initarg s3 @reader rs3)
(slot4 @initarg s4 @writer ws4 @initarg (s4a &#39;slot34))))
(slotValue (makeInstance &#39;C1 ) &#39;slot4 ) =&gt; slot34
(slotValue (makeInstance &#39;C1 ?s4a 5 ) &#39;slot4 ) =&gt; 5
(slotValue (makeInstance &#39;C1 ?s4 5 ) &#39;slot4 ) =&gt; 5
(slotValue (makeInstance &#39;C1 ?s4 5 ?s4a 6 ) &#39;slot4 ) =&gt; 5
(slotValue (makeInstance &#39;C1 ?s4a 5 ?s4 6 ) &#39;slot4 ) =&gt; 6</pre></li></ul>





<h3>
<a id="pgfId-1013605"></a><a id="22016"></a>Instantiating a Class (makeInstance)</h3>

<p>
<a id="pgfId-1013608"></a>Use<a id="marker-1013606"></a> the <code>makeInstance</code><a id="marker-1013607"></a> function to instantiate a class. The first argument designates the class you are instantiating. Subsequent keyword arguments initialize the instance&#8217;s slots. The <code>makeInstance</code><a id="makeInstance"></a> function returns the newly allocated instance of the class. </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008295"></a>procedure( makeTriangle( x y z )<br />    if( x&lt;y+z &amp;&amp; y&lt;z+x &amp;&amp; z&lt;x+y<br />      then<br />        makeInstance( &#39;Triangle <br />          ?x 1.0*x <br />          ?y 1.0*y <br />          ?z 1.0*z<br />          )<br />      else<br />        error( <br />          &quot;%n %n %n fail triangle inequality test\n&quot; <br />          x y z <br />          )<br />      ) ; if<br />    ) ; procedure<br />
exampleTriangle = makeTriangle( 3 4 5 ) =&gt; stdobj:0x1e6030</pre>

<p>
<a id="pgfId-1008296"></a>The print representation for a SKILL++ Object System instance consists of <code>stdobj:</code> followed by a hexadecimal number.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1014834"></a><code>makeInstance</code> function does not check for invalid <code>@initargs</code>. If your code contains invalid <code>@initargs</code>, <code>makeInstance</code> accepts the <code>@initargs</code> as additional <code>@rest</code> options.</div>

<h3>
<a id="pgfId-1014872"></a><a id="96559"></a>Initializing an Instance (initializeInstance)</h3>

<p>
<a id="pgfId-1017759"></a>The <code>initializeInstance</code> function is called by <code>makeInstance</code> to initialize a newly created instance. You can define methods for <code>initializeInstance</code> to specify the actions that need to be taken when the instance is initialized. You can also use <code>initializeInstance</code> to add initialization parameters in addition to those defined by <code>@initform</code>. </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026134"></a>defclass(A ()</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026135"></a>  (</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026136"></a>    (x @initarg x @initform 1)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026137"></a>    (y @initarg y @initform 2)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026138"></a>    (product)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026139"></a>  )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026140"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026141"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026142"></a>defmethod( initializeInstance @after ((obj A) @key product @rest args)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026143"></a>  if(product then</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026144"></a>    obj-&gt;product = product</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026145"></a>  else</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026146"></a>    obj-&gt;product = obj-&gt;x * obj-&gt;y</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026147"></a>  )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026148"></a>  printf(&quot;initializeInstance : A : was called with args - obj == &#39;%L&#39;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026149"></a>    product == &#39;%L&#39; rest == &#39;%L&#39;\n&quot; obj product args)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026150"></a>  printf(&quot;  object initialized to: %L\n&quot; obj-&gt;??)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026151"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026152"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026153"></a>makeInstance(&#39;A)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026154"></a>    initializeInstance : A : was called with args - obj == &#39;stdobj@0x2d61020&#39;      product == &#39;nil&#39; rest == &#39;nil&#39;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026155"></a>  object initialized to: (x 1 y 2 product 2)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026156"></a>=&gt; stdobj@0x2d61020</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026157"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026158"></a>makeInstance(&#39;A ?x 5 ?y 10)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026159"></a>    initializeInstance : A : was called with args - obj == &#39;stdobj@0x2d61038&#39;      product == &#39;nil&#39; rest == &#39;(?x 5 ?y 10)&#39;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026160"></a>  object initialized to: (x 5 y 10 product 50)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026161"></a>=&gt; stdobj@0x2d61038</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026162"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026163"></a>makeInstance(&#39;A ?product 30)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026164"></a>    initializeInstance : A : was called with args - obj == &#39;stdobj@0x2d61050&#39;      product == &#39;30&#39; rest == &#39;nil&#39;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026165"></a>  object initialized to: (x 1 y 2 product 30)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1026166"></a>=&gt; stdobj@0x2d61050</pre>
<h3>
<a id="pgfId-1017762"></a><a id="85748"></a>Reading and Writing Instance Slots</h3>

<p>
<a id="pgfId-1008300"></a>You can use the arrow <a id="marker-1008299"></a>operator to read a slot&#8217;s value.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008301"></a>exampleTriangle-&gt;x =&gt; 3.0<br />exampleTriangle-&gt;y =&gt; 4.0<br />exampleTriangle-&gt;z =&gt; 5.0</pre>

<p>
<a id="pgfId-1008302"></a>You can use the <code>-&gt;</code> operator on the left-side of an assignment statement.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008303"></a>exampleTriangle-&gt;x = 3.5</pre>

<p>
<a id="pgfId-1008304"></a>The <code>-&gt;??</code> expression returns a list of the slots and their values.</p>
<p>
<a id="pgfId-1008306"></a>Another approach is to use the <code>@reader </code>and <code>@writer</code> slot options to define generic functions for reading and writing slots when you define the class. </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1017730"></a>defclass( Triangle <br />    ( GeometricObject )<br />    (<br />        ( x <br />            @initarg         x<br />            @reader          get_x<br />            @writer          set_x<br />            )<br />        ( y <br />            @initarg         y<br />            @reader          get_y<br />            @writer          set_y<br />            )<br />        ( z <br />            @initarg         z<br />            @reader          get_z<br />            @writer          set_z<br />            )<br />        )<br />    ) ; defClass<br />
exampleTriangle = makeTriangle( 3 4 5 ) =&gt; stdobj:0x1e603c
get_y( exampleTriangle ) =&gt; 4.0
set_x( exampleTriangle 3.5 ) =&gt; 3.5</pre>
<h3>
<a id="pgfId-1008308"></a><a id="95356"></a>Defining a Gen<a id="defgeneric"></a>eric Function (defgeneric)</h3>

<p>
<a id="pgfId-1008311"></a>Use the <code>defgeneric</code><a id="marker-1008309"></a> function to define a generic function. The body of the generic function defines the default method for the generic function. <a id="marker-1008310"></a></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008312"></a>defgeneric( Perimeter ( geometricObject )<br />      error( &quot;Subclass responsibility\n&quot; )<br />      ) ; defgeneric</pre>

<p>
<a id="pgfId-1008313"></a>This example indicates that relevant subclasses of the <code>geometricObject</code> class, such the <code>polygon</code> class, should have a <code>Perimeter</code> method. Although not strictly necessary to do so, defining a generic function before defining any methods for it has two advantages:</p>
<ul><li>
<a id="pgfId-1008314"></a>You can specify a default method <br />
<a id="pgfId-1008315"></a>Using the <code>defgeneric</code> function gives you control over the default method. When you invoke a generic function that has no default method, the SKILL++ Object System raises an error. The following example illustrates calling a generic function which does not have a method defined for the specific argument.<pre class="webflare-pre-block webflare-courier-new" id="#id1008316">
<a id="pgfId-1008316"></a>Perimeter( 3 )
*Error* (Default-method) generic:Perimeter class:fixnum</pre></li><li>
<a id="pgfId-1008317"></a>You can document the template argument list <br />
<a id="pgfId-1008318"></a>In the absence of a generic function, the first method you define automatically declares the generic function. The method&#8217;s argument list becomes the template argument list.</li></ul>




<p>
<a id="pgfId-1019726"></a>You can also use the <code>defgeneric</code> function to associate a <em>proxy</em> class, called a <em>generic function class</em>, with the generic function. A <em>proxy</em> class is useful when defining customSpecializer methods for a particular class, or for defining dependency protocol where the methods are specialized on a particular generic function class. The basic need for an application specific <em>proxy</em> class is to be able to differentiate one group of generic functions from others in an application specific way. </p>
<p>
<a id="pgfId-1019727"></a>By default, all generic functions are associated with <code>class:ilGenericFunction</code>. So, to be able to use a <em>proxy</em> class you need to inherit the class from <code>class:ilGenericFunction </code>as shown in the following example.</p>

<h4>
<a id="pgfId-1019728"></a>Example 1</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019729"></a>defclass(niGF (ilGenericFunction) ()) ; generic class &#39;niGF </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019730"></a>defgeneric(niTest (x y) ?genericFunctionClass niGF) ; generic function niTest is associated with class:niGF</pre>

<p>
<a id="pgfId-1019731"></a>In this example, <code>niGF</code> is the <em>proxy</em> class for the generic function, <code>niTest</code>. The instance of this class is created when either a generic function is defined (at <code>defgeneric</code> time) or when this class is accessed for the first time.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1019732"></a>This lazy creation of the <em>proxy</em> object is especially true for generic functions loaded from a context.</div>
<p>
<a id="pgfId-1019733"></a>To retrieve a <em>proxy</em> instance from the generic function object, use the <code>getGFproxy</code> function as shown in the example below. The instance of the proxy object retrieved is stored in property list of generic function symbol.</p>

<h4>
<a id="pgfId-1019734"></a>Example 2</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019735"></a>getGFproxy(&#39;niTest)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019736"></a>  =&gt; stdobj@0x83c0018</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019737"></a>classOf(getGFproxy(&#39;niTest))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019738"></a>  =&gt; class:niGF</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019739"></a>classOf(getGFproxy(&#39;printself))&#160;&#160;;; class of standard generic function (printself)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019740"></a>  =&gt; class:ilGenericFunction  ;; default</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019741"></a>getGFproxy(&#39;abc)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019742"></a>  =&gt; nil ;; non-existing generic function</pre>

<p>
<a id="pgfId-1019713"></a>In addition, you can inherit from a generic function <em>proxy</em> class by using the <code>defclass</code> function, which is in turn inherited from <code>class:ilGenericFunction</code> (or optionally from any other standardObject class). </p>

<h3>
<a id="pgfId-1008323"></a><a id="49962"></a>Defining a Method (defmethod)</h3>

<p>
<a id="pgfId-1008325"></a>Use the <code>defmethod</code><a id="marker-1008324"></a> function to define a method. You do not need to define the generic function before you define a method for it. When you invoke a generic function, the SKILL++ Object System chooses the method to run based on the class of the first argument you pass to the function. <a id="marker-1008326"></a></p>
<ul><li>
<a id="pgfId-1008327"></a>If you use conventional syntax <code>defmethod( &#8230; )</code> in place of the LISP syntax 
<code>( defmethod &#8230; )</code>, use white space to separate the method name from the argument list. </li><li>
<a id="pgfId-1008328"></a>You must specify the class of the method&#8217;s first argument to the <code>defmethod</code> function. The first argument to <code>defmethod</code> uses the following syntax:<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1008329">
<a id="pgfId-1008329"></a>( s_arg1 s_class )</pre></li></ul>



<h4>
<a id="pgfId-1008330"></a>Example 1</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008331"></a>defmethod( Perimeter (( triangle Triangle ))<br />    let( (<br />        (x triangle-&gt;x)<br />        (y triangle-&gt;y)<br />        (z triangle-&gt;z)<br />        )<br />        x+y+z<br />        ) ; let<br />    ) ; defmethod<br />
Perimeter( exampleTriangle ) =&gt; 12.0</pre>

<p>
<a id="pgfId-1008332"></a>This example defines a method named <code>Perimeter</code>. It is specialized on the <code>Triangle</code> class.</p>

<h4>
<a id="pgfId-1008333"></a>Example 2</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008334"></a>defmethod( Perimeter (( c Circle ))<br />    2*c-&gt;r*3.1415<br />    ) ; defmethod</pre>

<p>
<a id="pgfId-1014642"></a>This example defines a <code>Circle</code> class and defines the <code>Perimeter</code> method for the <code>Circle</code> class.</p>
<p>
<a id="pgfId-1014981"></a>You can specify additional optional arguments while defining a method of a generic function by using the <code>@rest</code> option. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1014995"></a>defgeneric( myTest (x @rest _args))<br />; The following derived methods use additional @key and @optional arguments:<br />defmethod( myTest (x) 1)<br />=&gt; t<br />defmethod( myTest ((x string) @key (z 2)) 3)<br />=&gt; t<br />defmethod( myTest ((x number) @optional a b c) 4)<br />=&gt; t</pre>
<h4>
<a id="pgfId-1018269"></a>The eqv Specializer</h4>

<p>
<a id="pgfId-1018270"></a>While defining a method using <code>defmethod</code>, you can use the <code>eqv</code> specializer to specialize the method on objects other than classes (for example, some value of its arguments). </p>
<p>
<a id="pgfId-1018298"></a>When <code>eqv</code> is encountered in a method declaration, the value of the argument of the method is compared to the <code>eqv</code> value. If a match is found, the method is excecuted. For example,</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1018324"></a>defgeneric( factorial (x))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1018326"></a>defmethod( factorial ((x fixnum)) ;; #1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1018327"></a>  (times x (factorial (sub1 x))))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1018329"></a>defmethod( factorial ((x (eqv 0)) ;; #2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1018354"></a>1)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1018330"></a>; method #2 is applicable if the argument is eqv to 0</pre>
<h3>
<a id="pgfId-1014989"></a>Defining Method <a id="method_combination"></a>Combinations (@before,  @after, and @around)</h3>

<p>
<a id="pgfId-1012283"></a>Once you have defined a generic function, you can combine it with methods that execute before or after the normal implementation. There are three kinds of additional or auxiliary methods that you can use with <code>defmethod</code>:&#160;&#160;<code>@before,</code>  <code>@after</code>,and <code>@around</code> methods. </p>
<p>
<a id="pgfId-1012290"></a>A standard method combination will have <code>defmethod</code> as the primary method and a method qualifier (<code>@before,</code> <code>@after, @around</code>) between the name of the method and the parameter list.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1012330"></a>defmethod( mymethod @before ((x number)) )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1012407"></a>defmethod( mymethod @after ((x fixnum)) )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1018643"></a>defmethod( mymethod @around ((x number) y))</pre>

<p>
<a id="pgfId-1019568"></a>All the applicable methods are evaluated and partitioned into separate lists according to their qualifiers. A diagrammatic representation of the order in which the applicable methods are invoked is given below:</p>
<p>
<a id="pgfId-1019569"></a></p>

<div class="webflare-div-image">
<img width="668" height="50" src="images/chap16-2.gif" /></div>

<p>
<a id="pgfId-1019570"></a>The detailed order in which the applicable methods are invoked is as follows:</p>
<ul><li>
<a id="pgfId-1018786"></a>The <code>@around</code> methods, if defined, are executed first. <br />
<a id="pgfId-1018867"></a>If an <code>@around</code> method invokes <code>callNextMethod</code>, execute the next most specific <code>@around</code> method, with all its <code>callNextMethod</code> methods.<br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1019489"></a>If no applicable primary method is defined but an <code>@around</code> method exists, an error occurs.</div></li><li>
<a id="pgfId-1018999"></a>If there are no <code>@around</code> methods or if an <code>@around</code> method invokes <code>callNextMethod</code> but there are no further <code>@around</code> methods to call then proceed as follows:<ul><li>
<a id="pgfId-1019000"></a>The <code>@before</code> methods are executed thereafter, with the most-specific method invoked first. All <code>@before</code> methods are called before any of the primary methods. <br />
<a id="pgfId-1019001"></a>If you use a <code>callNextMethod</code> in a <code>@before</code> method, an error returns.</li><li>
<a id="pgfId-1012540"></a>Then, the most-specific primary methods are called. <br />
<a id="pgfId-1012571"></a>You can use a <code>callNextMethod</code> inside the body of a primary method to call the next most-specific primary method.</li><li>
<a id="pgfId-1012504"></a>The <code>@after</code> methods are called after the primary methods but in the reverse order, with the least-specific method called first.<br />
<a id="pgfId-1014814"></a>If you use a <code>callNextMethod</code> in an <code>@after</code> method, an error returns.<br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1014815"></a>Calling a generic function that has no primary method, but only <code>@before</code> or <code>@after</code> method qualifiers, results in an error.</div></li></ul></li></ul>
















<p>
<a id="pgfId-1019030"></a>If there is an error in a method, the execution returns to the nearest toplevel.</p>

<h4>
<a id="pgfId-1012665"></a>Example 1</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1012687"></a>defmethod( mymethod (( x fixnum)) ;; # 1 - primary method</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1012688"></a>  ...) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1012690"></a>defmethod( mymethod @before (( x number )) ;; # 2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1012691"></a> ...)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1012693"></a>defmethod( mymethod @before (( x fixnum )) ;; # 3</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1012694"></a>  ...)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1012696"></a>defmethod( mymethod @after (( x fixnum )) ;; #4</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019678"></a>  ...)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019686"></a>defmethod( mymethod @around (( x fixnum)) ;; # 5 - primary method</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019687"></a> . . .</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019688"></a> callNextMethod()</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019689"></a> . . .)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019679"></a></pre>

<p>
<a id="pgfId-1019680"></a>When <code>mymethod</code> is invoked (with a <code>fixnum</code> argument), the methods are called in the following order:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1012749"></a>#5 -&gt; #3 -&gt; #2 -&gt; #1 -&gt; #4</pre>
<h4>
<a id="pgfId-1019070"></a>Example 2</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019094"></a>defmethod(aTest @around ((x number) y)</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1019095"></a>/* 1 : around method*/</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1019096"></a>callNextMethod())</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019097"></a>defmethod(aTest @before ((x number) y)</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1019098"></a>/* 2 : before method */</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1019099"></a>&#8230;)</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019100"></a>defmethod(aTest ((x number) y)</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1019101"></a>/* 3 : a primary method */</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1019102"></a>callNextMethod())</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019103"></a>defmethod(aTest @after ((x number) y)</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1019104"></a>/* 4 : after method */</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1019105"></a>&#8230;)</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019106"></a>defmethod(aTest @around ((x systemObject) y)</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1019107"></a>/* 5 : another @around method */</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1019108"></a>callNextMethod())</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019109"></a>aTest(1)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019110"></a>=&gt; #1 -&gt; #5 -&gt; #2 -&gt; #3 -&gt; #4 (calling order)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1019062"></a></pre>
<h3>
<a id="pgfId-1015033"></a>Multi-Method Dispatch</h3>

<p>
<a id="pgfId-1016281"></a>SKILL++ supports multi-method dispatch. With multi-method dispatch, all arguments of a method are treated equally and the method to be applied is decided at runtime, based on the dynamically-determined types of arguments.</p>
<p>
<a id="pgfId-1015331"></a>It means that you can define more than one method with the same name in your code. When the method call is made, instead of one parameter specializer determining the method to be applied, it is determined by multiple parameter specializers. </p>

<h4>
<a id="pgfId-1015289"></a>Example: Single-Dispatch</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015271"></a>;; body of method1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015272"></a>;; method1 specialized on its first argument only (obj)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015261"></a>defmethod ( method1 ((obj string) x y)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015223"></a>) ; end of method1(string)</pre>
<h4>
<a id="pgfId-1015299"></a>Example: Multiple-Dispatch</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015366"></a>;; body of method2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015367"></a>;; method2 specialized on 3 arguments:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015368"></a>;; obj of type string</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015369"></a>;; x of type number</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015370"></a>;; y of class &quot;classY&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015358"></a>defmethod ( method2 ((obj string) (x number) (y classY))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015321"></a>) ; end of method2</pre>
<h4>
<a id="pgfId-1016378"></a>Method Specificity</h4>

<p>
<a id="pgfId-1016757"></a>In case, all applicable methods have the arguments of the same type, the methods are sorted on the order of specificity. So, the most-specific primary method is called first; other methods can then be called from the primary method by using the <code>callNextMethod</code>. For example,</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016758"></a>defmethod( test ((x number) (y string))<br />printf(&quot;test number/string\n&quot;)<br />callNextMethod()<br />)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016403"></a>defmethod( test ((x fixnum) (y string))<br />printf(&quot;test fixnum/string\n&quot;)<br />callNextMethod()<br />)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016407"></a>defmethod( test ((x number) (y primitiveObject))<br />printf(&quot;test number/primitiveObject\n&quot;)<br />callNextMethod()<br />)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016411"></a>defmethod( test ((x fixnum) (y primitiveObject))<br />printf(&quot;test fixnum/primitiveObject\n&quot;)<br />callNextMethod()<br />)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016415"></a>defmethod( test ((x t) (y t))<br />printf(&quot;test t/t\n&quot;)<br />)</pre>

<p>
<a id="pgfId-1016719"></a>The class precedence list is used in determining the method specificity:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016728"></a>t -&gt; systemObject -&gt; primitiveObject -&gt; string</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016729"></a>t -&gt; systemObject -&gt; primitiveObject -&gt; number -&gt; fixnum</pre>

<p>
<a id="pgfId-1016764"></a>So, for <code>test(1 &quot;test&quot;)</code> the order of method calls is:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016794"></a>; all the applicable methods are called according to the class precedence of arguments:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016765"></a>=&gt; test fixnum/string<br />=&gt; test fixnum/primitiveObject<br />=&gt; test number/string<br />=&gt; test number/primitiveObject<br />=&gt; test t/t</pre>

<p>
<a id="pgfId-1016874"></a>For <code>test(1.0 &quot;test&quot;)</code>, the order of method calls is:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1016920"></a>;three applicable methods are called according to the class precedence of arguments:<br />=&gt; test number/string<br />=&gt; test number/primitiveObject<br />=&gt; test t/t</pre>
<h2>
<a id="pgfId-1016722"></a><a id="19081"></a>Class Hierarchy</h2>

<p>
<a id="pgfId-1008338"></a>The diagram below <a id="marker-1008337"></a>is a horizontal view of the SKILL++ Object System <a id="marker-1008339"></a>class hierarchy. </p>

<p>
<a id="pgfId-1020711"></a></p>
<div class="webflare-div-image">
<img src="images/Class_hierarchy2.gif" /></div>

<ul><li>
<a id="pgfId-1020712"></a><code>t</code> is the superclass of all classes. Class <code>t</code> has two immediate subclasses, <code>standardObject</code> and <code>systemObject</code>. </li><li>
<a id="pgfId-1008410"></a><code>standardObject</code> is the superclass of all classes you define with <code>defclass</code> function. This is the primary portion of the class hierarchy that you can extend.</li><li>
<a id="pgfId-1020729"></a><code>systemObject</code> is the superclass of <code>primitiveObject</code> and <code>specialObject</code>. No subclasses of <code>systemObject</code> can be used with <code>defclass</code>.</li><li>
<a id="pgfId-1008412"></a><code>primitiveObject</code> is the superclass of all SKILL built-in classes.</li><li>
<a id="pgfId-1008413"></a><code>specialObject</code> is the superclass of all classes corresponding to the C-level registrable &#8220;user-types.&#8221;</li><li>
<a id="pgfId-1020774"></a><code>defstructObject</code> is a superclass of all structures defined by <code>defstruct</code> function (You can create such a class with <code>addDefstructClass</code> function).</li></ul>





<p>
<a id="pgfId-1008414"></a>This example shows how you can list all of the subclasses. Run this program to see what the class hierachy is at any given time.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008415"></a>procedure( getDirectSubclasses( classObject )<br />    foreach( mapcar c subclassesOf( classObject )<br />        className( c )<br />        ) ; foreach<br />    ) ; procedure</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008416"></a>procedure( getAllSubclasses( classObject )<br />    let( ( direct )<br />        direct = getDirectSubclasses( classObject )<br />        cons(<br />            className( classObject )<br />            direct &amp;&amp; foreach( mapcar c direct <br />                getAllSubclasses( findClass( c ))<br />                ) ; foreach<br />            ) ; cons<br />        ) ; let<br />    ) ; procedure</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008417"></a>getAllSubclasses( findClass( &#39;t )) =&gt;<br />
(t 
&#160;&#160;  (standardObject <br />        (GeometricObject <br />            (Triangle) <br />                (Point)<br />                )<br />            ) <br />    (systemObject<br />        (primitiveObject<br />            list()<br />            (port) <br />            (funobj) <br />            (array)<br />            (string) <br />            (symbol) <br />            (number <br />                (fixnum) <br />                (flonum)<br />                )<br />            ) <br />    ( specialObject<br />        (other) <br />        (assocTable)<br />        )<br />    )<br />)</pre>
<h2>
<a id="pgfId-1008418"></a><a id="33284"></a>Browsing the Class Hierarchy</h2>

<p>
<a id="pgfId-1008421"></a>The <a id="marker-1008419"></a>SKILL++ Object System provides<a id="marker-1008420"></a> a number of functions for browsing the class hierarchy:</p>
<ul><li>
<a id="pgfId-1011212"></a><a href="chap16.html#32367">Getting the Class Object from the Class Name</a></li><li>
<a id="pgfId-1011219"></a><a href="chap16.html#74167">Getting the Class Name from the Class Object</a></li><li>
<a id="pgfId-1011223"></a><a href="chap16.html#96935">Getting the Class of an Instance</a></li><li>
<a id="pgfId-1015658"></a><a href="chap16.html#14883">Getting the Class of the Environment Object (envObj)</a></li><li>
<a id="pgfId-1011227"></a><a href="chap16.html#60778">Getting the Superclasses of an Instance</a></li><li>
<a id="pgfId-1011231"></a><a href="chap16.html#41713">Checking if an Object Is an Instance of a Class</a></li><li>
<a id="pgfId-1011236"></a><a href="chap16.html#74895">Checking if One Class Is a Subclass of Another</a></li></ul>






<p>
<a id="pgfId-1011210"></a>Examples in these sections refer to the following code:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008422"></a>defclass( GeometricObject<br />    ()      ;;; superclass <br />    ()      ;;; list of slot descriptions <br />    ) ; defclass</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008423"></a>defclass( Triangle <br />    ( GeometricObject ) ;;; superclass<br />    (<br />        ( x @initarg x )  ;; x slot description <br />        ( y @initarg y )  ;; y slot description<br />        ( z @initarg z )  ;; z slot description<br />        )<br />    ) ; defClass</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008424"></a>exampleTriangle = makeTriangle( 3 4 5 ) =&gt; stdobj:0x1e6030</pre>
<h3>
<a id="pgfId-1008425"></a><a id="32367"></a>Getting the Class Object from the Class Name</h3>

<p>
<a id="pgfId-1008427"></a>Use the <code>findClass</code><a id="marker-1008426"></a> function to get the class object from its name. Use a SKILL symbol to represent the class name. </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008428"></a>findClass( &#39;Triangle ) =&gt; funobj:0x1cb2d8</pre>
<h3>
<a id="pgfId-1008429"></a><a id="74167"></a>Getting the Class Name from the Class Object</h3>

<p>
<a id="pgfId-1008431"></a>Use the <code>className</code><a id="marker-1008430"></a> function to get the class symbol. The term <code>class symbol</code> refers to the symbol used to represent the class name. The <a id="marker-1008432"></a>SKILL++ Object System uses a SKILL symbol to represent the class name.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008433"></a>className( findClass( &#39;Triangle )) =&gt; Triangle</pre>
<h3>
<a id="pgfId-1008434"></a><a id="96935"></a>Getting the Class of an Instance</h3>

<p>
<a id="pgfId-1008437"></a>Use the <code>classOf</code><a id="marker-1008435"></a> function to get the class of an instance. <a id="marker-1008436"></a></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008438"></a>className( classOf( exampleTriangle ) ) =&gt; Triangle</pre>
<h3>
<a id="pgfId-1015699"></a><a id="14883"></a>Getting the Class of the Environment Object (envObj)</h3>

<p>
<a id="pgfId-1015701"></a>Use the <code>classOf</code><a id="marker-1015700"></a> function to get the class of the environment object <code>envObj</code>.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015702"></a>z = let( (( x 3 )) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015627"></a>    theEnvironment() </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015628"></a>    ) ; let</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015629"></a>    =&gt; envobj:0x1e0060</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015630"></a>classOf(z)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015631"></a> =&gt; class:envobj</pre>
<h3>
<a id="pgfId-1015633"></a><a id="60778"></a>Getting the Superclasses of an Instance</h3>

<p>
<a id="pgfId-1015546"></a>Use the <code>superclassesOf</code><a id="marker-1015544"></a> function to get the superclasses of a class. The function returns a list of class objects.<a id="marker-1015545"></a></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1015547"></a>L = superclassesOf( classOf( exampleTriangle ) ) <br />
foreach( mapcar classObject L 
&#160;&#160;  className( classObject )<br />    ) ; foreach<br />=&gt; (Triangle GeometricObject standardObject t)</pre>
<h3>
<a id="pgfId-1008444"></a><a id="41713"></a>Checking if an Object Is an Instance of a Class</h3>

<p>
<a id="pgfId-1008446"></a>Use the <code>classp</code><a id="marker-1008445"></a> function to check if an object is an instance of a class. You can pass either the class symbol or the class object as the second argument.</p>

<h4>
<a id="pgfId-1008447"></a>Example 1</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008448"></a>classp( exampleTriangle &#39;Triangle ) =&gt; t<br />classp( 5 &#39;fixnum ) =&gt; t<br />classp( 5 &#39;Triangle ) =&gt; nil</pre>

<p>
<a id="pgfId-1008449"></a>5 is a <code>fixnum</code>. 5 is not an instance of <code>Triangle</code>.</p>

<h4>
<a id="pgfId-1008450"></a>Example 2</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008451"></a>classp( exampleTriangle &#39;GeometricObject ) =&gt; t<br />classp( exampleTriangle &#39;standardObject ) =&gt; t<br />classp( exampleTriangle t ) =&gt; t</pre>

<p>
<a id="pgfId-1008452"></a>This example illustrates that <code>classp</code> returns <code>t </code>for all superclasses of the class of an instance. <code>Triangle</code> is a subclass of <code>GeometricObject</code>. <code>GeometricObject</code> is a subclass of <code>standardObject</code>. <code>standardObject</code> is a subclass of <code>t</code>.</p>

<h3>
<a id="pgfId-1008453"></a><a id="74895"></a>Checking if One Class Is a Subclass of Another</h3>

<p>
<a id="pgfId-1008456"></a>Use the <code>subclassp</code><a id="marker-1008454"></a> function to determine whether one class is a subclass of another.<a id="marker-1008455"></a></p>

<h4>
<a id="pgfId-1008457"></a>Example 1</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008458"></a>subclassp( <br />    findClass( &#39;Triangle ) <br />    findClass( &#39;GeometricObject ) <br />    ) =&gt; t</pre>

<p>
<a id="pgfId-1008459"></a><code>Triangle</code> is a subclass of <code>GeometricObject</code>.</p>

<h4>
<a id="pgfId-1008460"></a>Example 2</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008461"></a>subclassp( <br />    findClass( &#39;Triangle ) <br />    findClass( t )<br />    ) =&gt; t</pre>

<p>
<a id="pgfId-1008462"></a><code>Triangle</code> is a subclass of <code>t</code>.</p>

<h4>
<a id="pgfId-1008463"></a>Example 3</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008464"></a>subclassp( <br />    findClass( &#39;Triangle ) <br />    findClass( &#39;fixnum )<br />    ) =&gt; nil</pre>

<p>
<a id="pgfId-1008465"></a><code>Triangle</code> is not a subclass of <code>fixnum.</code></p>

<h2>
<a id="pgfId-1008466"></a><a id="33934"></a>Advanced Concepts</h2>

<p>
<a id="pgfId-1008468"></a>This section covers the following <a id="marker-1008467"></a>advanced aspects of the SKILL++ Object System:</p>
<ul><li>
<a id="pgfId-1011245"></a><a href="chap16.html#42389">Method Argument Restrictions</a></li><li>
<a id="pgfId-1011252"></a><a href="chap16.html#97863">Applying a Generic Function</a></li><li>
<a id="pgfId-1011257"></a><a href="chap16.html#94240">Incremental Development</a></li><li>
<a id="pgfId-1011262"></a><a href="chap16.html#47665">Methods and Slots</a></li><li>
<a id="pgfId-1011267"></a><a href="chap16.html#14351">Sharing Private Functions and Data Between Methods</a></li><li>
<a id="pgfId-1024308"></a><a href="chap16.html#72054">Using Custom Specializers in SKILL++ Methods</a></li></ul>






<h3>
<a id="pgfId-1008470"></a><a id="42389"></a>Method Argument Restrictions</h3>

<p>
<a id="pgfId-1008472"></a>Method argument lists have the following restrictions:</p>

<p>
<a id="pgfId-1011279"></a></p>
<table class="webflareTable" id="#id1011283">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1011285">
<a id="pgfId-1011285"></a>Aspect</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1011287">
<a id="pgfId-1011287"></a>Restriction</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1011289"></a>Number of arguments</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1011291"></a>The methods of a generic function can have additonal <code>@optional</code> arguments.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1011293"></a><code>@rest</code> arguments</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1011295"></a>All methods of a generic function must take <code>@rest</code> arguments if any of the methods take <code>@rest</code> arguments.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1011340"></a>Keyword arguments</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1011352"></a>Each method of a generic function must </p>

<ul><li>
<a id="pgfId-1011353"></a>Take <code>@rest</code> arguments if any of the methods take @rest arguments </li><li>
<a id="pgfId-1011354"></a>Allow a superset of the keyword arguments specified in the <code>defgeneric</code> declaration </li></ul>


<p>
<a id="pgfId-1020246"></a><code>@rest</code> picks up all keyword arguments that have no matching keyword in the formal argument list. Different methods may have different default forms for the optional arguments and may accept different set of keywords.</p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-1008482"></a>Example</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1020278"></a>(defmethod test ((x class1) (y class2) @key a @rest _rest) ... )<br />(defmethod test ((x class3) (y class2) @key b @rest _rest) ... )<br />(defmethod test ((x class1) y @rest _rest) ... )<br />(defmethod test (x y @rest _rest) ... )</pre>

<p>
<a id="pgfId-1020321"></a>In the example above, the method <code>test()</code> can be called with or without <code>@key</code> arguments, provided at least two required arguments are passed to <code>test()</code>.</p>

<h3>
<a id="pgfId-1020260"></a><a id="97863"></a>Applying a Generic Function</h3>

<p>
<a id="pgfId-1008483"></a>When you apply a generic function to some arguments, the SKILL++ Object System performs the following <a id="marker-1008484"></a>actions to complete the function call. This process is called <em>method dispatching</em><a id="marker-1011419"></a>. The SKILL++ Object System</p>

<ol><li>
<a id="pgfId-1008486"></a>Retrieves the methods of the generic function.</li><li>
<a id="pgfId-1008487"></a>Determines the class of the first argument to the generic function.<br />
<a id="pgfId-1010076"></a>Based on the class of the first argument passed to the generic function, the SKILL++ Object System finds<ul><li>
<a id="pgfId-1008488"></a>No applicable methods<br />
<a id="pgfId-1010080"></a>SKILL++ Object System calls the default method for the generic function if one exists. Otherwise it signals an error.</li><li>
<a id="pgfId-1008489"></a>Only one applicable method </li><li>
<a id="pgfId-1008490"></a>More than one applicable method <br />
<a id="pgfId-1010081"></a>This situation occurs when you have methods specialized on one or more superclasses of the first argument&#8217;s class.</li></ul></li><li>
<a id="pgfId-1008491"></a>Determines applicable methods by examining the method&#8217;s class specializer.<br />
<a id="pgfId-1011438"></a>A method is applicable if it specialized on the class of the first argument or a superclass of the class of the first argument. </li><li>
<a id="pgfId-1008492"></a>Sorts the applicable methods according to the chain of superclasses of the first argument&#8217;s class.<ul><li>
<a id="pgfId-1008493"></a>The first method in the ordering is the most specific method.</li><li>
<a id="pgfId-1008494"></a>The last method in the ordering is the least specific method.</li></ul></li><li>
<a id="pgfId-1008495"></a>Calls the first method.</li></ol>






















<p>
<a id="pgfId-1011445"></a>You can invoke the <code>callNextMethod</code> function from within a method to access the next applicable method in the ordering. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008497"></a>defgeneric( describe (obj) ())<br />defclass( GeometricObject () () ) ; no slots or superclasses<br />
defclass( Point
&#160;&#160;  ( GeometricObject )<br />    ( <br />        ( name      @initarg name )<br />        ( x         @initarg x );;; x-coordinate<br />        ( y         @initarg y );;; y-coordinate<br />        )<br />    ) ; defclass<br />
defmethod( describe (( object GeometricObject ))
&#160;&#160;  className( classOf( object ))<br />    ) ; defmethod<br />
defmethod( describe (( p Point ))
&#160;&#160;  sprintf( nil &quot;%s %s @ %n:%n&quot; <br />        callNextMethod( p )<br />        p-&gt;name<br />        p-&gt;x<br />        p-&gt;y<br />        )<br />    ) ; the most specific method<br />
aPoint = makeInstance( &#39;Point ?name &quot;A&quot; ?x 1 ?y 0 )
describe( aPoint ) 
&#160;&#160;  =&gt; &quot;Point A @ 1:0&quot;</pre>

<p>
<a id="pgfId-1008498"></a>In the example, the <code>describe</code> generic function has two methods that are applicable to the argument <code>aPoint</code>:</p>
<ul><li>
<a id="pgfId-1008499"></a>The method specialized on the <code>Point</code> class </li><li>
<a id="pgfId-1008500"></a>The method specialized on the <code>GeometricObject</code> class </li></ul>

<p>
<a id="pgfId-1008501"></a>The method specializing on the <code>Point</code> class is the more specific method, therefore the SKILL++ Object System applies the most specific method to the argument.</p>

<h3>
<a id="pgfId-1008502"></a><a id="94240"></a>Incremental Development<a id="marker-1011503"></a></h3>

<p>
<a id="pgfId-1008504"></a>In the SKILL++ environment , you can redefine SKILL++ functions incrementally. You should observe the following guidelines when redefining SKILL++ Object System elements of your application:</p>
<ul><li>
<a id="pgfId-1008505"></a>Redefining methods<br />
<a id="pgfId-1008506"></a>During development, you can expect to redefine methods about as frequently as you redefine procedures. You can redefine a method as long as the redefined method&#8217;s argument list continues to conform to the generic function.</li><li>
<a id="pgfId-1008507"></a>Redefining generic functions<br />
<a id="pgfId-1008508"></a>You need to redefine a generic function to change the generic function&#8217;s default method or argument list. Such need occurs infrequently. When you redefine a generic function, the SKILL++ Object System discards all existing methods for the generic function. </li><li>
<a id="pgfId-1008509"></a>Redefining classes<br />
<a id="pgfId-1008510"></a>You need to redefine a class when you want to <ul><li>
<a id="pgfId-1008511"></a>Change the superclass </li><li>
<a id="pgfId-1008512"></a>Add or remove a slot </li><li>
<a id="pgfId-1008513"></a>Add or remove a slot option </li></ul><br />
<a id="pgfId-1008514"></a>If you need to redefine a class, you should exit the SKILL++ environment and reload you application. A frequent need to redefine classes probably indicates that you should analyze your application before further programming.</li></ul>










<h3>
<a id="pgfId-1008515"></a><a id="47665"></a>Methods and Slots</h3>

<p>
<a id="pgfId-1008517"></a>Methods are <a id="marker-1008516"></a>usually more expensive to use compared to slots but they offer data hiding and safety. Consider whether the <code>Triangle</code>&#8217;s <code>Area</code> method should access a slot containing the (precomputed) area or whether the area should be computed. The nature of your application dictates your final decision. </p>
<p>
<a id="pgfId-1008518"></a>Computing the area may be costly if, for example, the area of triangles is used often. In such a situation, it would be more advantageous to add a slot for area to the triangle class. But then we would have to add @writer methods for the sides of a triangle to recalculate the area when the length of a side changes. </p>

<h3>
<a id="pgfId-1008519"></a><a id="14351"></a>Sharing Private Functions and Data Between Methods</h3>

<p>
<a id="pgfId-1008521"></a>Using lexical scoping <a id="marker-1008520"></a>with the SKILL++ Object System allows all methods specialized on a class to <a id="marker-1008522"></a>share private functions and data.</p>
<p>
<a id="pgfId-1008523"></a>The methods for a class might need access to data, such as an association table, that is shared between all instances of the class. Slots you specify in the <code>defclass</code><a id="marker-1008524"></a> declaration are allocated within each instance of the class. </p>
<p>
<a id="pgfId-1008525"></a>The methods for a class might all rely on certain helper functions which you need to make private.</p>
<p>
<a id="pgfId-1008526"></a>Using the following template as a guide achieves both goals.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1008527"></a>defgeneric( Fun1 ( obj &#8230; ) &#8230; )<br />defgeneric( Fun2 ( obj &#8230; ) &#8230; )<br />defclass( Example ( &#8230; ) ( &#8230; ))<br />let( <br />    (<br />        ( classVar1 &#8230; )              ;data shared between all<br />        ( classVar2 &#8230; ) &#8230;. )       ;instances of the class<br />        )<br />    procedure( HelpFun1( &#8230;. ) ;private helper functions<br />    procedure( HelpFun2( &#8230;. )<br />    &#8230;<br />    defmethod( Fun1 (( obj Example) &#8230;. )<br />    defmethod( Fun2 (( obj Example ) &#8230; )<br />    &#8230;.<br />    ) ; let</pre>
<h3>
<a id="pgfId-1022230"></a><a id="72054"></a>Using Custom Specializers in SKILL++ Methods </h3>

<p>
<a id="pgfId-1022290"></a>In the SKILL++ object system you can define generic functions which are a collection of methods specialized on the class of one or more arguments passed to the generic function. This allows you to simply implement polymorphism in SKILL - in other words you can have multiple implementations of the same function which are focused on different objects, and this can make the code easier to maintain and develop as it avoids having to have a large cond or case function call within your code to switch between different objects; in addition the method dispatch will call the most applicable method first, with potentially that method being able to call the next most applicable method and so on.</p>
<p>
<a id="pgfId-1022291"></a>The basic approach allows you to specialize on the class of the object passed to the function. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022293"></a>defgeneric(CCScomputeArea (obj) error(&quot;Unrecognized object %L\n&quot; obj)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022294"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022296"></a>defmethod(CCScomputeArea ((obj CCSrect))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022297"></a>; calculate area of a rectangle object</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022298"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022299"></a>defmethod(CCScomputeArea ((obj CCScircle))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022300"></a>; calculate area of a circle</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022301"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022302"></a>defmethod(CCScolor ((obj CCSshape))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022303"></a>; return the color of a shape (CCSrect and CCScircle are subclasses of CCSshape)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022304"></a>)</pre>

<p>
<a id="pgfId-1022305"></a>The CCSshape, CCScircle, and CCSrect are class names here that would have been defined elsewhere. This is an incomplete example just showing the methods so as to show the principle.</p>
<p>
<a id="pgfId-1022307"></a>Sometimes you might have an object but want to further distinguish which method to call based on the value of a slot of that object. You can then use method dispatch to separately perform some work based on a slot or attribute value. One example might be that you have a database object (dbobject) in Virtuoso, which could represent a figure in the design (e.g. an instance, or a shape of some sort). The dbobjects in Virtuoso do have distinct objects for each kind of object - the objType attribute specifies whether the object is a &quot;rect&quot;, a &quot;path&quot;, a &quot;net&quot;, a &quot;cellView&quot; and so on. However, because these are not instances of SKILL++ classes, there is limited ability to write methods specializing on those specific objects. You can write a method using a class name corresponding to the type of the object:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022309"></a>defmethod(CCScomputeArea ((obj dbobject))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022310"></a>; handle all the different kinds of database object within this method and compute the area appropriately</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022311"></a>)</pre>

<p>
<a id="pgfId-1022312"></a>Normally, you cannot further refine the method to specialize on the object solely if it is a rect, or solely if it is a pathSeg, for example. This is because there are no subclasses of dbobject and so, bydefault, you cannot specialize on the objType of the database object.</p>
<p>
<a id="pgfId-1022314"></a>What you would like to do is to use polymorphism to specialize on the objType of the database object in order to compute the area and perimeter of a variety of figure types.</p>

<h4>
<a id="pgfId-1022282"></a>Introduction</h4>

<p>
<a id="pgfId-1022467"></a>In addition to specializing on classes, SKILL++ allows specializing either on the value of a basic type, using the built-in eqv specializer, or by defining custom specializers to match specific objects. In order to enable these custom specializers, it is necessary to define a class plus three different methods to support the capability.</p>
<p>
<a id="pgfId-1022469"></a>Before using custom specializers, you should consider whether this is the right mechanism for what you are trying to achieve. The danger is that you can end up hiding the logic of your program in the method dispatch, and ending up with methods specialized on particular values distributed across multiple files and this can make it hard to understand the flow of the program. You may be better off using a case or cond function within your code to group all the logic about different values in one place. One of the key benefits of declaring a method specialized on a class (the standard mechanism) is that the method also applies to subclasses too, unless a more specific method is defined. With custom specializers, the method can only be applied to specific matching instances, and if your custom specializers are complex they can end up with an order dependency which is very hard to reason about. It is possible to resolve any order dependency by defining the ilSpecMoreSpecificp method to determine the order, but again this adds additional complexity which may be unobvious to a reader of the code (this article does not use ilSpecMoreSpecificp).</p>

<h4>
<a id="pgfId-1022470"></a>Defining Methods Using Non-class Specializers</h4>

<p>
<a id="pgfId-1022472"></a>First of all, let us describe how you would declare a method using these specializers. As was seen above, the argument for a method normally is of the form (obj className) to make it specific to an instance of that class (or any of the children of that class). In order to use the custom specializers (or the eqv specializer), you would use the form (obj (specializerSymbol arg1 [arg2 ... argN])). The specializer symbol can be either eqv or one you define yourself - as will be outlined below. If eqv is used, then a single argument is given, and then the object will be matched against that value. So for example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022474"></a>defmethod(CCStranslate ((str string)) strcat(&quot;EN: &quot; str)) defmethod(CCStranslate ((str (eqv &quot;hello&quot;))) &quot;bonjour&quot;) CCStranslate(&quot;goodbye&quot;) =&gt; &quot;EN: goodbye&quot; CCStranslate(&quot;hello&quot;) =&gt; &quot;bonjour&quot;</pre>

<p>
<a id="pgfId-1022475"></a>With the eqv specializer, it only makes sense to give a single argument (the other arguments are ignored), but with custom specializers you can specify multiple arguments to aid the specificity of the match. Note that with the eqv specializer, the argument is evaluated when the defmethod is defined (and so you must quote symbols if the argument is a symbol), but for custom specializers they are unevaluated and can only be literal values.</p>

<h4>
<a id="pgfId-1022476"></a>Using Custom Specializers With defmethod</h4>

<p>
<a id="pgfId-1022477"></a>For custom specializers, you need to define a class that is used to compare an argument to see if it matches the specializer, plus three methods: ilGenerateSpecializer, ilEquivalentSpecializers and ilArgMatchesSpecializer. The following example shows how this is done for a specializer designed to match the objType of the database object. This means that you can then use methods similar to the one given below:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022479"></a>defmethod(abFigArea ((obj (abDbFig &quot;rect&quot;))) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022804"></a> abAreaOfBBox(obj~&gt;bBox)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022480"></a>)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022482"></a>defmethod(abFigArea ((obj (abDbFig &quot;donut&quot;))) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022818"></a> let((inner outer) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022483"></a> outer=abFigMaths.PI*obj~&gt;outerRadius**2  inner=abFigMaths.PI*obj~&gt;innerRadius**2 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022831"></a> outer-inner</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022484"></a> )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022485"></a>)</pre>
<h4>
<a id="pgfId-1022486"></a>Defining a class for the specializer</h4>

<p>
<a id="pgfId-1022488"></a>In this case, the symbol abDbFig has been used for the specializer. The ilGenerateSpecializer method takes care of recognizing this symbol and generating an instance of the specializer class. The specializer class in this case is defined as follows:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022490"></a>defclass(abDbFigSpecializer () </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022880"></a> (</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022491"></a> (objType @initarg objType)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022492"></a> )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022493"></a>)</pre>

<p>
<a id="pgfId-1022495"></a>The objType slot in the class is used to store the value of objType that the method is trying to match against.</p>

<h4><em>
<a id="pgfId-1022497"></a>ilGenerateSpecializer</em></h4>

<p>
<a id="pgfId-1022499"></a>The ilGenerateSpecializer method is called whenever a custom specializer is used in a <code>defmethod</code> as in the above example. It can either return the code (the SKILL expression) needed to generate the instance, or can directly return the instance of the specializer class. Three arguments are specified for it: </p>
<p>
<a id="pgfId-1022938"></a>ilGenerateSpecializer(g_genericFunctionObj s_specSymbol l_argList)</p>

<body-text id="#id1022973">
<a id="pgfId-1022973"></a>
<table class="webflareTable" id="#id1025229">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1023045">
<a id="pgfId-1023045"></a>Argument</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1023047">
<a id="pgfId-1023047"></a>Description</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023049"></a><code>g_genericFunctionObj </code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023051"></a>An instance of the <code>ilGenericFunction</code> class or a proxy class derived from it. Using proxy classes is one way of associating custom specializers with generic functions. The SKILL Language User Guide describes how to define proxy classes to define a group of generic functions to use common specializers. A cut-down example of using a proxy class is given at the bottom of this article to compare with the preferred method.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023053"></a><code>s_specSymbol</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023435"></a>The symbol used as the first entry in <code>defmethod</code> to trigger the custom specializer (<code>abDbId</code> in the example above). Note that this does not strictly need to be a symbol. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023057"></a><code>l_argList</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023059"></a>The remaining arguments to the specializer - (&quot;rect&quot;) in the example above. If more than one argument is given, this is a list of all the arguments.</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1023472"></a>An example of ilGenerateSpecializer using an <code>eqv</code> specializer to match the expected symbol. Since the generic function object is not used, it is prefixed with an underscore to prevent any impact on the SKILL Lint score and to indicate that it is unused.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022510"></a>defmethod(ilGenerateSpecializer (_gf (_spec (eqv &#39;abDbFig)) args) makeInstance(&#39;abDbFigSpecializer ?objType car(args))</pre>

<p>
<a id="pgfId-1022527"></a>Another way of implementing this is to return the code needed to generate the instance:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022529"></a>defmethod(ilGenerateSpecializer (_gf (_spec (eqv &#39;abDbFig)) args)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022530"></a>`makeInstance(&#39;abDbFigSpecializer ?objType ,car(args))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022531"></a>)</pre>
<h4><em>
<a id="pgfId-1022533"></a>ilEquivalentSpecializer</em></h4>

<p>
<a id="pgfId-1022535"></a>The ilEquivalentSpecializer method is called whenever more than one method is defined for a generic function. It is intended to identify when identical custom specializers have been specified in the case of method redefinition, so that the new method replaces the previously defined one, rather than adding a new method. Having two methods with identical specializers would lead to errors during dispatch, which is why this method must be defined. The arguments signature is:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1024587"></a>ilEquivalentSpecializer(g_genericFunctionObj g_SpecObj1 g_specObj2j)</pre>

<p>
<a id="pgfId-1024597"></a></p>
<table class="webflareTable" id="#id1023886">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1023609">
<a id="pgfId-1023609"></a>Argument</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1023611">
<a id="pgfId-1023611"></a>Description</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023613"></a><code>g_genericFunctionObj </code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023615"></a>An instance of the ilGenericFunction class or a proxy class derived from it. (See ilGenerateSpecializer above)</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023618"></a><code>g_specObj1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023620"></a>An instance of the specializer class to be compared.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023622"></a><code>g_specObj2</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1023624"></a>The second instance of the specializer class to be compared</p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1022565"></a>An example of ilEquivalentSpecializer to compare that the <code>objType</code> is identical for two instances, needed for method redefinition:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022567"></a>defmethod(ilEquivalentSpecializers (_gf (spec1 abDbFigSpecializer) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1023924"></a> (spec2 abDbFigSpecializer))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022568"></a>spec1-&gt;objType==spec2-&gt;objType</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022569"></a>)</pre>
<h4><em>
<a id="pgfId-1022571"></a>ilArgMatchesSpecializer</em></h4>

<p>
<a id="pgfId-1022573"></a>Finally the ilArgMatchesSpecializer method is needed to determine whether a argument passed to the generic function at run time matches a particular specializer class, so that it then knows which method should be called. This has this argument signature ilArgMatchesSpecializer.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022574"></a>(g_genericFuncObj g_specObj g_argument)</pre>

<p>
<a id="pgfId-1023989"></a></p>
<table class="webflareTable" id="#id1023997">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1023999">
<a id="pgfId-1023999"></a>Argument</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1024001">
<a id="pgfId-1024001"></a>Description</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1024003"></a><code>g_genericFunctionObj </code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1024005"></a>An instance of the ilGenericFunction class or a proxy class derived from it. (See ilGenerateSpecializer above)</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1024007"></a><code>g_specObj</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1024009"></a>An instance of the specializer class being compared against.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1024011"></a><code>g_argument</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1024013"></a>The argument to the method that is being compared.</p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1022608"></a>The method should check the type/class of the argument being compared to prevent errors if a candidate argument doesn&#39;t have the slots being accessed within the ilArgMatchesSpecializer. This could be done by adding a class specializer on the third argument, or including the type/class check as part of the check within the method itself.</p>
<p>
<a id="pgfId-1025419"></a>For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1022459"></a>defmethod(ilArgMatchesSpecializer (_gf (spec abDbFigSpecializer) (arg dbobject)) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1024149"></a> spec-&gt;objType==arg-&gt;objType</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1024139"></a>)</pre>
<br /><a href="#pagetop">Return to top</a><br /></body-text></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="chap15.html" id="prev" title="Using SKILL and SKILL++ Together">Using SKILL and SKILL++ Togeth ...</a></em></b><b><em><a href="chap17.html" id="nex" title="Programming Examples">Programming Examples</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160; </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>