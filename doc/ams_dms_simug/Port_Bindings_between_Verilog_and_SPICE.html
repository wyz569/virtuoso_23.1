
<html><head><title>Port Bindings between Verilog and SPICE</title>
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="shubh" />
<meta name="CreateDate" content="2023-03-01" />
<meta name="CreateTime" content="1677668969" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the Virtuoso AMS Designer simulator and Xcelium Simulator with mixed-signal option that supports the Verilog-AMS,  VHDL-AMS, and SystemVerilog-AMS language standards." />
<meta name="DocTitle" content="Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Port Bindings between Verilog and SPICE" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="concept" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="Analog Mixed-Signal,Analog Mixed-Signal,Analog Mixed-Signal,Spectre AMS Designer,Spectre AMS Designer,Spectre AMS Designer," />
<meta name="prod_subfeature" content="Binding,SPICE,Verilog-AMS,Binding, SPICE, Verilog-AMS," />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="" />
<meta name="FileType" content="Chapter" />
<meta name="Keyword" content="ams_dms_simug" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-03-01" />
<meta name="ModifiedTime" content="1677668969" />
<meta name="NextFile" content="Customized_Port-Bind_Files.html" />
<meta name="Group" content="Mixed-Signal Simulation" />
<meta name="Platform" content="Functional Verification," />
<meta name="PrevFile" content="Run_Script_for_xrun.html" />
<meta name="c_product" content="Xcelium," />
<meta name="Product" content="Xcelium," />
<meta name="ProductFamily" content="Xcelium," />
<meta name="ProductVersion" content="22.09" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide -- Port Bindings between Verilog and SPICE" />
<meta name="Version" content="22.09" />
<meta name="Renderer" content="WIKI" />
<meta name="SpaceKey" content="amssimug2209" />
<meta name="confluence-version" content="7.4.1" />
<meta name="ecms-plugin-version" content="04.10.026" />

        
        <link href="styles/site.css" rel="stylesheet" type="text/css" />
        <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
    

    
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    document.querySelectorAll("img").forEach((img, index) => {
   img.addEventListener("click", (e) => { 
    document.querySelector("#cad_image_modal").classList.add("opac");
      document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0; margin: auto;max-height: 96%;max-width: 96%;" src="${e.target.src}">`;});});});
</script>

<style>
 img{cursor:pointer;
 }
 #cad_image_modal{
 position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;
 }
 #cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;
 }
 #cad_image_modal span{
  position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;
 }
 </style>

</head><body style="background-color: #FFFFFF;"><!-- Begin Buttons --><header xmlns:html="http://www.w3.org/1999/xhtml"><div class="docHeadr">Product Documentation<img src="images/Cadence-Logo.jpg" /></div>
<nav class="blueHead"><ul><li><a class="content" href="ams_dms_simugTOC.html">Contents</a></li><li><a class="prev" href="Run_Script_for_xrun.html" title="Run_Script_for_xrun">Run_Script_for_xrun</a></li><li style="float: right;"><a class="viewPrint" href="ams_dms_simug.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="Customized_Port-Bind_Files.html" title="Customized_Port-Bind_Files">Customized_Port-Bind_Files</a></li></ul></nav></header><!-- End Buttons --><div xmlns:html="http://www.w3.org/1999/xhtml" style="font-size:14px;line-height:1.42857142857;margin:20px 0 0 0;font-weight:bold;"><center>Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide<br />Product Version 22.09, September 2022</center></div>
<div xmlns:html="http://www.w3.org/1999/xhtml" style="margin-left:5%;">
<p></p>

<p></p>
<div id="main-header">
                    
                    
                                                <h1 style="margin: 4px 0 4px;"><span>Port Bindings between Verilog and SPICE</span></h1>

                    
                </div>
<div class="wiki-content group" id="main-content">
                    
<p>Port-binding considerations include case mapping and bus connections between Verilog and SPICE. The following guidelines can help you choose which method to use for your design requirements:</p>
<div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col /><col /></colgroup><thead><tr><th class="confluenceTh" style="text-align: left;">
<p>Design Requirements</p>
</th><th class="confluenceTh" style="text-align: left;">
<p>Port-Binding Method</p>
</th></tr>
</thead><tbody><tr><td class="confluenceTd" style="text-align: left;">
<p>All buses have uniform ascending/descending port order and all ports have uniform case mapping</p>
</td>
<td class="confluenceTd" style="text-align: left;">
<p><a href="portmap.html#portmap-autobus">autobus</a></p>
</td>
</tr>
<tr><td class="confluenceTd" style="text-align: left;">
<p>Customized port binding requirements</p>
</td>
<td class="confluenceTd" style="text-align: left;">
<p><a href="Customized_Port-Bind_Files.html">port-bind file</a></p>
</td>
</tr>
<tr><td class="confluenceTd" style="text-align: left;">
<p>You have a Verilog version of a SPICE block</p>
</td>
<td class="confluenceTd" style="text-align: left;">
<p><a href="portmap.html">portmap</a>&#160;<a href="portmap.html#portmap-reffile">reffile</a></p>
</td>
</tr>
<tr><td class="confluenceTd" style="text-align: left;">
<p>You need to bind ports by name, rather than by order</p>
</td>
<td class="confluenceTd" style="text-align: left;">
<p><a href="portmap.html">portmap</a><a href="portmap.html#portmap-porttype">&#160;porttype</a></p>
</td>
</tr>
</tbody></table></div>
<h3 id="PortBindingsbetweenVerilogandSPICE-BindingPortsusingautobus">Binding Ports using autobus<span class="confluence-anchor-link conf-macro output-inline"><span>&#160;</span></span>&#160;</h3>

<p>To bind Verilog to SPICE ports using<span>&#160;</span><code>autobus</code>, do the following:</p>
<ol><li>Use an include statement to include the SPICE design file:<br /><code>include </code>&quot;<code>analog_top.sp</code>&quot;</li><li>
<p>Use&#160;<code>portmap</code><span>&#160;</span>&#160;and&#160;<span>&#160;</span><code>config</code>&#160;cards in the<code><span>&#160;</span>amsd<span>&#160;</span></code>block to specify the SPICE file and subcircuits that you have instantiated in Verilog modules:<br /><code>amsd{</code><br /><code>&#160;&#160;&#160;&#160;portmap subckt=analog_top autobus=yes busdelim=&quot;&lt;&gt;&quot;</code><br /><code>&#160;&#160;&#160;&#160;config cell=analog_top use=spice</code><br /><code>&#160;&#160;&#160;&#160;}</code></p>

<p>The default value for&#160;<code>autobus</code>&#160;on the<code>&#160;portmap&#160;</code>statement is<code>&#160;yes.</code></p>
</li><li>Specify the AMS control file directly on the<span>&#160;</span><code>xrun</code><span>&#160;</span>&#160;command line:<br /><code>xrun ... amsdcb.scs</code></li></ol>
<p>Here is an example. The top module,<span>&#160;</span><code>testbench</code>, instantiates one SPICE block,<code><span>&#160;</span>pll_top</code>:</p>
<div class="table-wrap"><table class="wrapped confluenceTable" style="text-align: left;"><colgroup><col /></colgroup><tbody style="text-align: left;"><tr style="text-align: left;"><td class="confluenceTd" style="text-align: left;"><p style="text-align: left;"><code class="java plain" style="text-align: left;">module testbench ();</code><br /><code class="java plain" style="text-align: left;">reg myRESET;</code><br /><code class="java plain" style="text-align: left;">reg refclk;</code><br /><code class="java plain" style="text-align: left;">wire [</code><code class="java value" style="text-align: left;">1</code><code class="java plain" style="text-align: left;">:</code><code class="java value" style="text-align: left;">0</code><code class="java plain" style="text-align: left;">] clk_out;</code><br /><code class="java plain" style="text-align: left;">.....</code><br /><code class="java plain" style="text-align: left;">pll_top p1(refclk, myRESET, clk_out);</code><br /><code class="java plain" style="text-align: left;">endmodule</code><br />&#160;<br /><code class="java comments" style="text-align: left;">//The SPICE subcircuit definition looks like this:</code><br />&#160;<br /><code class="java plain" style="text-align: left;">.subckt pll_top refclk reset P0_CLK[</code><code class="java value" style="text-align: left;">1</code><code class="java plain" style="text-align: left;">] P0_CLK[</code><code class="java value" style="text-align: left;">0</code><code class="java plain" style="text-align: left;">]</code><br /><code class="java plain" style="text-align: left;">...</code><br /><code class="java plain" style="text-align: left;">.ends pll_top</code><br />&#160;<br /><code class="java comments" style="text-align: left;">//You specify autobus port binding using the SPICE pll_top subcircuit in the amsd block as follows:</code><br />&#160;<br /><code class="java plain" style="text-align: left;">amsd{</code><br /><code class="java spaces" style="text-align: left;">&#160;&#160;&#160;&#160;</code><code class="java plain" style="text-align: left;">portmap subckt=pll_top autobus=yes</code><br /><code class="java spaces" style="text-align: left;">&#160;&#160;&#160;&#160;</code><code class="java plain" style="text-align: left;">config cell=pll_top use=spice</code><br /><code class="java spaces" style="text-align: left;">&#160;&#160;&#160;&#160;</code><code class="java plain" style="text-align: left;">...</code><br /><code class="java spaces" style="text-align: left;">&#160;&#160;&#160;&#160;&#160;</code><code class="java plain" style="text-align: left;">}</code><br />&#160;<br /><code class="java comments" style="text-align: left;">//The elaborator generates the following port-bind file:</code><br />&#160;<br /><code class="java comments" style="text-align: left;">//</code><br /><code class="java comments" style="text-align: left;">//portmap file for spice subckt pll_top</code><br /><code class="java plain" style="text-align: left;">refclk&#160;&#160;:&#160;&#160;&#160;&#160;&#160;&#160;&#160;refclk&#160;&#160;dir=inout</code><br /><code class="java plain" style="text-align: left;">reset&#160;&#160;&#160;:&#160;&#160;&#160;&#160;&#160;&#160;&#160;reset&#160;&#160;&#160;dir=inout</code><br /><code class="java plain" style="text-align: left;">{ P0_CLK[</code><code class="java value" style="text-align: left;">1</code><code class="java plain" style="text-align: left;">], P0_CLK[</code><code class="java value" style="text-align: left;">0</code><code class="java plain" style="text-align: left;">] }&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;:&#160;&#160;&#160;&#160;&#160;&#160;&#160;P0_CLK[</code><code class="java value" style="text-align: left;">1</code><code class="java plain" style="text-align: left;">:</code><code class="java value" style="text-align: left;">0</code><code class="java plain" style="text-align: left;">]&#160;&#160;&#160;&#160;&#160;dir=inout</code></p>
</td>
</tr>
</tbody></table></div>

<p>The<code>&#160;SPICEname&#160;</code>identifiers (on the left side of the colon) come from the SPICE subcircuit definition (such as<code>&#160;.subckt pll_top refclk reset P0_CLK[1] P0_CLK[0]</code>).&#160;</p>

<p><span style="">The</span><span>&#160;</span><code>VerilogName<span>&#160;</span></code><span style="">identifiers (on the right side of the colon) represent the port names of the Verilog module that the software generates internally. These port names can be different from the actual interface signal names in the instantiation in the top-level testbench module. In this example, for instance, the interface signal names are</span><span>&#160;</span><code>refclk</code><span>&#160;</span><span style="">,</span><span>&#160;</span><code>myRESET</code><span>&#160;</span><span style="">, and</span><span>&#160;</span><code>clk_out</code><span>&#160;</span><span style="">, while the port names in the port-bind file are</span><span>&#160;</span><code>refclk</code><span>&#160;</span><span style="">,</span><span>&#160;</span><code>reset</code><span>&#160;</span><span style="">,</span><span>&#160;</span><code>P0_CLK[1]</code><span>&#160;</span><span style="">, and</span><span>&#160;</span><code>P0_CLK[0].</code><span>&#160;</span></p>

<p>You should change the port directions to match your design requirements (<code><span>&#160;</span>dir=inout<span>&#160;</span></code>is the default direction setting for SPICE ports).</p>

<p>The software maps<code><span>&#160;</span>P0_CLK[1]<span>&#160;</span></code>and<code><span>&#160;</span>P0_CLK[0]<span>&#160;</span></code>into a bus because<code><span>&#160;</span>[]<span>&#160;</span></code>is the default bus delimiter.</p>
<h3 id="PortBindingsbetweenVerilogandSPICE-BindingPortsusingaPort-BindFile">Binding Ports using a Port-Bind File</h3>

<p>Some designs require customized port binding, such as mixed-case mapping, more complicated bus forms such as those that include concatenations, and mixed ascending and descending bus orders. You can use a<span>&#160;</span>port-bind file<span>&#160;</span>to specify your customized port binding requirements.&#160;</p>

<p>You can use autobus to generate the initial port-bind file (<code>.pb</code>) automatically, then you can&#160;customize the mappings&#160;in that file. The general steps you can follow are:</p>
<ol><li>Use autobus to generate the initial port-bind file (<code>.pb</code>).</li><li>Customize port mappings in the initial port-bind file.</li><li>Use<code><span>&#160;</span>portmap &#8230; file=<span>&#160;</span></code>to specify the port-bind file you customized.<br /><code>include &quot;analog_top.sp&quot;</code><br /><code>amsd{</code><br /><code>&#160;&#160;&#160;&#160;portmap subckt=analog_top file=&quot;analog_top.pb&quot;</code><br /><code>&#160;&#160;&#160;&#160;config cell=analog_top use=spice</code><br /><code>&#160;&#160;&#160;&#160;}</code></li></ol><h3 id="PortBindingsbetweenVerilogandSPICE-BindingPortsusingaVerilogFile">Binding Ports using a Verilog File<span class="confluence-anchor-link conf-macro output-inline"><span>&#160;</span></span>&#160;<span class="confluence-anchor-link conf-macro output-inline"><span>&#160;</span></span>&#160;</h3>

<p>If your design contains units for which you have both a Verilog and a SPICE version, you can use a Verilog file to specify your binding options. Perhaps you simulate a purely digital version of your design first, and then selectively replace some blocks with a SPICE version.</p>

<p>You can specify a file containing a Verilog module that defines the port mappings to use from a Verilog parent to a SPICE subcircuit instance using&#160;<code>portmap reffile</code>&#160;in your AMS control file. This approach lets you replace the interface of a subcircuit with that of a Verilog module.</p>

<p>For example:</p>

<p><code>include &quot;analog_top.sp&quot;<br />amsd{<br />&#160;&#160;&#160;&#160; portmap subckt=analog_top reffile=&quot;analog_top.v&quot; refformat=verilog<br />&#160;&#160;&#160;&#160; config cell=analog_top use=spice<br />&#160;&#160;&#160;&#160;}</code></p>

<p>In this example,<code><span>&#160;</span>analog_top.v<span>&#160;</span></code>is the Verilog file that contains the port binding information your design requires. The software applies port bindings (interfaces) defined in<code><span>&#160;</span>analog_top.v<span>&#160;</span></code>to instances of<code><span>&#160;</span>analog_top.</code><span>&#160;</span>While the elaborator uses the port bindings you define for<code><span>&#160;</span>analog_top<span>&#160;</span></code>in<code><span>&#160;</span>analog_top.v<span>&#160;</span></code>to determine how to connect instances of<code><span>&#160;</span>analog_top</code>, the simulator simulates the<code><span>&#160;</span>analog_top<span>&#160;</span></code>subcircuit you define in<code><span>&#160;</span>analog_top.sp.</code></p>

<p>For example,<span>&#160;</span><code>analog_top.v&#160;</code><span>&#160;</span>might contain the following:</p>

<p><br /></p>
<div class="table-wrap"><table class="wrapped confluenceTable" style="text-align: left;"><colgroup><col /></colgroup><tbody style="text-align: left;"><tr style="text-align: left;"><td class="confluenceTd" style="text-align: left;"><p style="text-align: left;"><code class="java plain" style="text-align: left;">module analog_top (in1, itune, in2);</code><br /><code class="java plain" style="text-align: left;">inout in1;</code><br /><code class="java plain" style="text-align: left;">inout [</code><code class="java value" style="text-align: left;">0</code><code class="java plain" style="text-align: left;">:</code><code class="java value" style="text-align: left;">1</code><code class="java plain" style="text-align: left;">] itune;</code><br /><code class="java plain" style="text-align: left;">inout in2;</code><br />&#160;<br /><code class="java plain" style="text-align: left;">analog beginend</code><br /><code class="java plain" style="text-align: left;">end</code><br /><code class="java plain" style="text-align: left;">module</code><br />&#160;<br /><code class="java comments" style="text-align: left;">//The analog_top subcircuit in analog_top.sp might look like this:</code><br />&#160;<br /><code class="java plain" style="text-align: left;">.subckt analog_top</code><br /><code class="java plain" style="text-align: left;">+ in1 itune[</code><code class="java value" style="text-align: left;">0</code><code class="java plain" style="text-align: left;">] itune[</code><code class="java value" style="text-align: left;">1</code><code class="java plain" style="text-align: left;">] in2</code><br />&#160;<br /><code class="java plain" style="text-align: left;">...</code><br /><code class="java plain" style="text-align: left;">.ends analog_top</code><br />&#160;<br /><code class="java comments" style="text-align: left;">//When you instantiate a subcircuit called analog_top in module top like this:</code><br />&#160;<br /><code class="java plain" style="text-align: left;">module top (ext_clk, pll_clk);</code><br /><code class="java plain" style="text-align: left;">input ext_clk, pll_clk;</code><br />&#160;<br /><code class="java plain" style="text-align: left;">wire [</code><code class="java value" style="text-align: left;">0</code><code class="java plain" style="text-align: left;">:</code><code class="java value" style="text-align: left;">1</code><code class="java plain" style="text-align: left;">] itune;</code><br /><code class="java plain" style="text-align: left;">wire res;</code><br />&#160;<br /><code class="java plain" style="text-align: left;">analog_top xana_top(</code><br /><code class="java plain" style="text-align: left;">.in2(pll_clk),</code><br /><code class="java plain" style="text-align: left;">.itune(itune),</code><br /><code class="java plain" style="text-align: left;">.in1(ext_clk)</code><br /><code class="java plain" style="text-align: left;">);</code><br />&#160;<br /><code class="java plain" style="text-align: left;">...</code><br /><code class="java plain" style="text-align: left;">endmodule</code></p>
</td>
</tr>
</tbody></table></div>

<p><br /></p>

<p>Binding ports by order is not recommended when the ports in the Verilog reference file and the ports in the equivalent SPICE subcircuit do not match by order. In such situations, it is recommended that you bind ports by name using the<code><span>&#160;</span>porttype=name<span>&#160;</span></code>parameter.</p>
<h3 id="PortBindingsbetweenVerilogandSPICE-BindingPortsbyName">Binding Ports by Name<span class="confluence-anchor-link conf-macro output-inline"><span>&#160;</span></span>&#160;</h3>

<p>When you need to bind the ports in your&#160;reference file&#160;by name, rather than by order, you can use the <code>porttype&#160;</code>specifier in a&#160;<code>portmap</code> statement. For example:</p>

<p><code>amsd{<br />&#160;&#160;&#160;&#160;&#160;ie vsup=1.8<br />&#160;&#160;&#160;&#160;&#160;portmap module=counter reffile=&quot;./source/digital/counter.v&quot; porttype=name<br />&#160;&#160;&#160;&#160;&#160;config cell=counter use=hdl<br />&#160;&#160;&#160;&#160;&#160;}</code></p>

<p>The software uses this specifier when automatically generating a port-bind file. The&#160;default binding mechanism is by-order (<code><span>&#160;</span>porttype=order<span>&#160;</span></code>). However, if your design consists mostly of SPICE and Verilog ports that have the same name, but with mismatched port order, you might get a more accurate port-bind file by specifying<code><span>&#160;</span>porttype=name.</code></p>

<p>If the software cannot match ports between Verilog and SPICE successfully, the elaborator writes &quot;&#160;not_found&#160;&quot; as a placeholder in the port-bind file it generates (in&#160;runDir&#160;/portmap_files). You can edit this file to change all&#160;not_found&#160;keywords to the correct Verilog port names, then use the&#160;<span><code>file</code></span><code><span>&#160;</span></code>parameter (instead of<span>&#160;</span><code>reffile<span>&#160;</span></code>and<span>&#160;</span><code>porttype</code>) in a<code><span>&#160;</span>porttype</code><span>&#160;</span>statement to specify the file you saved, and run the simulation again.</p>
<h5 id="PortBindingsbetweenVerilogandSPICE-RelatedTopics">Related Topics</h5><ul><li><a href="portmap.html#portmap-autobus">autobus</a></li><li><a href="portmap.html">portmap</a></li><li><a href="portmap.html#portmap-porttype">porttype</a><span>&#160;</span><span>&#160;</span>&#160;</li><li><a href="config.html">config</a></li><li><span>&#160;</span><a href="portmap.html#portmap-file">file</a></li><li><a href="portmap.html#portmap-reffile">reffile</a><span>&#160;</span>&#160;</li><li><a href="XRUN_Invocation_for_Mixed-Signal_Designs.html">XRUN Invocation for Mixed-Signal Designs</a></li><li><a href="Customized_Port-Bind_Files.html">Creating a Customized</a><a href="Customized_Port-Bind_Files.html"> Port-Bi</a><a href="Customized_Port-Bind_Files.html">nd</a><a href="Customized_Port-Bind_Files.html"> File</a></li><li><a href="Customized_Port-Bind_Files.html">Customized Port-Bind Files</a></li></ul>
<p><br /></p>

                    </div>
<br /><br /></div>
<footer xmlns:html="http://www.w3.org/1999/xhtml"><nav class="navigation"><b><em><a href="Run_Script_for_xrun.html" id="prev" title="Run_Script_for_xrun">Run_Script_for_xrun</a></em></b><b><em><a href="Customized_Port-Bind_Files.html" id="nex" title="Customized_Port-Bind_Files">Customized_Port-Bind_Files</a></em></b></nav><div>
          For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved.
        </div>
</footer><br xmlns:html="http://www.w3.org/1999/xhtml" />
<div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;&#10240;</center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div>

</body></html>