
<html><head><title>AMS Spectre XPS MS Mode</title>
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="shubh" />
<meta name="CreateDate" content="2023-03-01" />
<meta name="CreateTime" content="1677668963" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the Virtuoso AMS Designer simulator and Xcelium Simulator with mixed-signal option that supports the Verilog-AMS,  VHDL-AMS, and SystemVerilog-AMS language standards." />
<meta name="DocTitle" content="Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="AMS Spectre XPS MS Mode" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="concept" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="Analog Mixed-Signal,Spectre AMS Designer," />
<meta name="prod_subfeature" content="Spectre, Spectre," />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="" />
<meta name="FileType" content="Chapter" />
<meta name="Keyword" content="ams_dms_simug" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-03-01" />
<meta name="ModifiedTime" content="1677668963" />
<meta name="NextFile" content="AMS_Designer_with_Spectre_FX.html" />
<meta name="Group" content="Mixed-Signal Simulation" />
<meta name="Platform" content="Functional Verification," />
<meta name="PrevFile" content="Enabling_AMS-APS_Mode.html" />
<meta name="c_product" content="Xcelium," />
<meta name="Product" content="Xcelium," />
<meta name="ProductFamily" content="Xcelium," />
<meta name="ProductVersion" content="22.09" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide -- AMS Spectre XPS MS Mode" />
<meta name="Version" content="22.09" />
<meta name="Renderer" content="WIKI" />
<meta name="SpaceKey" content="amssimug2209" />
<meta name="confluence-version" content="7.4.1" />
<meta name="ecms-plugin-version" content="04.10.026" />

        
        <link href="styles/site.css" rel="stylesheet" type="text/css" />
        <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
    

    
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    document.querySelectorAll("img").forEach((img, index) => {
   img.addEventListener("click", (e) => { 
    document.querySelector("#cad_image_modal").classList.add("opac");
      document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0; margin: auto;max-height: 96%;max-width: 96%;" src="${e.target.src}">`;});});});
</script>

<style>
 img{cursor:pointer;
 }
 #cad_image_modal{
 position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;
 }
 #cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;
 }
 #cad_image_modal span{
  position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;
 }
 </style>

</head><body style="background-color: #FFFFFF;"><!-- Begin Buttons --><header xmlns:html="http://www.w3.org/1999/xhtml"><div class="docHeadr">Product Documentation<img src="images/Cadence-Logo.jpg" /></div>
<nav class="blueHead"><ul><li><a class="content" href="ams_dms_simugTOC.html">Contents</a></li><li><a class="prev" href="Enabling_AMS-APS_Mode.html" title="Enabling_AMS-APS_Mode">Enabling_AMS-APS_Mode</a></li><li style="float: right;"><a class="viewPrint" href="ams_dms_simug.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="AMS_Designer_with_Spectre_FX.html" title="AMS_Designer_with_Spectre_FX">AMS_Designer_with_Spectre_FX</a></li></ul></nav></header><!-- End Buttons --><div xmlns:html="http://www.w3.org/1999/xhtml" style="font-size:14px;line-height:1.42857142857;margin:20px 0 0 0;font-weight:bold;"><center>Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide<br />Product Version 22.09, September 2022</center></div>
<div xmlns:html="http://www.w3.org/1999/xhtml" style="margin-left:5%;">
<p></p>

<p></p>
<div id="main-header">
                    
                    
                                                <h1 style="margin: 4px 0 4px;"><span>AMS Spectre XPS MS Mode</span></h1>

                    
                </div>
<div class="wiki-content group" id="main-content">
                    
<p><span class="confluence-anchor-link" id="AMSSpectreXPSMSMode-msmode"></span></p>

<p>Spectre XPS MS delivers a high-performance transistor-level multi-rate simulation solution by combining a highly accurate SPICE engine (Spectre APS) together with a fast digital simulation engine (Spectre XPS). The identification between the analog and digital portions of the circuit is done automatically, with the added flexibility for advanced users to optimize it. The Spectre XPS MS mode is valuable for DUTs including MOS or FinFET device instances in Spectre or SPICE subcircuits.</p>

<p>The AMS Designer simulator supports the Spectre XPS MS simulation mode for AMS applications with mixed-signal transistor level circuits. The AMS Designer simulator first partitions the design between the AMSD event solver and Spectre XPS MS analog solver. Next, the analog block circuit is automatically partitioned into analog and mixed-signal partitions where the digital partition is solved in the XPS solver and the analog partition is solved in APS.</p>

<p>The following figure provides an overview of the AMS Designer simulator with Spectre XPS MS mode:</p>
<p align="left"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" data-base-url="https://rdwiki.cadence.com" data-image-src="attachments/475368362/475376186.gif" data-linked-resource-container-id="475368362" data-linked-resource-container-version="4" data-linked-resource-content-type="image/gif" data-linked-resource-default-alias="XPSMS.gif" data-linked-resource-id="475376186" data-linked-resource-type="attachment" data-linked-resource-version="1" data-unresolved-comment-count="0" src="attachments/475368362/475376186.gif" width="550" /></span></p>

<p>You should use Spectre XPS MS when there is a large number of gates described by device transistors. For such cases, Spectre XPS MS mode provides additional high-performance and large simulation capacity as compared to Spectre or Spectre APS.</p>

<p>To enable Spectre XPS MS mode in AMS, use<code> +ms </code>with the<code> -spectre_args </code>option of the<code> xrun </code>command.</p>

<p><span style=""> <strong>Example</strong> </span>:</p>

<p><code> xrun -spectre_args &quot;+ms&quot; input.scs test.v </code></p>

<p>When the Spectre XPS MS mode is enabled, a message is displayed in the<code> xrun </code>log file stating the same. Following is an example of the message that is displayed:</p>

<p><code> Notice from Spectre. </code></p>

<p><code> &#160;&#160;&#160;&#160;Spectre XPS Mixed -signal Mode Enabled (speed=2) </code></p>

<p>You can specify the errpreset settings with the +aps option at the command line to tighten the accuracy, with<code> +aps=liberal </code>being the default setting. You can use<code> +aps=moderate </code>or<code> +aps=conservative </code>setting for more accurate results while compromising on the simulation time.</p>

<p><code> xrun -spectre_args &quot;+ms +aps=moderate&quot; input.scs test.v </code></p>

<p>AMS Spectre XPS MS supports multi-threading computation on multi-core platforms. The multi-threading use model and behavior are identical to Spectre APS.</p>

<p>The AMS Spectre MS mode supports the following features:</p>
<ul><li>Verilog, SystemVerilog, Verilog-A, Verilog-AMS, VHDL, SystemC</li></ul><ul><li>Transient analysis</li></ul><ul><li>TCL voltage and current probing</li></ul><ul><li>Spectre<code> save </code>statement for current and voltage</li></ul><ul><li>SimVision debugger</li></ul><ul><li>Re-invoking the simulation</li></ul><ul><li>AHDL linter</li></ul><ul><li><code> +diagnose </code>option</li></ul><h4 id="AMSSpectreXPSMSMode-AdjustingAMSSpectreXPSMSSpeedandAccuracy">Adjusting AMS Spectre XPS MS Speed and Accuracy</h4>

<p>The Spectre XPS MS mode supports all performance and accuracy settings of Spectre APS for the analog portion. You can use the<code> ++aps </code>option to improve the performance of the APS analog engine in AMS Spectre XPS MS mode, as shown below.</p>

<p><code> xrun -spectre_args &quot;+ms ++aps&quot; input.scs test.v </code></p>

<p>You can also specify the errpreset options with<code> ++aps </code>to control the speed and accuracy of the analog engine with<code> liberal </code>being the default setting which results in faster simulation time but lower analog partition accuracy. Use<code> ++aps=moderate </code>for moderate analog partition accuracy. However, if accuracy is your primary concern, specify<code> ++aps=conservative </code>at the command line, as shown below.</p>

<p><code> xrun -spectre_args &quot;+ms ++aps=conservative&quot; input.scs test.v </code></p>

<p>The simulation speed and accuracy of digital portions in the AMS Spectre XPS MS mode can be controlled by the option +<code> speed=1/2/3.</code> The default value is 2, which is sufficient for most applications. Use<code> +speed=1 </code>for more accurate timing and power simulation of digital portions. Use +<code> speed=3 </code>for faster digital verification. For example:</p>

<p><code> xrun -spectre_args &quot;+ms ++aps +speed=3&quot; input.scs test.v </code></p>

<p>You can use the<code> +cktpreset=[sampled|pll] </code>option to improve the speed of ADC and PLL applications.</p>

<p>The xrun log file contains important information on the circuit partitions, simulation time spent on the analog and digital partitions, and suggestions to improve accuracy.</p>

<p><code> ********Pre-Simulation Summary******** </code></p>

<p><code> (MS) Table model. VDD=2.5V used for XPS table model creation, to overwrite tmopt options vdd=val </code></p>

<p><code> (MS) Circuit Partitions: 100% transistors and 99.4% nodes are identified as digital partitions. To force a subcircuit or subcircuit instance to digital, add in the netlistoptD options cktprest=digital subckt=[subckt_def_name]optD options cktpreset=digital inst=[subckt_inst_name] </code></p>

<p><code> *********Post-Transient Simulation Summary********* </code></p>

<p><code> 4.74% simulation time spent in analg partition. Consider force more circuit blocks to digital, or use more aggressive APS options.95.26% simulation time spent in digital partition Consider use more aggressive XPS options, add +speed=3 on command line </code></p>

<p><code> ********* </code></p>

<p><code> ********Post- </code></p>
<h4 id="AMSSpectreXPSMSMode-DigitalPartitioningandVirtualPowerNodes">Digital Partitioning and Virtual Power Nodes</h4>

<p>The Spectre XPS MS mode automatically detects the digital functions in a given circuit. For cases where a design has explicit hierarchical digital or analog functions, you can manually identify the functional blocks (subcircuit or instance) by using the following Spectre options:</p>

<p><code> optD options cktpreset=digital subckt=[dig_ctrl pll] </code></p>

<p><code> optA options cktpreset=analog subckt=[opamp adc] </code></p>

<p>or</p>

<p><code> optD options cktpreset=digital inst=[x1.xdig_ctrl x1.xpll] </code></p>

<p><code> optA options cktpreset=analog inst=[x2.xopamp x2.xadc] </code></p>

<p>You can define the virtual power supply nodes manually by using the<code> ms_vpn </code>option that defines the pairs of node names (wildcard is supported) and voltage values. The virtual ground nodes can be defined using the<code> ms_vgnd </code>option. The ground voltage is assumed to be 0V.</p>

<p><code> opt1 options ms_vpn = [I1.VDD_DIG 1.8 I1.VDD_DIG1 3.3] </code></p>

<p><code> opt3 options ms_vgnd = [I1.VSS] </code></p>

<p>The xrun log file provides information on the nodes that are identified as power/ground supplies and other nodes that are potential power/ground supplies. A sample log file report is shown below.</p>
<div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col /><col /><col /><col /><col /><col /></colgroup><tbody><tr><td class="confluenceTd" colspan="6">
<p><code> Digital Detection Vsource and Virtual Power Supply Node Summary </code></p>
</td>
</tr>
<tr><td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
<td class="confluenceTd">
<p><code> Type </code></p>
</td>
<td class="confluenceTd">
<p><code> #CC </code></p>
</td>
<td class="confluenceTd">
<p><code> #Bulk </code></p>
</td>
<td class="confluenceTd">
<p><code> Voltage </code></p>
</td>
<td class="confluenceTd">
<p><code> Name </code></p>
</td>
</tr>
<tr><td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
<td class="confluenceTd">
<p><code> GND </code></p>
</td>
<td class="confluenceTd">
<p><code> 4274 </code></p>
</td>
<td class="confluenceTd">
<p><code> 6866 </code></p>
</td>
<td class="confluenceTd">
<p><code> 0 </code></p>
</td>
<td class="confluenceTd">
<p><code> 0 </code></p>
</td>
</tr>
<tr><td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
<td class="confluenceTd">
<p><code> VSOURCE </code></p>
</td>
<td class="confluenceTd">
<p><code> 6386 </code></p>
</td>
<td class="confluenceTd">
<p><code> 6866 </code></p>
</td>
<td class="confluenceTd">
<p><code> 2.5 </code></p>
</td>
<td class="confluenceTd">
<p><code> vdd </code></p>
</td>
</tr>
<tr><td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
<td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
<td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
<td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
<td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
<td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
</tr>
<tr><td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
<td class="confluenceTd" colspan="5" rowspan="3">
<p><code> To force a virtual power or ground node, add in netlist </code></p>

<p><code> &#160;&#160;&#160;&#160;&#160;&#160;optVPN options ms_vpn=[node_name vpn_voltage] </code></p>

<p><code> &#160;&#160;&#160;&#160;&#160;&#160;optVGND options ms_vgnd=[node_name] </code></p>

<p><code> use keyword auto_vpn if you do not know the vpn_voltage </code></p>
</td>
</tr>
<tr><td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
</tr>
<tr><td class="confluenceTd">
<p><code> &#160; </code></p>
</td>
</tr>
</tbody></table></div>

<p>In the above report<code> #CC </code>refers to the number of MOS channel connected devices,<code> #BULK </code>refers to the bulk connections,<code> Voltage </code>refers to the node voltage, and<code> Name </code>refers to the node name. In the above example, 6386 MOS drain or sources are connected to a vsource on the node named vdd. The node voltage is 2.5 volts.</p>
<h4 id="AMSSpectreXPSMSMode-AMSSpectreXPSMSDCOperatingPointCalculation">AMS Spectre XPS MS DC Operating Point Calculation</h4>

<p>The Spectre XPS MS mode calculates the DC operating point before performing the transient simulation. By default, the DC operating point for the entire circuit is calculated by Spectre APS. For cases where the Spectre APS operating point calculation takes too long, you can enable the mixed-signal DC calculation - Spectre APS for the analog partition and Spectre XPS for the digital partition, by using the<code> +msdc=ms </code>command-line option, as shown below.</p>

<p><code> xrun spectre &quot;+ms +msdc=ms&quot; input.scs test.v //MS DC </code></p>
<h4 id="AMSSpectreXPSMSMode-Multi-RateIEPartitioninginAMSSpectreXPSMS">Multi-Rate IE Partitioning in AMS Spectre XPS MS</h4>

<p>All the IEs in AMS are simulated at the same rate (time step size) in the APS block. This process may have a major impact on the simulation speed if a design has high-frequency digital clocks between Verilog or SystemVerilog digital context and SPICE blocks.</p>

<p>The Spectre AMS designer simulator with XPS MS mode has been enhanced such that if an IE is connected to an XPS block (also called MS partition), it is computed with the same time step as the MS partition. When there are multiple IEs connected to different MS partitions (or XPS blocks), they are simulated at a different rate. As a result, the time step of an APS block is not limited by such IEs and the simulation can run much faster.</p>

<p>AMS IEs that connect only to the XPS block are tagged as XPS-IEs and are partitioned in XPS block also. AMS<code> inh_conn </code>IEs that have Ain/Aout port connected to an XPS block and power supply port (<code>in </code>port) connected to APS block are also partitioned in XPS. All other AMS IEs are tagged as APS-IE. Verilog-AMS or VHDL-AMS models with no IE remain in APS block.</p>
<h5 id="AMSSpectreXPSMSMode-RelatedTopic">Related Topic</h5><ul><li><a href="xrun_Command-Line_Options_for_Mixed-Signal_Designs.html">xrun Command-Line Options for Mixed-Signal Designs</a></li></ul>
                    </div>
<br /><br /></div>
<footer xmlns:html="http://www.w3.org/1999/xhtml"><nav class="navigation"><b><em><a href="Enabling_AMS-APS_Mode.html" id="prev" title="Enabling_AMS-APS_Mode">Enabling_AMS-APS_Mode</a></em></b><b><em><a href="AMS_Designer_with_Spectre_FX.html" id="nex" title="AMS_Designer_with_Spectre_FX">AMS_Designer_with_Spectre_FX</a></em></b></nav><div>
          For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved.
        </div>
</footer><br xmlns:html="http://www.w3.org/1999/xhtml" />
<div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;&#10240;</center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div>

</body></html>